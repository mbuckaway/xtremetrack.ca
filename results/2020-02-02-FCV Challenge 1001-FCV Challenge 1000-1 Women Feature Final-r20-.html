<!DOCTYPE html>
<html>
<!--
Html Template for Race Animation.
Generated from CrossMgr software.
Copyright 2011-2015, Edward Sitarski
For details, see sites.google.com/site/CrossMgrSoftware
-->
<head>
<meta charset="UTF-8">
<meta name="author" content="Edward Sitarski">
<meta name="copyright" content="Edward Sitarski">
<meta name="generator" content="CrossMgr">  
<meta name="keywords" content="CrossMgr, Cycling, Race, Results">
<!-- Meta -->
<title id="idTitle">FCV XTremeTrack Challenge 1001-FCV Challenge 1000-1 Women Feature Final - Starting 14:00:00 02/02/20</title>	<!-- Don't change this text! -->
<style type="text/css">
body { font-family: sans-serif; }
#idRaceName {
font-size: 200%;
font-weight: bold;
}
#idImgHeader {
box-shadow: 4px 4px 4px #888888;
}
#detailTitle {
font-size: 110%;
font-weight: bold;
}
input[type=range]::-ms-tooltip {
display: none;
}
.smallfont	{ font-size: 75%; }
.bigfont	{ font-size: 120%; }
.biggerFont	{ font-size: 130%; }
.hidden { display: none; }
div label input {
margin-right:220px;
}
#buttongroup {
margin:4px;   
float:left;
}
#buttongroup label {
float:left;
margin:4px;
background-color:#EFEFEF;
border-radius:4px;
border:1px solid #D0D0D0;
overflow:auto;
cursor: pointer;
}
#buttongroup label span {
text-align:center;
padding:8px 8px;
display:block;
}
#buttongroup label input {
position:absolute;
top:-20px;
}
#buttongroup input:checked + span {
background-color:#404040;
color:#F7F7F7;
}
#buttongroup .green {
background-color:#7FE57F;
color:#333;
}
table.results {
font-family:"Trebuchet MS", Arial, Helvetica, sans-serif;
border-collapse:collapse;
}
table.results td, table.results th {
font-size:1em;
padding:3px 7px 2px 7px;
text-align: right;
}
table.results th {
font-size:1.1em;
text-align:right;
padding-top:5px;
padding-bottom:4px;
background-color:#7FE57F;
color:#000000;
}
table.results tr.odd {
color:#000000;
background-color:#EAF2D3;
}
table.results tr:hover {
color:#000000;
background-color:#FFFFCC;
}
table.results tr.odd:hover {
color:#000000;
background-color:#FFFFCC;
}
table.results tr td.fastest {
background-image: linear-gradient(
/* #FF6620, #FFAA20 25%, #FF6620 */
#00EE00, #00FF00 25%, #00EE00
);
}
table.results tr td.fastest-lap {
background-image: linear-gradient(
/* #FF6A7F, #FF9EAF 25%, #FF6A7F */
#FF8840, #FFCC40 25%, #FF8840
);
}
table.results tr td.slowest-lap {
background-image: linear-gradient(
#4496F7, #9CC7FB 25%, #4496F7
);
}
table.results tr td.highlight {
font-size: 120%;
font-weight: bold;
}
table.results td {
border-top:1px solid #98BF21;
}
table.results td.noborder {
border-top:0px solid #98BF21;
}
table.results td#idNonNumeric, table.results th#idNonNumeric {
text-align:left;
}
table.results tr td.same-value {
text-align:center;
}
.flag {
border: 1px solid #CCC;
}
hr { clear: both; }
hr.invisible { clear: both; visibility: hidden; }
@media print { .noprint { display: none; } }
</style>
<!-- Google Analytics -->
<script type="text/javascript">
/* !!! payload begin !!! */
var payload = {"raceName":"2020-02-02-FCV Challenge 1001-FCV Challenge 1000-1 Women Feature Final-r20-","infoFields":["LastName","FirstName","Name","Team","City","State","Prov","StateProv","Nat.","Category","Age","Gender","License","NatCode","UCIID","UCICode","CustomCategory1","CustomCategory2","CustomCategory3","CustomCategory4","CustomCategory5","CustomCategory6","CustomCategory7","CustomCategory8","CustomCategory9"],"organizer":"Forest City Velodrome","reverseDirection":false,"finishTop":false,"isTimeTrial":false,"winAndOut":false,"rfid":true,"primes":[{"effortType":"Pack","effortCustom":"","position":1,"lapsToGo":371,"sponsor":"","cash":20.0,"merchandise":"","points":0,"timeBonus":0.0,"winnerBib":18,"winnerInfo":"Isabelle BRYENTON, Shadow"},{"effortType":"Pack","effortCustom":"","position":1,"lapsToGo":363,"sponsor":"","cash":20.0,"merchandise":"","points":0,"timeBonus":0.0,"winnerBib":21,"winnerInfo":"Elspeth HUYETT, The 5th Floor NYC"},{"effortType":"Break","effortCustom":"","position":1,"lapsToGo":333,"sponsor":"","cash":50.0,"merchandise":"","points":0,"timeBonus":0.0,"winnerBib":17,"winnerInfo":"Candice MOOTE, Hamilton United"},{"effortType":"Custom","effortCustom":"Lap Field","position":1,"lapsToGo":198,"sponsor":"","cash":500.0,"merchandise":"","points":0,"timeBonus":0.0,"winnerBib":17,"winnerInfo":"Candice MOOTE, Hamilton United"},{"effortType":"Break","effortCustom":"","position":1,"lapsToGo":191,"sponsor":"","cash":50.0,"merchandise":"","points":0,"timeBonus":0.0,"winnerBib":23,"winnerInfo":"Elizabeth STEVENSON, American Cycling League"},{"effortType":"Break","effortCustom":"","position":1,"lapsToGo":173,"sponsor":"","cash":50.0,"merchandise":"","points":0,"timeBonus":0.0,"winnerBib":17,"winnerInfo":"Candice MOOTE, Hamilton United"},{"effortType":"Pack","effortCustom":"","position":1,"lapsToGo":50,"sponsor":"","cash":50.0,"merchandise":"","points":0,"timeBonus":0.0,"winnerBib":17,"winnerInfo":"Candice MOOTE, Hamilton United"}],"raceNameText":"FCV Challenge 1001-FCV Challenge 1000-1 Women Feature Final","raceDate":"2020-02-02","raceScheduledStart":"2020-02-02 14:00","raceTimeZone":"America/Toronto","raceAddress":"London, ON, Canada","raceIsRunning":false,"raceIsUnstarted":false,"raceIsFinished":true,"lapDetails":{},"hideDetails":true,"showCourseAnimation":true,"licenseLinkTemplate":"","roadRaceFinishTimes":false,"estimateLapsDownFinishTime":false,"email":"goody2112@hotmail.com","version":"CrossMgr 3.0.46-beta-43ae29f","raceNotes":"Miriam Brouwer, 22, did not start last segment (medical). Marked DNF.","raceStartTime":53339.0,"timestamp":["Sun Feb  2 16:45:27 2020",6969.134776],"data":{"17":{"flr":1.0,"relegated":false,"Age":37,"Category":"Pro Women","City":"Beamsville","FirstName":"Candice","Gender":"Women","LastName":"MOOTE","License":"27647P13","NatCode":"CAN","StateProv":"ON","Team":"Hamilton United","interp":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"lastInterp":false,"lastTime":6954.889757,"lastTimeOrig":6954.889757,"raceCat":"Pro Women (Women)","raceTimes":[0.0,17.41467,31.01757,44.29618,57.50035,71.50291,84.4875,98.63,112.43479,125.4127,139.67725,154.7375,167.75861,181.45018,194.74742,206.26079,216.18341,226.80051,237.87074,249.05276,260.61003,274.03735,287.55878,300.30227,314.21834,327.32576,341.18729,354.49434,366.9213,380.74281,393.76661,407.56891,420.18708,434.10563,447.03152,461.06961,473.93168,487.81309,500.65002,514.44172,526.97354,540.86609,554.52057,567.13567,580.02108,594.87735,608.08855,621.49113,634.75747,649.20173,663.05606,675.90098,688.68202,701.16997,712.91556,724.53203,735.55493,747.34003,759.59395,771.81394,785.53083,797.61146,809.29578,821.7932,833.95745,847.35142,860.11714,873.54129,887.58541,901.05241,914.24992,926.78053,940.30998,952.87081,966.26353,978.84222,992.61725,1005.38972,1018.71198,1032.45271,1044.75431,1058.5366,1071.50578,1085.53344,1098.52678,1111.7996,1125.95733,1139.74969,1152.61894,1165.53016,1179.57993,1192.86774,1207.17896,1220.5211,1234.73226,1248.12249,1262.35574,1275.69977,1290.15352,1303.59281,1317.83922,1331.10705,1345.46548,1358.95881,1373.47269,1387.08821,1401.90906,1415.59644,1430.27863,1443.84052,1458.55895,1472.22611,1486.90868,1499.70091,1513.65974,1527.78916,1540.91543,1554.3766,1568.75882,1581.82817,1595.34639,1609.86094,1622.87264,1636.00679,1650.16738,1664.06493,1677.02536,1690.2034,1703.12562,1717.24977,1730.50581,1744.85341,1757.61811,1770.81501,1785.09448,1798.22103,1812.74101,1825.96767,1839.52217,1854.15145,1867.32979,1881.2203,1894.99757,1908.25496,1922.51733,1935.58035,1949.08873,1964.2679,1978.0746,1991.77293,2006.06165,2021.66443,2035.44472,2049.12541,2064.3453,2077.96992,2091.41792,2105.4433,2120.9621,2134.63741,2148.25929,2163.09889,2176.87966,2190.07004,2204.60968,2216.71896,2226.94868,2237.34611,2248.81025,2260.20766,2271.69809,2283.50647,2295.2689,2307.17128,2319.01951,2330.73312,2343.09846,2356.81917,2369.9598,2383.83595,2398.18139,2412.10844,2425.86242,2440.46646,2454.46966,2468.18252,2481.6164,2494.40982,2508.31973,2522.42202,2536.37113,2550.97631,2565.26218,2579.21343,2594.28461,2608.54115,2623.41185,2637.78466,2651.45287,2666.37206,2680.36192,2695.2821,2709.42265,2723.38516,2738.42865,2752.70229,2767.52062,2781.76374,2795.68676,2810.77844,2824.90577,2838.72792,2852.50705,2866.92215,2880.29299,2890.76224,2902.18911,2915.82315,2928.90547,2943.59322,2957.73029,2972.16563,2985.5253,2999.49597,3013.62071,3028.46457,3041.85157,3056.48389,3069.9992,3085.34139,3097.96021,3111.81361,3124.95951,3137.6587,3152.35469,3167.16637,3181.3008,3194.41887,3206.52044,3217.19455,3228.74927,3241.96771,3255.17365,3269.98489,3283.80422,3298.96282,3312.82728,3328.04902,3342.28859,3356.87466,3370.99259,3385.07786,3398.60018,3413.25581,3427.00545,3441.75564,3455.43987,3470.48148,3484.48826,3498.25021,3512.44564,3524.68392,3537.64082,3551.42302,3566.0108,3580.02735,3594.88227,3608.77089,3622.6477,3637.40215,3651.56606,3665.39828,3680.59204,3694.92647,3708.79077,3723.10194,3734.87389,3746.73726,3758.97429,3771.56301,3784.01367,3796.78908,3809.25931,3821.88978,3833.92829,3845.97943,3857.43066,3869.49087,3880.69073,3892.60218,3905.93376,3918.71992,3931.95776,3945.17527,3958.14954,3970.57673,3982.66992,3994.62289,4006.6748,4018.63469,4030.99251,4043.49601,4055.2666,4067.15404,4079.60472,4091.02559,4103.04493,4114.75939,4128.91886,4142.29536,4154.91866,4167.31536,4178.9008,4191.82812,4205.39824,4219.75206,4233.89149,4248.41184,4262.78024,4276.56222,4291.1236,4305.81483,4320.19542,4334.61721,4348.99506,4362.75046,4377.14623,4391.05725,4403.11825,4414.71461,4427.11052,4441.18911,4454.56148,4468.97916,4482.59597,4497.09167,4511.63649,4526.00354,4540.45979,4554.68715,4568.51522,4582.95604,4596.83441,4611.31715,4625.03901,4639.76504,4653.55512,4669.14389,4682.84852,4696.76685,4711.77596,4726.0206,4741.33685,4755.79128,4771.37486,4785.68911,4801.58841,4816.47394,4831.23346,4846.94294,4861.46038,4877.20307,4892.12933,4907.89434,4922.40246,4937.25909,4952.0786,4966.30544,4981.41815,4996.20308,5010.45596,5024.96893,5039.64844,5054.72846,5069.16382,5084.4824,5099.01947,5114.00599,5129.04513,5143.91924,5158.79084,5173.10003,5188.32897,5203.59619,5218.05587,5233.14535,5247.34059,5262.60288,5277.5445,5292.47319,5307.22154,5321.69703,5337.20727,5351.8916,5367.28926,5382.73699,5397.53921,5412.80396,5428.22189,5442.63475,5457.4704,5472.70383,5487.39581,5502.61463,5517.92646,5532.79746,5548.17257,5562.98235,5578.54447,5594.00894,5609.50892,5624.7658,5639.44945,5654.61874,5670.03006,5684.97176,5701.09874,5716.40584,5731.29091,5746.77392,5762.23927,5776.99233,5792.70901,5808.07675,5823.04291,5838.46833,5853.68632,5869.47675,5885.00609,5900.38994,5915.59582,5931.04408,5946.25648,5961.83233,5976.94994,5992.22034,6007.61629,6022.45415,6038.02523,6052.93195,6068.30374,6083.26573,6099.03927,6114.4073,6130.21993,6146.08794,6161.93859,6178.52085,6193.91671,6208.44969,6222.60359,6234.93478,6246.54755,6259.99564,6274.12723,6290.20617,6306.07077,6321.01827,6336.68067,6351.84469,6367.23942,6382.70354,6398.35066,6413.88705,6429.04842,6444.19088,6459.39546,6475.01238,6489.89464,6505.60685,6520.39252,6536.4055,6551.9964,6566.79869,6582.31035,6597.54156,6612.21078,6627.45536,6642.67344,6657.66915,6673.23001,6685.87446,6697.94872,6711.6028,6725.68721,6740.76605,6757.37534,6772.37215,6788.00232,6803.90787,6819.35176,6835.05653,6848.86186,6859.95612,6871.52429,6883.96244,6896.88459,6910.22101,6926.84519,6941.66737,6954.88976],"speed":"","status":"Finisher"},"16":{"flr":1.0,"relegated":false,"Age":21,"Category":"Pro Women","City":"Washington","FirstName":"Alijah","Gender":"Women","LastName":"BEATTY","License":"27647P11","NatCode":"USA","StateProv":"IA","Team":"Independent","interp":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"lastInterp":false,"lastTime":6956.708021,"lastTimeOrig":6956.708021,"raceCat":"Pro Women (Women)","raceTimes":[0.0,15.49381,31.80444,45.50498,58.6701,72.16303,84.70945,97.8782,112.6741,125.76651,138.88141,154.48396,167.52767,181.20687,194.53736,205.78701,215.70969,226.41313,237.43224,248.29885,260.37394,273.70721,287.34159,300.07258,314.06287,327.1183,341.08282,354.28555,366.7032,380.57112,393.52783,407.33293,420.00894,433.93415,446.80641,460.853,473.69337,487.57607,500.42078,514.20983,526.73594,541.38528,554.20889,566.87215,580.8757,594.55123,607.70548,621.05453,636.21798,649.40435,662.53625,675.47478,688.24732,701.98763,715.5894,726.80274,737.21956,748.35619,760.13001,772.54179,786.27754,798.73212,809.90887,821.56448,834.49362,847.09595,860.71062,874.21775,888.41901,901.61201,913.97097,927.37655,940.08258,953.49338,966.00044,979.56223,992.46618,1005.98739,1019.37045,1032.26643,1044.58021,1058.34934,1071.27928,1085.30292,1098.29812,1112.49961,1125.95211,1139.52317,1152.41672,1166.21929,1179.34046,1193.50926,1206.94987,1221.17333,1234.5348,1248.79966,1262.06935,1276.33655,1289.84934,1304.22593,1317.60647,1331.72366,1345.21055,1359.61945,1373.25968,1387.77133,1401.62248,1416.30903,1429.99788,1444.53306,1458.35967,1472.93738,1486.73081,1499.58112,1514.10262,1527.38946,1540.89435,1555.13828,1568.10304,1581.82826,1596.05307,1609.16356,1622.87541,1636.39023,1649.60223,1664.02965,1677.40439,1690.6969,1703.49798,1716.8672,1730.80027,1744.56659,1757.11325,1771.53097,1784.57723,1798.85813,1812.40181,1825.41448,1840.25498,1853.54759,1866.80353,1881.74355,1895.42071,1908.74686,1921.8886,1936.28065,1949.46487,1963.4541,1978.44228,1992.3714,2006.68043,2020.85091,2035.90444,2049.79048,2063.74906,2077.1838,2092.0056,2106.22695,2120.02595,2135.07673,2148.62725,2162.60872,2177.01324,2190.53218,2205.06848,2217.37342,2227.92222,2238.55377,2249.42743,2261.07386,2272.25156,2283.61049,2295.08037,2306.64776,2318.31433,2329.92108,2343.42689,2356.48867,2370.16693,2384.48713,2397.86649,2411.66498,2426.49678,2440.05355,2453.71005,2468.27751,2481.83248,2494.63887,2507.71586,2522.63142,2536.61159,2550.36506,2565.50637,2579.39545,2594.53643,2608.79319,2622.8296,2638.0125,2651.64457,2666.63429,2680.63697,2694.53631,2709.66448,2723.59781,2738.6642,2752.94931,2766.86867,2782.00598,2795.96851,2810.91042,2825.15579,2839.03497,2852.68664,2867.25404,2879.9048,2891.00979,2902.42479,2916.06091,2929.04918,2943.72495,2958.06504,2971.61358,2985.82458,2999.75382,3013.86019,3028.62099,3042.01314,3056.70855,3070.20338,3085.50149,3098.32283,3111.22566,3125.23754,3137.85798,3152.24073,3166.42631,3180.62535,3194.24311,3207.41992,3218.42177,3229.32474,3241.76299,3255.80127,3269.73938,3284.48855,3298.59978,3313.56472,3327.80177,3343.07128,3357.68063,3371.68776,3384.87167,3399.29378,3413.01033,3427.73568,3441.56093,3456.1539,3470.35675,3484.2884,3499.36095,3512.63735,3524.92565,3537.87129,3551.66971,3566.28998,3580.2784,3594.24309,3609.27419,3623.10388,3637.02867,3651.96555,3666.07145,3680.3643,3694.39618,3710.66214,3724.61949,3738.44329,3750.34015,3762.71105,3775.41061,3788.50888,3799.83277,3811.68786,3823.1563,3834.22586,3845.77482,3857.28001,3869.30922,3880.54281,3892.59277,3906.31518,3919.07084,3932.3209,3946.3573,3961.13463,3974.82641,3987.77209,3999.95647,4011.26232,4023.75082,4037.74816,4053.62397,4067.4202,4079.23838,4090.66226,4103.4371,4115.04349,4129.00673,4142.61843,4155.30428,4167.1279,4179.12195,4191.47242,4205.71396,4219.30379,4234.15075,4248.69899,4262.39938,4276.80447,4291.33621,4305.40004,4320.48037,4334.86207,4348.5729,4362.99822,4377.42628,4391.37822,4403.77899,4415.24646,4427.41864,4441.44021,4454.86097,4468.57543,4482.77556,4497.36052,4511.35822,4526.19543,4540.74683,4554.30793,4568.71928,4583.20456,4597.04838,4611.54522,4625.30732,4639.36347,4653.79757,4668.95293,4682.63111,4697.50672,4711.49161,4726.71341,4741.06732,4756.66808,4771.1025,4786.42855,4801.46189,4816.24909,4831.98597,4846.68424,4862.18486,4876.95627,4892.77833,4907.61415,4922.85513,4937.00934,4951.86734,4966.78975,4981.15509,4995.95017,5010.90066,5024.71698,5039.3637,5055.05327,5068.95701,5084.21125,5099.49793,5113.78271,5128.84868,5144.42474,5158.51938,5173.68059,5188.07557,5203.35919,5218.53761,5232.89627,5247.84808,5262.30719,5277.32445,5293.0201,5307.05705,5322.23128,5336.96317,5352.31357,5367.12505,5382.52255,5397.99737,5412.54296,5427.95903,5443.06591,5457.24541,5472.45156,5487.88602,5502.38349,5518.39101,5532.59823,5547.87609,5563.42895,5578.27819,5593.75912,5610.03009,5624.52191,5640.01101,5654.38664,5669.78007,5685.41918,5700.83958,5716.2066,5731.73923,5746.48805,5762.04498,5777.5009,5792.40816,5808.53951,5822.84325,5838.23847,5854.21562,5869.19708,5884.75816,5900.99983,5915.39782,5930.78045,5946.7393,5961.55779,5977.48509,5991.95463,6007.35726,6022.91333,6037.76477,6053.47115,6068.06256,6083.84029,6098.84515,6114.88331,6129.99463,6145.91726,6161.68571,6178.9388,6193.59292,6208.87423,6223.08655,6235.52556,6247.09547,6259.78382,6274.62544,6289.96524,6305.83731,6321.52964,6336.38208,6352.41051,6366.98681,6383.20855,6398.0486,6413.66375,6429.51359,6443.96518,6459.88929,6474.4945,6489.66348,6505.35172,6520.94123,6536.17167,6551.68228,6567.36521,6582.02953,6597.30846,6612.69649,6627.17322,6642.47466,6658.16106,6672.98244,6686.79898,6698.54852,6711.18385,6725.33635,6741.2134,6756.97706,6772.1004,6787.70402,6803.38961,6818.78565,6834.684,6850.08207,6861.4978,6872.59668,6884.57479,6897.33648,6910.61826,6924.16385,6936.22899,6946.78775,6956.70802],"speed":"","status":"Finisher"},"23":{"flr":1.0,"relegated":false,"Age":19,"Category":"Pro Women","City":"Rochester Hills","FirstName":"Elizabeth","Gender":"Women","LastName":"STEVENSON","License":"27647P31","NatCode":"USA","StateProv":"MI","Team":"American Cycling League","interp":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"lastInterp":false,"lastTime":6956.885526,"lastTimeOrig":6956.885526,"raceCat":"Pro Women (Women)","raceTimes":[0.0,16.24416,31.25923,44.49586,57.64748,70.82381,85.49433,98.83187,111.92101,125.7779,140.50909,153.87942,167.07497,180.60562,194.22751,206.05188,215.84774,226.58404,237.32431,247.93203,260.11371,273.39506,287.02979,300.68196,313.72996,327.60764,340.86406,353.90902,367.3047,380.30528,394.16351,407.14247,420.62853,433.6897,447.49055,460.63645,474.2212,487.39909,501.06198,514.00227,527.5575,541.07524,553.97761,566.63961,580.60819,594.00676,608.46484,622.19074,635.46728,648.54315,661.67936,676.63728,689.40687,701.97239,713.723,724.3363,735.88463,747.18252,759.39548,772.20047,785.96172,798.14936,809.70644,821.31642,834.30317,846.88372,860.50418,874.00527,888.13423,901.43274,913.77507,927.16535,939.8092,953.30231,965.80888,979.34288,992.20313,1005.84524,1019.1155,1032.00519,1045.19284,1058.16491,1071.92953,1085.14614,1098.88656,1112.2708,1125.73843,1139.25228,1152.17828,1166.00254,1179.12182,1193.29652,1206.68236,1220.94144,1234.29693,1248.59938,1261.84193,1276.15461,1289.58225,1304.02664,1317.32996,1331.55289,1344.93623,1359.44731,1373.00004,1387.52029,1401.43283,1416.10223,1429.77421,1444.35193,1458.10809,1472.67463,1486.52548,1499.60678,1513.85395,1527.17449,1541.10735,1554.53133,1568.4822,1581.95008,1595.57436,1609.85899,1623.01965,1636.16154,1649.45716,1664.24431,1677.18423,1690.40725,1703.30653,1716.58494,1731.07319,1744.31158,1757.92135,1771.24212,1784.39723,1798.76261,1812.14078,1826.09659,1839.63661,1854.05821,1867.49658,1881.42577,1895.17342,1908.50446,1922.63421,1936.00218,1949.47412,1963.16942,1978.51076,1992.14427,2006.45497,2020.58215,2035.9173,2049.51941,2063.50203,2077.91126,2091.80891,2105.96616,2119.82845,2134.91264,2148.4796,2162.40897,2177.03714,2190.25436,2204.82616,2216.86552,2226.91767,2237.44701,2248.55469,2259.59501,2270.80499,2282.24324,2293.37621,2305.91604,2316.98327,2328.95778,2342.98847,2356.64392,2370.38801,2383.62512,2398.10672,2411.83626,2425.62427,2440.61555,2454.2028,2467.98287,2481.2836,2494.13399,2508.19722,2522.21133,2536.13677,2551.17272,2564.9799,2580.00382,2593.99548,2608.30236,2623.53325,2637.49787,2652.20693,2666.15314,2680.11782,2695.34517,2709.22573,2724.28993,2738.23403,2752.39852,2767.62869,2781.53836,2796.55931,2810.57792,2824.66694,2839.37967,2852.91087,2867.48277,2880.09266,2890.46913,2902.60808,2915.33951,2929.25412,2943.04712,2958.28111,2971.81986,2985.94152,3000.0023,3014.07203,3027.94526,3042.23051,3055.92818,3070.4343,3084.71753,3098.54811,3111.41176,3125.3719,3138.05429,3152.575,3166.67893,3180.84694,3194.43475,3207.59688,3218.13545,3229.13808,3241.49098,3255.59383,3269.46526,3284.23159,3298.43383,3313.36887,3327.54512,3342.86226,3357.39899,3371.37744,3384.62208,3399.05647,3412.75725,3427.46858,3441.3013,3455.95158,3470.12844,3484.04443,3499.56063,3512.17386,3524.4922,3537.3995,3551.17124,3565.73624,3579.78798,3595.70084,3608.97648,3622.86927,3636.74379,3651.99111,3665.88969,3680.16593,3695.12712,3710.8543,3724.74361,3738.62953,3750.50918,3762.89881,3775.64237,3787.46847,3798.72476,3809.73433,3820.65965,3831.25022,3842.73886,3855.38573,3866.54772,3878.24959,3891.83412,3906.52565,3919.22662,3931.89684,3946.59946,3961.34722,3975.02242,3987.88921,3999.45743,4010.63572,4023.10797,4037.93638,4053.63291,4067.57834,4079.41316,4090.93495,4102.82182,4115.16218,4128.67645,4142.84202,4154.8004,4167.25691,4178.70584,4191.65805,4205.94663,4219.52598,4234.39238,4248.23389,4262.5991,4277.06361,4290.92821,4305.58248,4320.61642,4334.41429,4348.8024,4363.20223,4376.93796,4391.56531,4403.89866,4415.41471,4427.62307,4440.92871,4455.09878,4468.77599,4483.01,4496.88955,4511.51959,4526.3877,4540.22956,4554.47701,4569.00399,4582.7265,4597.33769,4611.08838,4625.51339,4639.57586,4654.24183,4668.7306,4682.35653,4697.19076,4711.20218,4726.49805,4740.79958,4756.38348,4770.87871,4786.22323,4801.1979,4815.98307,4831.83508,4846.33899,4861.9627,4876.71582,4892.69149,4907.35732,4922.63817,4937.42897,4951.59158,4966.55934,4981.68026,4995.65325,5010.65135,5025.11604,5039.05802,5054.93403,5069.3836,5084.00676,5099.20242,5114.22977,5128.63184,5144.10515,5158.30053,5173.51035,5188.49962,5203.12792,5218.24528,5232.64424,5247.57545,5262.81227,5277.07819,5292.72552,5306.78982,5321.93586,5336.73385,5352.09878,5367.52454,5382.23714,5397.76348,5412.99363,5427.67742,5442.82585,5457.71757,5472.13603,5487.6112,5502.86338,5518.08505,5533.016,5547.68697,5563.13637,5578.70977,5593.52677,5609.71668,5624.9534,5639.75298,5654.85666,5669.5012,5685.21402,5701.39071,5715.96932,5731.50577,5746.91166,5761.7092,5777.22786,5793.02325,5808.22322,5823.27446,5838.00058,5853.94056,5869.67832,5884.51038,5900.6459,5915.85617,5930.50417,5946.42199,5962.01652,5977.19833,5992.36436,6007.10314,6022.69121,6038.31232,6053.21416,6067.80714,6083.50372,6099.32238,6114.60318,6130.40375,6145.58811,6161.57065,6178.72843,6193.36638,6208.64263,6222.82009,6235.07218,6246.67411,6260.11508,6274.33084,6290.51359,6305.59585,6321.23952,6336.89042,6352.07283,6367.48004,6382.90213,6398.56982,6413.43248,6429.2163,6444.43224,6459.60342,6474.84438,6490.125,6505.09646,6520.65197,6536.66206,6551.49079,6567.02643,6582.48008,6597.00188,6612.43395,6627.67949,6642.1691,6657.87834,6673.39214,6685.99029,6698.12177,6711.41712,6725.52734,6740.99353,6756.69489,6771.83115,6788.07978,6803.42634,6819.01429,6834.42302,6849.52579,6860.16967,6871.68916,6884.14224,6897.06638,6910.42115,6924.3068,6936.3694,6946.87839,6956.88553],"speed":"","status":"Finisher"},"15":{"flr":1.0,"relegated":false,"Age":29,"Category":"Pro Women","City":"Quebec","FirstName":"Evelyne","Gender":"Women","LastName":"GAGNON","License":"27647P10","NatCode":"CAN","StateProv":"ON","Team":"Shadow","interp":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"lastInterp":false,"lastTime":6963.314891,"lastTimeOrig":6963.314891,"raceCat":"Pro Women (Women)","raceTimes":[0.0,16.77642,30.47774,43.70642,57.93453,71.98681,85.25156,99.10273,113.10143,126.37049,139.43592,152.83395,166.55184,180.95036,193.58932,204.24004,214.99092,226.32127,238.22927,250.49699,263.40367,276.28144,289.54551,302.79751,315.6293,328.09693,341.64128,354.90684,367.81877,381.26786,394.62582,408.0579,421.08149,434.52112,447.96858,461.45866,474.6551,488.24568,501.53694,514.77077,528.04047,541.81021,555.06469,568.26501,581.3104,595.25034,609.05248,622.50667,635.74995,648.94401,661.97241,674.66406,687.9976,702.27567,715.35912,728.00796,739.06367,750.98899,763.53639,776.60042,789.59039,803.03794,816.46483,830.19556,844.32215,857.15158,869.53435,882.42644,895.62124,908.92904,922.39781,936.14781,949.85943,963.53266,977.3146,991.11347,1004.93115,1018.76641,1032.4741,1045.70885,1059.10411,1072.51413,1086.03062,1099.46037,1112.90029,1126.46908,1140.05354,1153.13917,1166.55843,1180.13087,1193.84032,1207.76843,1221.58965,1235.38884,1249.15154,1262.86466,1276.68885,1290.70489,1304.57578,1318.46542,1332.0956,1346.02566,1359.98072,1374.12749,1388.14118,1402.44099,1416.64036,1430.7261,1444.88376,1459.09921,1473.23361,1487.56062,1500.28441,1514.14455,1527.36452,1541.18965,1554.86085,1567.83312,1582.10897,1595.8266,1608.90882,1623.2187,1636.70183,1649.98125,1663.23575,1675.61978,1688.34729,1702.04946,1716.31007,1730.88394,1744.0785,1757.89358,1771.13052,1784.6182,1798.50561,1811.89181,1826.31577,1839.99914,1853.34874,1867.03539,1882.13271,1895.79275,1909.06042,1922.15331,1935.24578,1949.94565,1963.75896,1977.44413,1991.81668,2007.01897,2021.15,2034.85335,2049.41408,2064.11993,2077.51018,2091.25874,2106.48348,2120.43728,2134.09461,2148.66924,2162.98327,2176.29062,2190.40047,2205.28392,2217.85638,2229.04193,2240.94194,2253.23115,2266.20849,2279.39566,2293.06274,2305.76557,2318.06668,2330.82489,2343.80872,2357.08448,2370.8676,2384.88647,2398.71325,2412.42794,2426.2376,2439.75744,2453.53579,2466.56869,2479.36842,2492.69804,2507.02324,2521.75358,2537.08838,2551.62511,2566.06689,2580.57758,2594.95802,2609.62414,2624.12993,2638.56387,2652.81387,2667.02278,2681.51467,2695.89692,2710.30734,2724.77165,2738.99068,2753.81439,2768.28141,2782.48938,2797.06097,2811.31783,2825.8247,2840.04199,2853.40391,2867.85635,2881.15447,2892.2897,2903.69517,2916.43712,2929.879,2944.10234,2958.64943,2972.64065,2986.5427,3000.60187,3014.60387,3029.12858,3042.82736,3057.09684,3070.88539,3085.85233,3099.14702,3112.20185,3125.88337,3138.74972,3152.94983,3167.49663,3181.66992,3194.7804,3207.80148,3219.33406,3231.2893,3244.26451,3257.69445,3270.98739,3284.96429,3299.61069,3313.96924,3328.71601,3343.46755,3358.05272,3372.00562,3385.67197,3399.66918,3413.80742,3427.97253,3442.29874,3456.46645,3470.86035,3485.29837,3500.00554,3513.37111,3525.4888,3538.06839,3552.08489,3566.53777,3580.61017,3594.53261,3608.82544,3623.4646,3637.37961,3651.04035,3665.94812,3680.63579,3694.74927,3708.89454,3723.68696,3735.41248,3747.37161,3759.89875,3773.55647,3786.726,3799.65413,3812.30193,3824.98373,3837.78941,3850.87937,3864.35306,3878.11129,3891.7305,3905.77797,3919.43128,3933.08386,3947.23806,3961.81798,3975.6893,3989.13043,4002.61684,4016.60458,4030.61484,4044.54597,4058.51563,4072.25057,4085.92963,4099.59356,4113.63623,4127.82768,4142.12512,4155.95009,4170.2554,4184.58154,4198.91687,4213.11096,4227.5487,4242.0332,4256.47256,4270.99535,4285.29204,4299.38572,4313.58991,4328.37203,4342.12767,4355.76806,4369.66345,4383.9596,4398.42015,4412.86702,4427.54779,4442.05778,4456.01363,4469.93123,4483.61404,4497.89879,4512.33212,4526.98262,4541.0917,4555.38911,4569.66608,4583.7522,4597.79937,4611.96471,4625.9897,4640.11733,4654.6442,4669.40671,4683.46955,4697.88315,4712.4277,4727.10554,4741.91931,4756.95675,4772.02413,4786.80747,4801.98445,4817.15869,4832.38911,4847.56776,4862.61929,4877.86384,4893.15782,4908.5826,4923.59257,4937.748,4952.50588,4967.10225,4981.9839,4996.62219,5011.27057,5025.57049,5040.05265,5055.48791,5069.76262,5084.80169,5099.85592,5114.68398,5129.46735,5144.72213,5159.13618,5174.0086,5188.90873,5203.97169,5218.83053,5233.47164,5248.14223,5263.11986,5277.94645,5293.28333,5307.53247,5322.51141,5337.51926,5352.62316,5367.75007,5383.01742,5398.3593,5413.31204,5428.53701,5443.40336,5458.08446,5473.07002,5488.15893,5503.23102,5518.75076,5533.28513,5548.51572,5563.75269,5579.11376,5594.42124,5610.34961,5625.29056,5640.39285,5655.2211,5670.40475,5685.76429,5701.60571,5716.83317,5732.07108,5747.35961,5762.66535,5777.82163,5793.34728,5808.90875,5823.69041,5838.91103,5854.56165,5869.98584,5885.42907,5901.28456,5916.22493,5931.38392,5947.08709,5962.437,5977.87074,5992.78096,6008.0394,6023.31483,6038.62694,6053.87774,6068.63861,6084.10806,6099.59134,6115.21493,6130.75954,6146.40917,6162.27328,6179.04186,6194.28836,6209.21383,6223.55593,6236.13072,6248.32664,6261.12952,6275.13509,6290.61444,6306.4788,6321.88269,6337.28308,6352.75754,6367.83516,6383.54743,6399.04362,6414.31369,6429.96585,6444.81232,6460.23446,6475.44444,6490.60501,6506.06555,6521.30432,6536.97832,6552.36756,6567.71017,6582.95743,6597.99451,6613.08704,6628.07934,6643.13518,6658.46651,6673.88488,6687.78514,6700.33736,6713.64003,6727.18944,6741.5048,6757.7295,6772.94178,6788.65499,6804.24244,6819.87118,6835.59413,6850.85065,6863.69079,6876.6277,6890.19344,6904.54767,6919.09729,6933.74456,6948.53224,6963.31489],"speed":"","status":"Finisher"},"26":{"flr":1.0,"relegated":false,"Age":38,"Category":"Pro Women","City":"Lancaster","FirstName":"Kristen","Gender":"Women","LastName":"KEYES","License":"27647P2","NatCode":"USA","StateProv":"PA","Team":"Pista Elite","interp":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"lastInterp":false,"lastTime":6936.767813,"lastTimeOrig":6936.767813,"raceCat":"Pro Women (Women)","raceTimes":[0.0,15.81775,30.31135,45.26714,58.9276,72.79559,86.10251,99.74453,113.62029,126.93818,139.98248,153.33508,166.64633,180.17345,194.90519,208.73498,222.06588,234.72199,247.0224,259.60619,273.33761,288.02389,302.44904,315.54799,328.58611,342.23534,355.66901,368.41559,381.76784,395.04441,408.40264,422.28508,436.10417,448.98076,462.14473,475.38078,489.03783,502.28467,515.40654,527.93609,540.86252,553.85222,567.19595,581.45952,594.77219,607.94495,621.26726,635.09687,649.62072,662.81554,675.69979,688.48557,700.94916,715.12261,728.90815,743.13166,757.03273,770.99896,785.71115,800.65763,815.31522,829.1268,843.88608,858.41149,872.69246,887.01906,901.60597,915.79362,929.45293,944.2928,958.11078,972.28207,986.61394,999.61825,1012.2756,1024.88173,1038.36902,1052.27805,1067.22181,1081.49999,1095.92656,1110.29688,1124.66597,1139.4609,1154.0867,1167.40273,1181.31933,1195.22478,1208.83492,1222.24597,1236.24291,1249.89629,1263.40064,1277.53828,1291.4813,1305.35287,1319.27237,1332.79469,1346.75859,1360.72758,1374.84841,1388.83664,1403.17927,1417.36774,1431.46085,1445.65374,1459.8613,1473.88671,1488.45393,1502.20353,1516.07113,1529.94911,1544.16051,1557.94106,1572.65413,1586.80088,1601.39213,1615.7179,1629.90107,1643.89431,1655.62014,1668.58551,1683.32256,1698.09304,1712.32415,1725.63323,1739.64762,1754.29415,1768.154,1781.2618,1792.74919,1805.39257,1820.99676,1836.11881,1851.47225,1866.29706,1881.16764,1895.99649,1910.59322,1923.64806,1937.77188,1952.05206,1966.85041,1981.37612,1995.65927,2009.93505,2024.85267,2039.6464,2053.82669,2068.70655,2083.23576,2098.02373,2113.03122,2127.84123,2142.51488,2157.85309,2173.24966,2189.0893,2205.02243,2220.49669,2233.58245,2247.1974,2262.39725,2277.27959,2291.93817,2306.13309,2320.19424,2333.91383,2348.31334,2362.51196,2377.03005,2392.31506,2407.35512,2422.90431,2437.9238,2452.71306,2467.13424,2481.32674,2495.27011,2509.64576,2524.56867,2539.26607,2554.58147,2568.96108,2584.34907,2599.81282,2614.8245,2629.05643,2642.91051,2657.88314,2673.05056,2688.05441,2702.37171,2716.61314,2730.85969,2746.75204,2762.15183,2777.27986,2792.76926,2807.96635,2823.02755,2837.31205,2851.46619,2865.51154,2879.54695,2893.4876,2908.34212,2922.84475,2937.41416,2951.79392,2965.56201,2979.5851,2993.64495,3007.41848,3021.76356,3037.69172,3052.55499,3066.67642,3080.65035,3094.92143,3109.35255,3122.78364,3137.00218,3152.0807,3166.17823,3180.35596,3194.00389,3207.75295,3221.91157,3236.62466,3251.18196,3265.17331,3280.44261,3295.33878,3309.92634,3326.02808,3341.38572,3356.70734,3372.10551,3386.50881,3400.37069,3414.49676,3428.50663,3442.90849,3457.20576,3471.79096,3485.38083,3499.02439,3511.71012,3524.85033,3539.31001,3552.50108,3567.05249,3581.38359,3595.73397,3610.16345,3624.48992,3638.97417,3652.57924,3666.79055,3681.50828,3695.85651,3709.85997,3724.13049,3738.14837,3752.65858,3767.41763,3782.30318,3797.59609,3812.74956,3827.44953,3841.53441,3856.90541,3872.15393,3886.41268,3900.65472,3915.81362,3930.46064,3946.3912,3963.85439,3979.33474,3994.54992,4009.27229,4025.87051,4040.54467,4055.04199,4071.44141,4088.15818,4103.14963,4117.33218,4131.67144,4146.32969,4160.2863,4174.83567,4190.48471,4205.6575,4221.28919,4237.23832,4252.43233,4266.281,4281.38809,4296.86877,4311.96748,4327.92244,4342.85662,4358.43051,4375.1073,4390.84237,4403.24529,4417.08203,4432.54739,4447.98809,4463.2364,4477.91048,4492.52944,4506.80969,4522.01242,4535.70913,4549.37027,4563.69975,4578.17859,4593.89047,4609.49765,4624.43943,4638.9019,4653.19862,4669.83663,4683.90185,4698.11711,4712.65505,4727.33365,4742.22922,4757.29907,4772.29446,4787.04718,4802.19951,4817.32428,4832.65538,4847.81788,4862.86783,4878.09173,4893.42735,4908.88752,4923.79499,4938.02719,4952.73161,4967.38626,4982.33341,4996.89805,5011.51111,5025.82005,5040.4087,5055.79983,5070.01177,5085.07791,5100.04183,5114.91,5129.7615,5145.078,5159.36137,5174.272,5189.11438,5204.23917,5219.10271,5233.64797,5248.38132,5263.37057,5278.20395,5293.50289,5307.76002,5322.7491,5337.74807,5352.88458,5368.05151,5383.30445,5398.63274,5413.58658,5428.82005,5443.66941,5458.3448,5473.41837,5488.44673,5503.54108,5518.97302,5533.64544,5548.8086,5564.01133,5579.38707,5594.78085,5610.66525,5625.58176,5640.65123,5655.5015,5670.64578,5686.16586,5702.04426,5717.05826,5732.35482,5747.62889,5762.93139,5778.11196,5793.64821,5809.08089,5823.96323,5839.13916,5854.8272,5870.27452,5885.68504,5901.51909,5916.48283,5931.68315,5947.34528,5962.69755,5978.13222,5993.02183,6008.17371,6023.55872,6038.89225,6054.16088,6068.87656,6084.39043,6099.80044,6115.44456,6131.03447,6146.78953,6162.42955,6179.53855,6194.62827,6209.44277,6223.86159,6236.41646,6249.28624,6263.54213,6277.97083,6292.22881,6307.02876,6322.26559,6337.55541,6353.04166,6368.11293,6383.79367,6399.30234,6414.57111,6430.24055,6445.08868,6460.50788,6475.7712,6490.89595,6506.35614,6521.57468,6537.30604,6552.70389,6567.9818,6583.25212,6598.24273,6613.36629,6628.37334,6643.37431,6658.72882,6674.18819,6688.01756,6700.58245,6713.98923,6727.57194,6741.93616,6758.01838,6773.3227,6788.92467,6804.54442,6820.09411,6835.85408,6851.34192,6863.96477,6876.84424,6889.9397,6903.96118,6918.25385,6936.76781],"speed":"","status":"Finisher"},"21":{"flr":1.0,"relegated":false,"Age":29,"Category":"Pro Women","City":"Emmaus","FirstName":"Elspeth","Gender":"Women","LastName":"HUYETT","License":"27647P20","NatCode":"USA","StateProv":"PA","Team":"The 5th Floor NYC","interp":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"lastInterp":false,"lastTime":6935.301481,"lastTimeOrig":6935.301481,"raceCat":"Pro Women (Women)","raceTimes":[0.0,15.99316,29.67761,44.8786,58.09537,71.0821,84.89648,98.11859,112.45022,125.9137,139.14396,153.18528,168.05698,181.60768,195.07964,207.65411,218.91447,231.07755,244.56055,258.4008,272.82927,287.58854,301.95814,315.8782,328.81204,342.48032,355.88873,368.72357,381.94256,395.30784,408.60735,421.69104,434.86159,448.2831,461.63934,474.89205,488.55301,501.86343,514.799,527.46078,540.39187,554.39853,567.71309,580.50215,593.79472,608.70596,621.99135,635.25555,648.38839,662.68037,676.42411,689.25076,701.74131,714.43304,728.54012,741.9121,755.97142,770.78,785.42159,800.41026,815.10946,829.86474,843.60103,858.15608,872.51626,886.74674,901.41954,916.47343,930.21918,943.95857,957.96445,972.97939,986.49164,999.47864,1012.03511,1024.69597,1038.14538,1053.01336,1066.9846,1081.27748,1095.67975,1110.33231,1124.4301,1139.18672,1153.81334,1167.19329,1181.10303,1195.34642,1208.64996,1221.98427,1236.04147,1249.66418,1264.15199,1277.27677,1291.28134,1305.06187,1319.03537,1332.58505,1346.46796,1360.46994,1374.66233,1388.55911,1402.92671,1417.10416,1431.22985,1445.37694,1459.6593,1473.62114,1488.19276,1501.8744,1515.84892,1530.00131,1543.92472,1558.5711,1572.43461,1586.60971,1601.17455,1615.47048,1629.9141,1643.59879,1654.4547,1665.53852,1678.52636,1693.00094,1708.2974,1724.31194,1739.43238,1754.15284,1767.95978,1780.94308,1791.99733,1802.51728,1815.56271,1831.12902,1847.91642,1864.97282,1880.42364,1895.40213,1909.91699,1923.25225,1937.39709,1952.30663,1967.06826,1980.98775,1995.76445,2010.16443,2024.30532,2039.8654,2054.03708,2068.2058,2083.49952,2098.22458,2112.57683,2128.05136,2142.78566,2157.37042,2173.47002,2189.46334,2205.16984,2220.76026,2233.78822,2247.36638,2262.67474,2277.49588,2292.21266,2306.42042,2320.41098,2334.18349,2347.95309,2361.98635,2377.29357,2392.53633,2407.60235,2422.33209,2438.08389,2453.00488,2467.41907,2481.56228,2495.60206,2509.46811,2523.97259,2539.39477,2554.85148,2569.21165,2583.75409,2600.04441,2615.14928,2629.34384,2643.19607,2657.50335,2673.23176,2688.30548,2702.57859,2716.93692,2731.20466,2746.19368,2762.46295,2777.23083,2792.09527,2808.32217,2823.26557,2837.6275,2852.03077,2866.57857,2881.50314,2895.80988,2909.64409,2923.10102,2937.66597,2952.03284,2965.80668,2979.83124,2993.91345,3007.61936,3021.98862,3037.92067,3052.85463,3066.90423,3080.89918,3095.10219,3109.09512,3122.54886,3136.74064,3151.77895,3166.00941,3181.30037,3195.42454,3208.70102,3222.05921,3236.37709,3250.94242,3265.7669,3280.18228,3295.1366,3310.51072,3325.67862,3341.13361,3356.45115,3371.9888,3386.23591,3400.14122,3414.27801,3428.28873,3442.64067,3456.94889,3471.55128,3485.16052,3498.76057,3511.0218,3522.56072,3535.71187,3550.67403,3566.37957,3581.21168,3595.44914,3609.98689,3624.28309,3638.70252,3652.32096,3666.49555,3681.25403,3695.55331,3709.60439,3723.84764,3737.89828,3752.40438,3767.19629,3782.11501,3797.29758,3812.51124,3827.69433,3841.70085,3857.18427,3872.48506,3886.21066,3900.91294,3915.5591,3930.72457,3946.1246,3963.61872,3979.03724,3994.29223,4009.93387,4026.15819,4040.79906,4055.31516,4071.62694,4088.40117,4103.47222,4117.64016,4131.95997,4146.70085,4160.534,4175.11245,4189.87882,4205.10501,4220.66869,4237.54374,4252.80054,4266.56839,4281.63609,4297.38277,4312.28361,4327.04705,4342.05096,4358.42865,4375.3454,4391.39108,4407.54808,4422.92827,4438.85418,4454.78524,4470.82106,4485.54297,4500.85166,4516.68659,4531.89601,4546.74447,4560.99582,4575.57173,4590.00407,4604.83656,4619.2753,4634.02327,4648.73345,4663.55547,4678.68612,4693.4077,4708.1208,4723.09113,4738.35163,4753.60451,4769.18061,4785.02839,4801.63661,4817.66947,4832.97756,4848.06207,4863.14829,4878.36598,4893.74474,4909.13582,4924.0904,4938.43015,4953.02653,4967.73001,4982.58107,4997.14235,5011.74907,5026.10033,5040.52862,5056.0993,5070.29906,5085.46548,5100.3132,5115.16974,5130.03063,5145.34619,5159.65626,5174.54766,5189.34055,5204.52519,5219.34464,5233.89956,5248.62618,5263.67532,5278.46485,5293.81929,5308.01838,5323.09138,5338.02439,5353.17475,5368.33281,5383.58659,5398.94095,5413.87278,5429.10845,5443.96287,5458.61742,5473.57133,5488.68906,5503.81689,5519.30572,5533.82939,5549.11219,5564.27367,5579.55359,5594.96579,5610.97404,5625.83173,5640.91607,5655.81488,5670.91513,5686.31175,5702.2135,5717.30066,5732.55238,5747.91253,5763.17223,5778.39689,5793.87252,5809.53619,5824.2139,5839.45372,5855.1467,5870.59439,5885.98264,5901.82635,5916.7417,5931.93885,5947.64571,5962.96791,5978.45661,5993.28897,6008.48082,6023.81779,6039.21278,6054.437,6069.13263,6084.6756,6100.17637,6115.71335,6131.34449,6147.05069,6162.70369,6179.90934,6194.91728,6209.71847,6224.14892,6237.25342,6249.97315,6263.81354,6278.23209,6292.46922,6307.27107,6322.42869,6337.86567,6353.32207,6368.40875,6384.06045,6399.60517,6414.94037,6430.61672,6445.39582,6460.7863,6476.07237,6491.19488,6506.63477,6521.81224,6537.6618,6553.02806,6568.26207,6583.55595,6598.5553,6613.67886,6628.65377,6643.68516,6658.98496,6674.47305,6688.45591,6700.89527,6714.26887,6727.8729,6742.23742,6758.41034,6773.53097,6789.29476,6804.89544,6820.44122,6836.11105,6851.64008,6864.68875,6877.26825,6890.4995,6904.89023,6918.53509,6935.30148],"speed":"","status":"Finisher"},"20":{"flr":1.0,"relegated":false,"Age":17,"Category":"Pro Women","City":"Kitchener","FirstName":"Emily","Gender":"Women","LastName":"DODGE","License":"27647P19","NatCode":"CAN","StateProv":"ON","Team":"Independent","interp":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"lastInterp":false,"lastTime":6924.282765,"lastTimeOrig":6924.282765,"raceCat":"Pro Women (Women)","raceTimes":[0.0,17.16238,30.78199,44.08574,57.24178,71.44099,84.26845,98.92421,112.19484,125.20173,140.32863,154.24009,167.32725,180.96155,194.35077,205.17483,215.12611,225.38421,235.90554,247.6667,259.9391,273.22418,286.87143,300.57029,313.63224,327.56061,340.69943,353.69952,367.16743,380.2014,394.02068,406.95338,420.4959,433.54891,447.27806,460.46759,474.1493,487.25324,500.90455,513.81821,527.24915,540.15508,554.72954,567.44977,580.27937,594.41605,608.40757,621.7404,635.03929,648.15763,663.24631,676.17563,689.02446,701.43519,713.19592,724.21065,735.73834,747.5568,759.24952,772.09179,785.82404,798.00797,809.5543,822.02256,834.16182,847.57308,860.36429,873.8287,887.89791,901.2249,914.37644,927.06395,940.55614,953.09719,966.39169,979.20265,992.61316,1005.68285,1018.92164,1031.81965,1045.05435,1057.98418,1071.77186,1084.93185,1098.81397,1112.10292,1125.52391,1139.07056,1152.73289,1165.79267,1179.79138,1193.13312,1207.36066,1220.75628,1234.99437,1248.39468,1262.42569,1275.96299,1290.36999,1303.84976,1318.07425,1331.33769,1345.67566,1359.23223,1373.75909,1387.35109,1402.00938,1415.85337,1430.24838,1444.11669,1458.72254,1472.51812,1487.08945,1499.86306,1513.42553,1528.06613,1540.72116,1554.8403,1568.63819,1581.59784,1595.88607,1609.74459,1622.62268,1635.74751,1650.52282,1663.81582,1676.80719,1689.94611,1702.87474,1717.27847,1730.30159,1744.92745,1757.41643,1771.4756,1784.9265,1797.98895,1812.75149,1825.76148,1840.37191,1853.93301,1867.13589,1881.00258,1894.73722,1909.37466,1922.42628,1935.37632,1949.63169,1964.09093,1977.8045,1991.59535,2006.69437,2021.48583,2035.18341,2048.92367,2064.43226,2077.77988,2091.18517,2106.02126,2120.80861,2134.41892,2148.05202,2163.34011,2176.65733,2189.90063,2204.40383,2217.37967,2228.41068,2240.0629,2252.54805,2265.85595,2279.62297,2293.7935,2307.52485,2320.7282,2333.71321,2345.73709,2358.11344,2371.27095,2384.39664,2397.71414,2411.40068,2426.9408,2440.41183,2454.01316,2467.77904,2481.18887,2494.8038,2508.06588,2522.03258,2536.65388,2551.03445,2564.87207,2580.05665,2593.8596,2609.11346,2623.34125,2637.3103,2652.29077,2665.9727,2680.98512,2695.08923,2709.0331,2724.20468,2738.02116,2753.37469,2767.4576,2781.41089,2796.67406,2810.41075,2824.48874,2839.56214,2853.15487,2867.80064,2880.9299,2891.50259,2902.85218,2915.59949,2929.4058,2943.37534,2957.50905,2972.26862,2985.3157,3000.30256,3014.348,3028.18768,3042.29792,3056.27618,3070.50646,3085.04504,3097.74543,3111.69325,3124.73555,3138.2906,3152.84906,3166.94639,3181.06608,3194.21879,3206.32735,3216.97499,3228.97536,3242.11104,3255.38863,3270.26343,3284.11044,3299.10612,3313.15005,3328.31567,3342.64786,3357.26482,3371.24235,3385.28867,3398.83455,3413.49312,3427.28703,3442.06009,3455.76188,3469.95579,3484.85498,3499.34098,3512.0005,3524.29727,3537.09273,3550.98891,3565.62901,3580.68707,3594.83124,3608.57477,3623.60148,3637.77228,3651.41853,3665.17699,3681.41727,3696.05849,3710.34822,3724.39569,3738.10316,3750.15531,3762.49675,3775.84271,3788.42384,3800.89942,3814.06544,3827.94183,3842.0133,3856.57234,3869.84509,3882.21385,3894.61081,3907.99387,3922.0392,3935.91039,3950.21826,3965.21282,3980.10662,3995.24876,4009.8539,4024.05031,4038.20178,4053.31696,4067.68148,4081.57542,4095.79775,4111.6145,4126.61798,4142.55451,4157.30784,4172.21491,4187.16409,4202.72428,4219.01582,4235.74425,4251.71445,4266.06231,4281.18541,4297.6301,4312.91573,4327.70117,4342.61698,4358.20383,4374.76739,4390.9044,4407.29101,4423.24031,4438.48668,4454.30717,4470.04679,4485.29498,4500.56445,4516.38379,4532.30784,4547.37108,4562.41464,4577.91613,4593.67806,4609.86142,4624.96308,4639.84306,4654.14448,4668.55257,4683.16772,4696.96305,4712.08179,4726.31026,4741.58651,4756.21821,4771.63296,4785.98301,4800.9568,4816.86719,4831.64687,4847.24272,4861.73517,4877.40329,4892.58922,4908.24216,4923.4244,4938.30128,4953.90508,4969.45728,4985.64782,5002.60636,5020.33401,5038.7653,5056.05308,5073.34968,5090.82904,5108.86598,5126.78522,5144.5235,5162.22451,5180.1269,5199.00179,5218.22558,5234.2733,5248.99654,5264.05054,5278.82765,5294.24712,5308.95251,5323.46418,5338.63496,5353.52697,5368.95584,5384.28698,5400.07819,5415.38762,5431.46303,5448.00366,5465.63447,5483.74776,5501.74858,5519.69972,5537.71536,5555.76425,5574.3554,5592.34187,5610.81537,5628.58707,5646.93781,5664.81257,5683.34778,5701.80358,5720.12058,5738.16359,5756.24288,5774.29606,5791.99434,5809.0223,5824.60042,5839.83741,5855.56108,5871.01272,5886.55128,5902.42604,5918.25102,5934.12983,5949.20762,5964.88758,5980.90053,5997.61572,6015.92202,6034.68473,6053.5445,6072.59122,6091.3982,6108.4885,6125.78741,6143.0657,6161.3939,6180.35714,6198.22848,6215.87418,6234.7835,6253.2777,6272.00236,6290.16153,6308.4371,6326.2205,6344.63881,6363.65205,6383.12096,6402.25053,6421.18201,6440.51039,6459.94679,6479.11922,6498.32115,6517.77693,6537.75268,6557.0194,6575.95928,6595.07001,6614.72162,6633.90233,6653.64793,6673.47345,6692.78097,6712.46252,6731.62524,6750.80321,6770.6749,6790.38205,6809.68926,6828.75072,6848.15521,6866.97335,6885.87987,6904.94366,6924.28276],"speed":"","status":"Finisher"},"25":{"flr":1.0,"relegated":false,"Age":17,"Category":"Pro Women","City":"Kitchener","FirstName":"Amanda","Gender":"Women","LastName":"KLEINIKKINK","License":"27647P53","NatCode":"CAN","StateProv":"ON","Team":"KW Cycling Academy","interp":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"lastInterp":false,"lastTime":6882.843905,"lastTimeOrig":6882.843905,"raceCat":"Pro Women (Women)","raceTimes":[0.0,15.67602,30.02226,44.20178,58.37799,72.35507,85.81261,99.47776,113.35702,126.69643,139.74597,153.1347,166.42861,181.15127,195.40663,208.48291,221.84322,235.64129,249.124,263.28292,277.82049,293.02182,308.69933,324.60136,339.87213,354.91499,368.2033,381.55122,395.86768,409.10486,422.51126,435.87316,449.33084,462.44918,475.58051,489.29993,502.67907,515.70814,528.6902,542.50581,556.23298,569.11284,583.25067,598.18498,613.65743,629.38529,644.96472,660.61835,675.74629,689.5438,702.1882,714.46572,728.58092,742.93172,757.68063,771.44674,785.95365,800.97821,815.53237,829.30486,843.9987,858.6781,872.91819,887.09227,901.88128,916.17601,929.73654,944.45352,958.42744,972.52423,985.961,998.93102,1011.48931,1025.12331,1038.58429,1052.60224,1067.43951,1081.74352,1096.22885,1109.88069,1124.88545,1139.69326,1154.41083,1167.63447,1181.53755,1194.86871,1208.22486,1222.52581,1236.50573,1250.15852,1263.66159,1276.88202,1290.92385,1305.47176,1319.54372,1333.03634,1346.9929,1360.91911,1375.10481,1389.02016,1403.46759,1417.53091,1431.65758,1445.85678,1460.14288,1474.09067,1488.62628,1502.07506,1514.43276,1527.766,1540.48358,1555.43202,1568.36661,1581.29281,1596.33705,1609.47602,1622.39944,1636.9554,1650.22105,1663.60771,1676.57547,1691.11653,1705.4644,1720.04766,1734.03436,1749.14526,1765.18326,1781.23097,1793.14768,1805.53415,1821.2573,1836.42676,1851.72635,1866.63203,1881.5497,1896.07808,1909.61868,1922.86641,1935.80938,1949.34996,1964.44508,1978.27517,1991.98592,2006.23277,2021.6008,2035.71214,2049.32283,2063.35629,2078.39879,2091.62732,2105.71764,2121.26046,2136.33649,2151.88334,2167.99833,2186.79153,2204.27003,2219.74116,2232.16054,2246.32225,2262.14618,2276.97471,2292.84044,2307.05519,2321.02255,2333.64469,2345.50945,2358.01424,2370.99139,2384.09046,2397.47224,2412.48303,2427.58038,2441.88715,2454.87409,2468.59841,2482.25358,2496.33144,2510.01195,2523.97714,2536.944,2550.67731,2565.45854,2579.68552,2593.61009,2609.10176,2623.03734,2637.91808,2651.93326,2665.72962,2680.90537,2694.74368,2709.8109,2723.8387,2737.74427,2753.26519,2767.13795,2781.99369,2796.10263,2810.10877,2825.49418,2839.03143,2850.31971,2861.11132,2872.91754,2884.979,2897.36164,2911.80611,2926.92571,2942.18453,2955.99549,2969.67321,2983.99817,2997.5716,3010.61601,3023.91335,3038.17695,3053.05832,3067.19017,3080.73139,3093.67716,3107.13992,3121.72569,3136.55576,3151.54865,3167.8184,3182.02248,3195.09975,3208.39846,3221.88899,3236.85058,3251.48284,3265.35936,3280.66244,3295.54432,3309.97269,3326.19165,3341.65143,3357.04036,3372.49958,3385.92216,3399.91952,3413.99572,3428.01114,3442.20509,3456.70037,3471.17788,3484.83113,3498.4597,3510.54268,3522.27796,3536.01241,3550.69588,3565.2803,3581.68649,3595.92511,3610.29536,3623.99386,3638.23018,3651.90294,3665.69468,3679.94715,3695.23845,3709.06458,3723.17832,3735.91736,3747.88886,3760.54147,3775.7402,3791.91501,3808.42422,3824.75436,3840.68049,3856.21475,3869.4106,3882.02716,3895.40703,3911.10588,3928.18418,3945.78888,3963.48456,3979.61379,3994.90076,4009.32978,4023.20837,4037.58048,4054.5359,4071.13771,4088.85455,4103.7405,4117.91657,4132.22652,4147.18309,4160.91438,4175.40225,4190.12946,4205.3539,4221.03775,4237.8009,4253.07681,4266.80202,4281.92658,4297.76305,4312.53715,4327.31932,4342.37324,4357.86201,4374.43283,4390.56466,4408.49146,4424.22269,4438.76525,4454.63454,4470.60469,4487.39171,4504.5914,4522.8074,4541.05333,4558.94364,4576.27845,4592.36294,4609.34692,4625.23141,4641.32481,4658.91015,4676.88294,4694.07146,4710.60155,4728.28992,4746.29056,4764.40205,4782.58472,4801.2094,4819.45656,4837.72028,4856.00734,4874.6267,4893.07995,4911.00686,4928.84069,4946.84531,4964.66421,4982.53426,5000.69501,5019.53191,5038.43367,5056.65131,5074.78351,5093.11683,5111.60463,5130.69708,5149.15246,5168.44704,5188.10658,5206.73558,5225.74053,5244.98846,5263.84658,5282.64653,5302.16527,5321.2662,5339.86104,5357.96793,5375.5912,5393.10402,5411.50442,5429.86692,5446.75469,5463.84882,5482.46142,5501.21254,5519.32522,5537.38294,5556.57719,5574.09092,5591.95331,5610.44745,5629.37019,5646.62525,5665.53473,5683.13619,5701.37755,5719.58473,5739.0616,5756.14029,5773.97404,5792.70066,5810.11701,5827.3078,5846.06726,5864.4361,5882.97669,5901.7592,5920.3057,5939.36313,5958.82171,5977.81465,5996.69398,6015.56058,6034.2902,6053.23488,6072.23969,6091.05118,6108.04694,6125.38643,6143.37986,6161.06393,6179.97596,6199.16766,6218.07724,6236.02543,6252.8654,6272.28314,6290.51417,6309.09108,6328.01974,6346.86835,6365.97166,6384.77465,6403.99637,6423.2893,6442.78384,6461.97969,6481.24538,6500.66712,6520.86339,6540.60516,6560.30366,6580.04015,6599.58284,6618.76554,6638.56714,6658.51762,6678.64962,6698.83039,6718.82006,6737.90254,6757.7096,6778.36783,6882.8439],"speed":"","status":"Finisher"},"18":{"flr":1.0,"relegated":false,"Age":20,"Category":"Pro Women","City":"Ottawa","FirstName":"Isabelle","Gender":"Women","LastName":"BRYENTON","License":"27647P16","NatCode":"CAN","StateProv":"ON","Team":"Shadow","interp":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"lastInterp":false,"lastTime":6779.196799,"lastTimeOrig":6779.196799,"raceCat":"Pro Women (Women)","raceTimes":[0.0,17.86647,31.76934,45.37939,58.62551,72.60876,85.54815,98.53798,111.74104,127.14291,140.27684,153.71065,166.86384,180.41659,194.06044,207.83828,219.59618,231.3011,244.3542,258.59933,273.03976,287.84416,302.13551,315.41635,328.32305,341.99421,356.16322,368.96888,382.22421,395.52816,408.84821,421.95795,435.09327,448.51988,461.93075,475.14302,488.78196,502.06473,515.08451,527.65547,540.61409,553.62021,568.16475,580.89951,594.28055,607.43276,622.30614,636.00791,649.18946,662.29856,675.09321,688.70129,702.54466,714.97362,728.06997,741.66251,756.21569,770.54057,785.21566,800.18229,815.88199,829.58069,843.35637,857.90012,873.08989,887.51738,902.09131,916.45041,929.93399,943.71984,957.67651,972.75998,986.22292,999.2161,1011.76244,1024.4505,1038.64455,1052.91069,1066.68526,1081.06893,1096.46515,1110.06683,1124.15499,1138.9421,1153.4382,1166.93408,1181.80783,1195.1113,1208.33709,1221.78813,1235.83824,1250.35116,1263.91057,1277.09285,1290.94579,1304.8244,1318.74565,1332.37107,1346.21183,1360.22649,1374.35876,1388.35629,1402.66885,1416.86337,1430.95905,1445.12877,1459.34531,1473.42609,1487.92298,1502.56276,1516.36187,1529.74343,1544.32768,1558.33408,1572.13128,1587.07387,1601.00616,1615.9306,1630.30395,1643.3482,1654.2174,1664.9888,1677.22379,1692.9071,1708.74016,1724.10137,1739.14119,1753.91183,1767.65288,1780.70771,1792.13365,1805.17892,1820.66675,1836.84197,1851.22376,1866.12014,1880.91456,1895.76749,1910.38111,1923.47655,1937.50433,1951.83317,1966.64209,1981.27021,1995.3703,2010.54313,2024.62931,2039.38342,2054.27096,2068.39624,2082.99112,2097.76085,2112.83473,2127.66379,2143.11379,2157.61751,2172.9362,2188.77063,2204.55772,2220.21492,2233.33858,2246.94803,2261.66074,2276.72628,2292.52806,2306.67319,2320.76725,2334.36763,2348.17179,2362.27733,2376.82114,2392.07841,2407.86506,2422.65603,2437.55147,2453.21855,2467.71126,2481.9744,2496.03873,2509.8676,2524.30154,2539.01108,2554.29577,2569.58524,2584.09145,2599.54457,2615.4199,2629.62536,2643.12031,2657.72526,2672.74529,2688.58835,2702.82494,2717.25193,2731.56952,2746.43642,2761.90856,2777.46817,2792.54119,2807.75873,2823.68059,2837.93502,2852.3142,2867.01893,2882.00929,2896.73535,2911.62459,2926.61032,2942.06983,2957.89987,2973.88114,2989.59993,3005.56342,3021.35576,3037.39201,3053.7059,3068.87852,3084.99716,3101.4108,3118.30254,3135.0467,3151.97492,3168.59427,3185.27475,3202.10642,3218.95775,3235.42987,3251.34495,3265.61215,3279.98173,3295.87122,3310.24589,3325.41107,3341.9211,3357.34935,3372.88594,3388.12327,3404.69809,3421.61449,3438.36147,3454.80895,3471.69389,3488.89718,3506.04925,3522.62787,3539.35049,3555.38318,3571.40245,3588.06958,3605.24973,3622.285,3639.41503,3656.02601,3672.64964,3689.64111,3706.67215,3723.41768,3739.8687,3756.28814,3773.0856,3789.47606,3806.14945,3822.96891,3839.47373,3856.0824,3872.57158,3889.29262,3906.50438,3923.41656,3940.46971,3957.91441,3974.93847,3991.70784,4008.54549,4025.61728,4042.31075,4059.11031,4076.65342,4093.98583,4111.73438,4129.57075,4146.99975,4164.24846,4181.61486,4199.08213,4216.8851,4235.08302,4252.82507,4269.94303,4287.57102,4305.04912,4322.31653,4339.58468,4357.14736,4374.7124,4391.70814,4408.1492,4424.60582,4441.48845,4458.31553,4475.94915,4493.15933,4511.05354,4528.89823,4546.87344,4564.34107,4581.59347,4598.83844,4616.43652,4634.23086,4651.62995,4669.40531,4686.85623,4704.5001,4722.76118,4741.04118,4759.10084,4777.10498,4795.05711,4813.52019,4832.35021,4850.99618,4868.92778,4887.07243,4905.61828,4923.89517,4941.48786,4959.07702,4977.18919,4995.50227,5013.41637,5031.12231,5049.27492,5067.79145,5086.49513,5104.86971,5123.50824,5142.10081,5160.83708,5179.44896,5198.55057,5217.73267,5236.18712,5254.6126,5273.83398,5293.36015,5312.1288,5330.89667,5350.11666,5369.2106,5388.13867,5406.92669,5425.61664,5444.64924,5463.4758,5482.64177,5500.90833,5519.0744,5537.99342,5556.24922,5573.71566,5592.61138,5611.0616,5628.96928,5646.21314,5665.1224,5682.85889,5701.02701,5720.32122,5738.59602,5755.85298,5774.55034,5792.39162,5809.8305,5827.1755,5845.69846,5864.15961,5882.59831,5901.40869,5920.15128,5939.76868,5958.53262,5977.49983,5996.36998,6015.18398,6033.98807,6052.85183,6071.86348,6090.81322,6109.42864,6127.53007,6145.90209,6164.17417,6182.99477,6201.44529,6220.11838,6239.15175,6257.63247,6276.69831,6295.48186,6314.39135,6333.54677,6352.84367,6372.17414,6391.54234,6411.45234,6431.09985,6450.04962,6469.45107,6488.76791,6508.10778,6527.40976,6547.15402,6566.67747,6585.37465,6604.13035,6623.22406,6642.69282,6661.71791,6680.84053,6700.3714,6719.70298,6739.03974,6759.0123,6779.1968],"speed":"","status":"Finisher"},"22":{"flr":1.0,"relegated":false,"Age":29,"Category":"Pro Women","City":"Burlington","FirstName":"Miriam","Gender":"Women","LastName":"BROUWER","License":"27647P27","NatCode":"CAN","StateProv":"ON","Team":"Independent","interp":[0,0],"lastInterp":false,"lastTime":72.219064,"lastTimeOrig":73.219064,"raceCat":"Pro Women (Women)","raceTimes":[0.0,72.21906],"speed":"","status":"DNF"},"19":{"flr":1.0,"relegated":false,"Age":39,"Category":"Pro Women","City":"Burlington","FirstName":"Nicole","Gender":"Women","LastName":"LENTINI","License":"27647P17","NatCode":"CAN","StateProv":"ON","Team":"First Draft Racing","interp":[],"lastInterp":false,"lastTime":0.0,"lastTimeOrig":0.0,"raceCat":"Pro Women (Women)","raceTimes":[],"speed":"","status":"DNS"},"24":{"flr":1.0,"relegated":false,"Age":21,"Category":"Pro Women","City":"Waterloo","FirstName":"Ali","Gender":"Women","LastName":"VAN YZENDOORN","License":"27647P33","NatCode":"CAN","StateProv":"ON","Team":"Independent","interp":[],"lastInterp":false,"lastTime":0.0,"lastTimeOrig":0.0,"raceCat":"Pro Women (Women)","raceTimes":[],"speed":"","status":"DNS"}},"catDetails":[{"name":"All","startOffset":0,"gender":"Open","catType":"Custom","laps":0,"pos":[17,16,23,15,26,21,20,25,18,22,19,24],"gapValue":[0,1.81826,1.99577,-6,-23,-24,-32,-61,-76,0,0,0],"iSort":0},{"name":"Pro Women (Women)","startOffset":0.0,"gender":"Women","catType":"Start Wave","laps":500,"pos":[17,16,23,15,26,21,20,25,18,22,19,24],"starters":10,"finishers":9,"gapValue":[0,1.81826,1.99577,-6,-23,-24,-32,-61,-76,0,0,0],"iSort":1,"distanceUnit":"km"}],"flags":{"CAN":"data:image/png;base64,b'iVBORw0KGgoAAAANSUhEUgAAABYAAAAOCAYAAAArMezNAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oDBAgpLM8+2t4AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAB00lEQVQ4y4WUv0r1QBDFf7O7uaDxfycIFlYiFrYiPoDgc1hdCysbfQOfxsJe0MJOGwWtFRVj5/VqsvMVY5LN1cs3MGQ3M3P25MxseFhbu9LZWdW5OdWZGfN+XzVG/a/FqLq3p+qcuYgq6MPy8lXAuUgIoArOQYwgQsdU23fpGqzG+zZm9TE0AVULiljyKOj5ue23t7vgIr/rvSfg/XjgGuDyEg4PbX9yApubbX5KrM53DtcEUq+Ba1Y3N3B3B7e3cH3djf1VL/IDXAfTZ1nCwQFsbMDUFIQAWWbr9XXY37ecv4C9J/wSv/6cLDMJXl7g+Nj2qnB0BIMBXFzYu1Tj2p1LNE6BvYeigMlJY1pVbXFZ2jrP4e2NTo8SYDdOI+bn4fQUdnYMuLYYYXcXzs5gYaFlPNKj0AR+GKsqUjcvz6Hft+atrBib+3vTN89b2VLGMZrG38/PlK+vyPQ0bmIC6fXagwBWV03Px0cDWVxsZRs3biKEOBhQFgWxKGyKvMdvbeHKEuc9Uo/V+zv0el3QGti5BljAGCug6e2tKsqPD/j6AhGTRgSWlhDnkM/PJlcAigJ9emr0lxgZhkAQEceoJf+ChnGWoYDG2L3uw6GNX3pYVbl/zcMFi4AdcekAAAAASUVORK5CYII='","USA":"data:image/png;base64,b'iVBORw0KGgoAAAANSUhEUgAAABYAAAAOCAYAAAArMezNAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9oDBAw0JU6HproAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAChUlEQVQ4y62TvW+TVxTGf+fe+9qOTRznS1ES0kQKKEg0YqESCzMLA0vVoVuH7h070KkrEv8BCwszc8cufC0IGCiUJGAwwXaa+iO24/t08IvzOhUbV7rSvUe65/zuc55jV7//7cFeY/jdpa1VPjb+5cWrGusrc6wuVXjxd41C74h7+49o45EEAFK6QQiiSC+YxP7SzMPQPerHteUF3lTr5ELg0oVVOt0+O9U68+Uihy3YfnT/uN/ukWbl9FImZGbu9c7OICS5QKfTp1yaYjAYUm+2yOcT5islGoddXPeIp1du+DYeFMd5laFEGoUlTLL9xbILBhSLOWIUPjhmykUURa9/TLGQ0JkusX33Du1O7wvAAuyEGHj9/h2hPxiw+U2Fx8/esDA7zcVzy7za3WenesDW5gr16ide/vzrsCVnxJj5/im9EYpgkquVCzHMlku8rTW5fHGdw3aPx892ma+UuPztBnsfmiwuVbT607XQ6h2f0OozpSaLpNF4eOCDdwYRCvmEbm8wksQ7cknAOUMxWuvJ82FrEMdf1wSpjbsnCQPXUT+G7a2zUlLGHFqYm2ZzbRHMMIOFuWmKTgyO3oFLE8hGrJbV2VJHgGm0w4/rZ2yjMsOomCY0NAwJjm3W57Ke0liE9KBRMYGZUfyn4cLHP/4c+u5QQlEZ46PP2gkiIwwxbpRJ6fF/Q+M+nckNw+IP193a8oqZmfOFPD5JGBcg49EJq2UtpomQYRaqb1346+Yta35ojjQTWPAkpSJhagpfyOPzuVO2AqIyUmRGW8KiqM1MWTh/+2bcOLsmSfH0jCp95LwfNxSzk3EwG2ucgXbJ3m4ML3/5PTRqByYzz1dYJlFfqoT/AGrIYCTo28W2AAAAAElFTkSuQmCC'"},"riderDashboard":"{-{!DOCTYPE html}-}\n{-{html}-}\n{-{!--\nHtml Template for Rider Dashboard.\nGenerated from CrossMgr software.\nCopyright Edward Sitarski\nFor details, see sites.google.com/site/CrossMgrSoftware\n--}-}\n{-{head}-}\n{-{meta charset=\"UTF-8\"}-}\n{-{meta name=\"author\" content=\"Edward Sitarski\"}-}\n{-{meta name=\"copyright\" content=\"Edward Sitarski\"}-}\n{-{meta name=\"generator\" content=\"CrossMgr\"}-}  \n{-{meta name=\"keywords\" content=\"CrossMgr, Cycling, Race, Results\"}-}\n{-{title id=\"idTitle\"}-}TTIITTLLEE{-{/title}-}\t{-{!-- Don't change this text! --}-}\n{-{style type=\"text/css\"}-}\nbody { font-family: sans-serif; }\n.hidden { display: none; }\ndiv label input {\nmargin-right:220px;\n}\nselect {\nfont-size: 110%;\n}\n@media print { .noprint { display: none; } }\n{-{/style}-}\n{-{script type=\"text/javascript\" src=\"https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization',\n'version':'1','packages':['table', 'corechart', 'timeline',]}]}\"}-}{-{/script}-}\n{-{script type=\"text/javascript\"}-}\ngoogle.setOnLoadCallback(onLoad);\nvar payload = null;\nvar bib = null;\nvar data = null;\nvar catDetails = null;\nvar raceName = null;\nvar bibRef = null;\nvar categoryCur = null;\nArray.prototype.back = function() {\nreturn this[this.length-1];\n}\nArray.prototype.binSearch = function( v ) {\nvar L = this.length, i = -1, m;\nwhile( L - i }-} 1 ) {\nif( this[m = ((L + i)}-}}-}1)] {-{ v )\ni = m;\nelse\nL = m;\n}\nreturn L;\n}\nfunction getOrdinal( n ) {\nvar s = ['th', 'st', 'nd', 'rd'], v = n%100;\nreturn n + (s[(v-20)%10]||s[v]||s[0]);\n}\nfunction byte2Hex(n) {\nvar nybHexString = \"0123456789ABCDEF\";\nreturn String(nybHexString.substr((n }-}}-} 4) & 0x0F,1)) + nybHexString.substr(n & 0x0F,1);\n}\nfunction RGB2Color(r,g,b) {\nreturn '#' + byte2Hex(r) + byte2Hex(g) + byte2Hex(b);\n}\nfunction makeColorGradient(frequency1, frequency2, frequency3,\nphase1, phase2, phase3,\ncenter, width, len)\n{\nif (len == undefined)      len = 50;\nif (center == undefined)   center = 128;\nif (width == undefined)    width = 127;\nvar grad = [];\nfor (var i = 0; i {-{= len; ++i)\n{\nvar red = Math.sin(frequency1*i + phase1) * width + center;\nvar grn = Math.sin(frequency2*i + phase2) * width + center;\nvar blu = Math.sin(frequency3*i + phase3) * width + center;\ngrad.push( RGB2Color(red,grn,blu) );\n}\nreturn grad.slice(1);  \n}\nvar colors = makeColorGradient(2.4,2.4,2.4,0,2,4,128,127,500);\nvar catList = [];\nfunction dataProlog() {\nif( payload ) { for( v in payload ) window[v] = payload[v]; payload = null; }\ncategoryCur = null;\nfor( var i = 0; i {-{ catDetails.length; ++i ) {\nif( catDetails[i].name == 'All' )\ncontinue;\nvar cat = catDetails[i];\nfor( var p = 0; p {-{ cat.pos.length; ++p ) {\nif( cat.pos[p] == bib ) {\ncat.place = (p+1) + '/' + cat.pos.length;\ncat.iCat = i;\ncatList.push( cat );\nif( !categoryCur || cat.pos.length {-{ categoryCur.pos.length )\ncategoryCur = cat;\nbreak;\n}\n}\n}\ncatList.sort( function(x, y) { return x.pos.length - y.pos.length || x.iCat - y.iCat; } );\ndocument.getElementById( 'idRaceName' ).innerHTML = raceName;\n}\nfunction GetName( bib ) {\nvar d = data[bib];\nif( !d )\treturn '';\nif( d.LastName && d.FirstName )\treturn d.FirstName + ' ' + d.LastName;\nreturn d.LastName || d.FirstName || '';\n}\nfunction GetBibName( bib ) {\nreturn bib + ': ' + GetName(bib);\n}\nfunction GetDateFromSecs( t ) {\nvar secs = ~~t;\nvar h = ~~(secs / (60*60));\nvar m = (~~(secs / 60) % 60);\nvar s = ~~(secs % 60);\nvar ms = (t - secs) * 1000.0;\nreturn new Date( 0, 0, 0, h, m, s, ms );\n}\nfunction FormatTimeHMS( t, highPrecision )\n{\nvar tStr = '';\nif( t {-{ 0 )\n{\ntStr = '-';\nt = -t;\n}\nvar secs = ~~t;\nvar h = ~~(secs / (60*60));\nvar m = (~~(secs / 60) % 60);\nvar s = (~~(secs % 60) + t - secs).toFixed( highPrecision ? 3 : 0 );\nif( h }-} 0 )\ntStr += h + 'h' + (m{-{10?'0':'') + m + 'm' + (s{-{10?'0':'') + s + 's';\nelse if( m }-} 0 )\ntStr += m + 'm' + (s{-{10?'0':'') + s + 's';\nelse\ntStr += s + 's';\nreturn tStr;\n}\nfunction FormatTime( t, highPrecision )\n{\nvar tStr = '';\nif( t {-{ 0 )\n{\ntStr = '-';\nt = -t;\n}\nvar secs = ~~t;\nvar h = ~~(secs / (60*60));\nvar m = (~~(secs / 60) % 60);\nvar s = (~~(secs % 60) + t - secs).toFixed( highPrecision ? 3 : 0 );\nif( h }-} 0 )\ntStr += h + (m {-{ 10 ? ':0' : ':') + m + (s {-{ 10 ? ':0' : ':') + s;\nelse\ntStr += m + (s {-{ 10 ? ':0' : ':') + s;\nreturn tStr;\n}\nfunction FormatTimeGap( t, highPrecision ) {\nvar tStr = '';\nif( t {-{ 0 )\n{\ntStr = '-';\nt = -t;\n}\nvar secs = ~~t;\nvar h = ~~(secs / (60*60));\nvar m = (~~(secs / 60) % 60);\nvar s = (~~(secs % 60) + t - secs).toFixed( highPrecision ? 3 : 0 );\nif( h }-} 0 )\ntStr += h + (m {-{ 10 ? 'h0' : 'h') + m + (s {-{ 10 ? \"'0\" : \"'\") + s;\nelse\ntStr += m + (s {-{ 10 ? \"'0\" : \"'\") + s;\ntStr += '\"';\nreturn tStr;\n}\nfunction FormatDistanceGap( d, distanceUnit ) {\nvar suffix = 'behind';\nif( d {-{ 0 ) {\nd *= -1;\nsuffix = 'ahead';\n}\nif( distanceUnit == 'km' ) {\nif( d {-{ 0.1 )\nreturn (d*1000.0).toFixed(1) + ' m ' + suffix;\nreturn d.toFixed(1) + ' ' + distanceUnit + ' ' + suffix;\n}\nelse {\nif( d {-{= 0.1 )\nreturn (d*5280.0).toFixed(0) + ' ft ' + suffix;\nreturn d.toFixed(1) + ' ' + distanceUnit + ' ' + suffix;\n}\n}\nfunction getPositionByLap( bibIn ) {\nvar timeLapPosBib = [];\nfor( var i = 0; i {-{ categoryCur.pos.length; ++i ) {\nvar bibCur = categoryCur.pos[i];\nvar d = data[bibCur];\nfor( var r = 1; r {-{ d.raceTimes.length; ++r )\ntimeLapPosBib.push( {time:d.raceTimes[r] - d.raceTimes[0], lap:r, pos:i, bib:bibCur} );\n}\nif( timeLapPosBib.length == 0 )\nreturn [];\ntimeLapPosBib.sort( function(x, y) {return (x.time - y.time) || (y.lap - x.lap) || (x.pos - y.pos);} );\nvar positionByLap = [];\nvar competitorCount = categoryCur.pos.length;\nvar seenLeader = {}; seenLeader[timeLapPosBib[0].bib] = true;\nfor( var i = 0; i {-{ timeLapPosBib.length; ++i ) {\nvar bibCur = timeLapPosBib[i].bib;\nif( !seenLeader[bibCur] ) {\nseenLeader[bibCur] = true;\ncontinue;\n}\nseenLeader = {}; seenLeader[bibCur] = true;\nvar seen = {};\nvar positionThisLap = [];\nfor( var j = i; j {-{ timeLapPosBib.length && positionThisLap.length {-{ competitorCount; ++j ) {\nvar bibCur = timeLapPosBib[j].bib;\nif( !seen[bibCur] ) {\npositionThisLap.push( timeLapPosBib[j] );\nseen[bibCur] = true;\n}\n}\npositionThisLap.sort( function(x, y) {return (y.lap - x.lap) || (x.time - y.time) || (x.pos - y.pos);} );\ncompetitorCount = positionThisLap.length;\nfor( var j = 0; j {-{ positionThisLap.length; ++j ) {\nif( positionThisLap[j].bib == bibIn ) {\npositionByLap.push( j + 1 );\nbreak;\n}\n}\n}\nreturn positionByLap;\n}\nfunction updateCategories() {\nvar categorySelect = document.getElementById( 'idCategorySelect' );\ncategorySelect.innerHTML = '';\ncategoryCur = null;\nfor( var i = 0; i {-{ catList.length; ++i ) {\nvar cat = catList[i];\nif( !categoryCur )\ncategoryCur = cat;\nvar op = document.createElement( 'option' );\nop.value = i;\nop.text = cat.name;\nop.selected = (cat == categoryCur ? true : false);\ncategorySelect.add( op );\n}\nupdateCompare();\n}\nfunction updateCategoryResults() {\nvar d = data[bib];\nvar cr = [];\nfor( var i = 0; i {-{ catList.length; ++i ) {\ncr.push( '{-{strong}-}' + catList[i].place + '{-{/strong}-} in ' + catList[i].name );\n}\ncr.push( '{-{br/}-}{-{br/}-}' );\nif( d.status == 'Finisher' && d.raceTimes && d.raceTimes.length }-}= 2 ) {\nvar s = 'Finished in ' + FormatTimeHMS(d.raceTimes.back() - d.raceTimes[0], true);\nif( d.speed )\ns += ' at ' + d.speed;\ncr.push( s );\n}\nelse if( d.status != 'Finisher' )\ncr.push( d.status );\ndocument.getElementById( 'idCategoryResults' ).innerHTML = 'Placed: ' + cr.join('&nbsp;&nbsp;&nbsp;');\n}\nfunction categorySelectChange( select ) {\ncategoryCur = catList[select.options[select.selectedIndex].value];\nupdateCompare();\nupdateCompareDisplays();\n}\nfunction updateCompare() {\nvar categorySelect = document.getElementById( 'idCategorySelect' );\nvar compareSelect = document.getElementById( 'idCompareSelect' );\ncompareSelect.innerHTML = '';\nbibRef = null;\nvar iBib = null;\nfor( var i = 0; i {-{ categoryCur.pos.length; ++i ) {\nvar bibCur = categoryCur.pos[i];\nif( bibCur == bib ) {\niBib = i;\ncontinue;\n}\nif( !bibRef )\nbibRef = bibCur;\nvar d = data[bibCur];\nif( !(d.raceTimes && d.raceTimes.length }-}= 2) )\ncontinue;\nif( !(i {-{ 20 || (iBib != null && (iBib-3 {-{ i || i {-{ iBib+2))) )\ncontinue;\nvar op = document.createElement( 'option' );\nop.value = bibCur;\nop.text = (i+1) + '.  ' + GetName(bibCur);\ncompareSelect.add( op );\n}\n}\nfunction compareSelectChange( select ) {\nbibRef = null;\nif( select.options.length )\nbibRef = select.options[select.selectedIndex].value;\nupdateCompareDisplays();\n}\nfunction updateLapTable() {\nvar container = document.getElementById( 'idLapTable' );\nif( !container.table )\ncontainer.table = new google.visualization.Table( container );\nvar spacer = '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';\nvar d = data[bib];\nvar hasSpeed = (d.speed && d.lapSpeeds && d.lapSpeeds.length }-} 0);\nvar dataTable = new google.visualization.DataTable();\ndataTable.addColumn( 'number', 'Lap' );\ndataTable.addColumn( 'number', 'Lap Time' );\ndataTable.addColumn( 'number', 'Race Time' + (!hasSpeed ? spacer : '') );\nif( hasSpeed )\ndataTable.addColumn( 'number', 'Lap Speed' + ' (' + d.speed.split(' ')[1] + ')' + spacer );\nfor( var r = 1; r {-{ d.raceTimes.length; ++r ) {\nvar lapTime = d.raceTimes[r] - d.raceTimes[r-1];\nvar raceTime = d.raceTimes[r] - d.raceTimes[0];\nvar row = [r, { v:lapTime, f:FormatTime(lapTime, true) }, { v:raceTime, f:FormatTime(raceTime, true) + (!hasSpeed ? spacer : '') }];\nif( hasSpeed )\nrow.push( { v:d.lapSpeeds[r-1], f:d.lapSpeeds[r-1].toFixed(2) + spacer } );\ndataTable.addRow( row );\n}\nvar options = {allowHtml: true};\nif( dataTable.getNumberOfRows() }-} 10 )\noptions['page'] = 'enable';\ncontainer.table.draw( dataTable, options );\n}\nfunction GetGap( bib, bibRef ) {\nvar d = data[bib], dRef = data[bibRef];\nif( !d || !dRef || !d.raceTimes || !dRef.raceTimes || d.raceTimes.length==0 || dRef.raceTimes.length==0 )\nreturn {v:0, f:''};\nif( d.raceTimes.length != dRef.raceTimes.length ) {\nvar lapsDown = dRef.raceTimes.length - d.raceTimes.length;\nreturn {v:lapsDown*1000.0*60.0*60.0, f:-lapsDown + (Math.abs(lapsDown) }-} 1 ? ' laps' : ' lap') + (lapsDown {-{ 0 ? ' more' : '')};\n}\nvar g = (d.raceTimes.back() - d.raceTimes[0]) - (dRef.raceTimes.back() - dRef.raceTimes[0]);\nreturn {v:g, f:FormatTimeGap(g)};\n}\nfunction GetGapDistance( bib, bibRef ) {\nvar d = data[bib], dRef = data[bibRef];\nif( !d || !dRef || !d.raceTimes || !dRef.raceTimes || d.raceTimes.length==0 || dRef.raceTimes.length==0 ||\n!d.speed )\nreturn {v:0, f:''};\nvar speedUnit = d.speed.split(' ')[1];\nvar distanceUnit = (speedUnit.substring(0,1) == 'm' ? 'miles' : 'km');\nvar distance = 0, t = 0;\nif( d.lapSpeeds && d.lapSpeeds.length }-} 0 ) {\nt = (d.raceTimes.back() - d.raceTimes.slice(-2,-1)[0]) / (60.0*60.0);\ndistance = t * d.lapSpeeds.back();\n}\nelse {\nt = (d.raceTimes.back() - d.raceTimes[0]) / (60.0*60.0);\ndistance = t * d.speed;\n}\nif( d.raceTimes.length != dRef.raceTimes.length ) {\nvar lapsDown = dRef.raceTimes.length - d.raceTimes.length;\nreturn {v:lapsDown*distance, f:FormatDistanceGap(lapsDown*distance,distanceUnit)};\n}\nvar g = ((d.raceTimes.back() - d.raceTimes[0]) - (dRef.raceTimes.back() - dRef.raceTimes[0])) / (60.0*60.0);\nvar distanceGap = (g / t) * distance;\nreturn {v:distanceGap, f:FormatDistanceGap(distanceGap, distanceUnit)};\n}\nfunction GetPlace( bib ) {\nfor( var i = 0; i {-{ categoryCur.pos.length; ++i )\nif( categoryCur.pos[i] == bib )\nreturn {v:i, f:(i+1) + '/' + categoryCur.pos.length};\nreturn '';\n}\nfunction GetTime( bib ) {\nvar d = data[bib];\nif( !d || !d.raceTimes || !d.raceTimes.length )\nreturn {v:0, f:''};\nvar t = d.raceTimes.back() - d.raceTimes[0];\nreturn {v:t, f:FormatTime(t, true) };\n}\nfunction GetEstimatedLapTime( bib ) {\nvar d = data[bib];\nif( !d || !d.raceTimes || d.raceTimes.length {-{ 2 )\nreturn 99999999999;\nif( d.raceTimes }-} 2 )\nreturn (d.raceTimes.back() - d.raceTimes[1]) / (d.raceTimes.length-2);\nreturn (d.raceTimes.back() - d.raceTimes[0]) / (d.raceTimes.length-1);\n}\nfunction GetPercentComparison( bib, bibRef ) {\nvar d = data[bib], dRef = data[bibRef];\nif( !d || !dRef || !d.raceTimes || !dRef.raceTimes || d.raceTimes.length {-{ 2 || dRef.raceTimes.length {-{ 2 )\nreturn {v:0, f:''};\nvar t = d.raceTimes.back() - d.raceTimes[0], tRef = dRef.raceTimes.back() - dRef.raceTimes[0];\nif( d.raceTimes.length {-{ dRef.raceTimes.length )\nt += GetEstimatedLapTime(bib) * (dRef.raceTimes.length - d.raceTimes.length);\nelse if( d.raceTimes.length }-} dRef.raceTimes.length )\ntRef += GetEstimatedLapTime(bibRef) * (d.raceTimes.length - dRef.raceTimes.length);\nvar p = 1.0 - t/tRef;\nreturn {v:p, f:(p == 0 ? '' : (Math.abs(p)*100).toFixed(1) + (p{-{0 ? '% slower' : p}-}0 ? '% faster' : ''))};\n}\nfunction updateInfoTable() {\nvar container = document.getElementById( 'idInfoTable' );\nif( !container.table )\ncontainer.table = new google.visualization.Table( container );\nvar d = data[bib];\nvar dataTable = new google.visualization.DataTable();\ndataTable.addColumn( 'string', 'Name' );\ndataTable.addColumn( 'number', 'Place' );\ndataTable.addColumn( 'number', 'Time' );\ndataTable.addColumn( 'number', 'Gap' );\nif( d.speed ) {\ndataTable.addColumn( 'number', 'Est. Distance' );\ndataTable.addColumn( 'number', 'Avg Speed' + ' (' + d.speed.split(' ')[1] + ')' );\n}\ndataTable.addColumn( 'number', 'Comparison' );\nfor( var i = 0; i {-{ 2; ++i ) {\nvar bibCur = (i == 0 ? bib : bibRef);\nvar gap = (i != 0 ? {v:0,f:''} : GetGap(bib, bibRef));\nvar riderName = GetName(bibCur);\nvar d = data[bibCur];\nvar row = [ GetName(bibCur), GetPlace(bibCur), GetTime(bibCur), gap];\nif( d.speed ) {\nrow.push( i != 0 ? {v:0,f:''} : GetGapDistance(bib, bibRef) );\nvar s = parseFloat(d.speed.split(' ')[0]);\nrow.push( {v:s, f:s.toFixed(2)} );\n}\nrow.push( GetPercentComparison(bibCur, bibRef) );\ndataTable.addRow( row );\n}\ncontainer.table.draw( dataTable );\n}\nfunction updateGanttChart() {\nvar container = document.getElementById( 'idGanttChart' );\nif( !container.chart )\ncontainer.chart = new google.visualization.Timeline( container );\nvar dataTable = new google.visualization.DataTable();\ndataTable.addColumn( 'string', 'Rider' );\ndataTable.addColumn( 'string', 'Lap' );\ndataTable.addColumn( 'date', 'Start' );\ndataTable.addColumn( 'date', 'End' );\nvar maxLaps = 0;\nfor( var i = 0; i {-{ 2; ++i ) {\nvar bibCur = (i == 0 ? bib : bibRef);\nvar riderName = GetName(bibCur);\nvar d = data[bibCur];\nif( !d.raceTimes )\ncontinue;\nvar tLast = 0.0\nmaxLaps = Math.max( maxLaps, d.raceTimes.length );\nfor( var r = 1; r {-{ d.raceTimes.length; ++r ) {\nvar tNext = tLast + d.raceTimes[r] - d.raceTimes[r-1];\ndataTable.addRow( [\nriderName,\n'Lap ' + r,\nGetDateFromSecs(tLast),\nGetDateFromSecs(tNext)] );\ntLast = tNext;\n}\n}\nvar options = {\ncolors: colors.slice( maxLaps+1 ),\n};\ncontainer.chart.draw( dataTable, options );\n}\nvar numLabels = 4;\nfunction getTimeTicks( tMin, tMax, tFormat ) {\nvar d = (tMax - tMin) / numLabels;\nvar intervals = [0.01,0.05,0.1,0.2,0.5, 1, 2, 5, 10, 15, 20, 30, 1*60, 2*60, 5*60, 10*60, 15*60, 20*60, 30*60, 1*60*60, 2*60*60, 4*60*60, 8*60*60, 12*60*60, 24*60*60, 2*24*60*60, 5*24*60*60, 10*24*60*60, 20*24*60*60, 50*24*60*60 ];\nd = intervals[intervals.binSearch(d)];\nvar dMin = Math.floor(tMin / d) * d, dMax = Math.floor(tMax / d + 1) * d;\nvar ticks = [];\nfor( var t = dMin; t {-{= dMax; t += d )\nticks.push( {v:t, f:tFormat=='hms' ? FormatTimeHMS(t, d{-{1) : tFormat=='gap' ? FormatTimeGap(t, d{-{1) : FormatTime(t,d{-{1)} );\nreturn ticks;\n}\nfunction getPositionTicks( pMin, pMax ) {\nvar d = (pMax - pMin) / numLabels;\nvar intervals = [1, 2, 5, 10, 20, 25, 50, 100, 200, 500, 1000, 2000, 5000, 10000, 20000, 50000, 100000];\nd = intervals[intervals.binSearch(d)];\nvar dMin = Math.max(1, Math.floor(pMin / d) * d), dMax = Math.floor(pMax / d) * d;\nif( dMax {-{ pMax )\ndMax += d;\nvar ticks = [];\nfor( var p = dMin; p {-{= dMax; p += d )\nticks.push( {v:p, f:getOrdinal(p)} );\nreturn ticks;\n}\nfunction updateLapTimesChart() {\nvar container = document.getElementById( 'idLapTimesChart' );\nif( !container.chart )\ncontainer.chart = new google.visualization.LineChart( container );\nvar dataTable = new google.visualization.DataTable();\ndataTable.addColumn( 'string', 'Lap' );\ndataTable.addColumn( 'number', GetName(bib) );\nif( bibRef )\ndataTable.addColumn( 'number', GetName(bibRef) );\nvar dRef = data[bibRef];\nvar d = data[bib];\nvar tMin = 999999999, tMax = 0.0;\nvar rMax = Math.min(dRef.raceTimes.length, d.raceTimes.length);\nfor( var r = 1; r {-{ rMax; ++r ) {\nvar row = [\n'' + r,\n{\tv:r {-{ d.raceTimes.length ? d.raceTimes[r] - d.raceTimes[r-1] : 0,\nf:FormatTimeHMS(r {-{ d.raceTimes.length ? d.raceTimes[r] - d.raceTimes[r-1] : 0)\n}\n];\nif( bibRef )\nrow.push( {\tv:dRef.raceTimes[r] - dRef.raceTimes[r-1],\nf:FormatTimeHMS(dRef.raceTimes[r] - dRef.raceTimes[r-1]) } );\nfor( var k = 1; k {-{ row.length; ++k ) {\ntMin = Math.min( tMin, row[k].v );\ntMax = Math.max( tMax, row[k].v );\n}\ndataTable.addRow( row );\n}\nvar timeTicks = getTimeTicks( tMin, tMax, 'hms' );\nvar options = {\ntitle: 'Lap Times',\nvAxis: {\ntitle: \"lap time\",\nticks:timeTicks,\nviewWindow:{ min:timeTicks[0].v, max:timeTicks.back().v }\n},\nhAxis: {title: \"lap\"},\ncolors: ['blue', '#8888FF'],\npointSize: 5,\nchartArea: {left: '10%', width: '70%'},\nanimation: {duration: 250},\n};\ncontainer.chart.draw( dataTable, options );\n}\nfunction updateGapChart() {\nvar container = document.getElementById( 'idGapChart' );\nif( !container.chart )\ncontainer.chart = new google.visualization.LineChart( container );\nvar dataTable = new google.visualization.DataTable();\ndataTable.addColumn( 'string', 'Lap' );\ndataTable.addColumn( 'number', 'Gap' );\nvar dRef = data[bibRef];\nvar d = data[bib];\nvar tMin = 999999999, tMax = 0.0;\nvar rMax = Math.min(dRef.raceTimes.length, d.raceTimes.length);\nfor( var r = 1; r {-{ rMax; ++r ) {\nvar ab = bibRef ? (d.raceTimes[r] - d.raceTimes[0]) - (dRef.raceTimes[r] - dRef.raceTimes[0]) : 0.0;\ntMin = Math.min( tMin, ab );\ntMax = Math.max( tMax, ab );\ndataTable.addRow( [ '' + r, {v: ab, f: FormatTimeHMS(ab)} ] );\n}\nvar timeTicks = getTimeTicks( tMin, tMax, 'gap' );\nvar options = {\ntitle: 'Gap: ' + GetName(bib) + ' \\u21E8 ' + GetName(bibRef),\nvAxis: {\ntitle: \"gap\",\nticks:timeTicks,\nviewWindow:{min:timeTicks[0].v, max:timeTicks.back().v}\n},\nhAxis: {title: \"lap\"},\ncolors: ['blue'],\nlegend: 'none',\npointSize: 5,\nchartArea: {left: '10%', width: '70%'},\nanimation: {duration: 250},\n};\ncontainer.chart.draw( dataTable, options );\n}\nfunction updateLapPositionChart() {\nvar container = document.getElementById( 'idLapPositionChart' );\nif( !container.chart )\ncontainer.chart = new google.visualization.LineChart( container );\nvar pos1 = getPositionByLap( bib );\nvar pos2 = bibRef ? getPositionByLap( bibRef ) : [];\nvar dataTable = new google.visualization.DataTable();\ndataTable.addColumn( 'string', 'Lap' );\ndataTable.addColumn( 'number', GetName(bib) );\nif( bibRef )\ndataTable.addColumn( 'number', GetName(bibRef) );\nvar dLeader = data[bibRef];\nvar d = data[bib];\nvar positionMin = 999999, positionMax = 0;\nvar iMax = Math.min(pos1.length, pos2.length);\nfor( var i = 0; i {-{ iMax; ++i ) {\nvar row = [ '' + (i+1), pos1[i]];\npositionMin = Math.min(positionMin, pos1[i]);\npositionMax = Math.max(positionMax, pos1[i]);\nif( bibRef ) {\nrow.push( pos2[i] );\npositionMin = Math.min(positionMin, pos2[i]);\npositionMax = Math.max(positionMax, pos2[i]);\n}\ndataTable.addRow( row );\n}\ntickMarks = getPositionTicks( positionMin, positionMax );\nvar options = {\ntitle: 'Race Position by Lap',\nvAxis: {\ntitle: \"position\",\ndirection:-1,\nticks:tickMarks,\nminValue:positionMin,\nmaxValue:positionMax,\nviewWindow:{ min:tickMarks[0], max:tickMarks.back() }\n},\nhAxis: {title: \"lap\"},\ncolors: ['blue', '#8888FF'],\npointSize: 5,\nchartArea: {left: '10%', width: '70%'},\nanimation: {duration: 250},\n};\ncontainer.chart.draw( dataTable, options );\n}\nfunction updateCompareDisplays() {\nupdateInfoTable();\nupdateGanttChart();\nupdateLapTimesChart();\nupdateGapChart();\nupdateLapPositionChart();\n}\nfunction onLoad() {\ndataProlog();\nvar d = data[bib];\ndocument.getElementById('idHeader').innerHTML = GetBibName(bib) + (d.Team ? ' (' + d.Team + ')' : '');\nupdateCategoryResults();\nupdateCategories();\nupdateLapTable();\nupdateCompareDisplays();\n}\n{-{/script}-}\n{-{/head}-}\n{-{body}-}\n{-{h1 id=\"idHeader\"}-}{-{/h1}-}\n{-{h4 id=\"idRaceName\"}-}Race Name{-{/h4}-}\n{-{p id=\"idCategoryResults\"}-}Category Results{-{/p}-}\n{-{div id=\"idLapTable\"}-}{-{/div}-}\n{-{br/}-}\nCategory:&nbsp;{-{select id=\"idCategorySelect\" onchange=\"categorySelectChange(this)\"}-}{-{/select}-}&nbsp;&nbsp;&nbsp;&nbsp;Compare&nbsp;to:&nbsp;{-{select id=\"idCompareSelect\" onchange=\"compareSelectChange(this)\"}-}{-{/select}-}\n{-{br/}-}{-{br/}-}\n{-{div id=\"idInfoTable\"}-}{-{/div}-}\n{-{br/}-}\n{-{div id=\"idGanttChart\" style=\"width: 720px; height: 136px;\"}-}{-{/div}-}\n{-{div id=\"idLapTimesChart\" style=\"width: 900px; height: 180px;\"}-}{-{/div}-}\n{-{div id=\"idGapChart\" style=\"width: 900px; height: 180px;\"}-}{-{/div}-}\n{-{div id=\"idLapPositionChart\" style=\"width: 900px; height: 180px;\"}-}{-{/div}-}\n{-{a href=\"http://www.sites.google.com/site/crossmgrsoftware\" target=\"_blank\"}-}Powered by CrossMgr{-{/a}-}\n{-{/body}-}\n{-{/html}-}\n","travelMap":"{-{!DOCTYPE html}-}\n{-{html}-}\n{-{head}-}\n{-{meta charset=\"UTF-8\"}-}\n{-{meta name=\"author\" content=\"Edward Sitarski\"}-}\n{-{meta name=\"copyright\" content=\"Edward Sitarski\"}-}\n{-{meta name=\"generator\" content=\"CrossMgr\"}-}  \n{-{meta name=\"keywords\" content=\"CrossMgr, Cycling, Race, Results\"}-}\n{-{style}-}\nbody { font-family: sans-serif; }\n.tooltip {\nborder: thin 1px #eee;\nbackground-color: #FFFBF0;\npadding: 5px;\nwidth: 160px;\n}\n.left{\ndisplay: block;\nfloat: left;\nwidth: 33%;\n}\n{-{/style}-}\n{-{title}-}CrossMgr Travel Map{-{/title}-}\n{-{script src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyD2sl2JTvnyMcsgWc3tTceWCYo3ZoyWdAI&v=3.exp&libraries=visualization\"}-}{-{/script}-}\n{-{script type=\"text/javascript\" src=\"https://www.google.com/jsapi?autoload={'modules':[{'name':'visualization',\n'version':'1','packages':['table', 'corechart']}]}\"}-}{-{/script}-}\n{-{script}-}\nvar payload = null;\nvar raceName = null;\nvar raceAddress = null;\nvar raceCoords = [43.1656,-77.6114 - 0.5];\nvar raceLatLng = null;\nvar locationCount = [ /*(-*/\n[\"Baldwinsville, NY\",3],\n[\"Pittsfield, MA\",2],\n[\"East Aurora, NY\",3],\n[\"Webster, NY\",5],\n[\"Walworth, NY\",1],\n[\"West Falls, NY\",1],\n[\"Mendon, NY\",1],\n[\"Manlius, NY\",1],\n[\"Orchard Park, NY\",2],\n[\"Pittsford, NY\",3],\n[\"Brewerton, NY\",1],\n[\"Fairport, NY\",4],\n[\"Gowanda, NY\",1],\n[\"West Point, NY\",11],\n[\"Clay, NY\",1],\n[\"Fulton, NY\",1],\n[\"Medina, NY\",1],\n[\"Rochester, NY\",29],\n[\"Interlaken, NY\",1],\n[\"Amherst, NY\",2],\n[\"Penfield, NY\",2],\n[\"Honeoye Falls, NY\",2],\n[\"Tully, NY\",1],\n[\"Scarsdale, NY\",1],\n[\"Litchfield, CT\",1],\n[\"Trumansburg, NY\",1],\n[\"Geneseo, NY\",3],\n[\"Nazareth, PA\",1],\n[\"Greece, NY\",1],\n[\"Le Roy, NY\",1],\n[\"Henrietta, NY\",2],\n[\"Victor, NY\",4],\n[\"Elmira, NY\",1],\n[\"Cazenovia, NY\",1],\n[\"Paxton, MA\",1],\n[\"Big Flats, NY\",1],\n[\"Syracuse, NY\",2],\n[\"Buffalo, NY\",8],\n[\"Farmington, NY\",3],\n[\"Rocester, NY\",1]\n/*-)*/];\nvar locationGeocodeCount = 0;\nfunction lexical_compare( x, y ) {\nvar iMax = Math.min( x.length, y.length );\nfor( var i = 0; i {-{ iMax; ++i ) {\nif( x[i] {-{ y[i] )\t\treturn -1;\nif( x[i] }-} y[i] )\t\treturn 1;\n}\nreturn x.length {-{ y.length ? -1 : x.length }-} y.length ? 1 : 0;\n}\nfunction Tooltip(options) {\nthis.marker_ = options.marker;\nthis.content_ = options.content;\nthis.map_ = options.marker.get('map');\nthis.cssClass_ = options.cssClass||null;\nthis.div_ = null;\nthis.setMap(this.map_);\nvar me = this;\ngoogle.maps.event.addListener(me.marker_, 'mouseover', function() { me.show(); });\ngoogle.maps.event.addListener(me.marker_, 'mouseout', function() { me.hide(); });\n}\nTooltip.prototype = new google.maps.OverlayView();\nTooltip.prototype.onAdd = function() {\nvar div = document.createElement('DIV');\ndiv.style.position = \"absolute\";\ndiv.style.visibility = \"hidden\";\nif(this.cssClass_)\ndiv.className += \" \"+this.cssClass_;\ndiv.innerHTML = this.content_;\nthis.div_ = div;\nvar panes = this.getPanes();\npanes.floatPane.appendChild(this.div_);\t\n}\nTooltip.prototype.draw = function() {\nvar overlayProjection = this.getProjection();\nvar ne = overlayProjection.fromLatLngToDivPixel(this.marker_.getPosition());\nvar div = this.div_;\ndiv.style.left = ne.x + 'px';\ndiv.style.top = ne.y + 'px';\n}\nTooltip.prototype.onRemove = function() {\nthis.div_.parentNode.removeChild(this.div_);\n}\nTooltip.prototype.hide = function() {\nif (this.div_) {\nthis.div_.style.visibility = \"hidden\";\n}\n}\nTooltip.prototype.show = function() {\nif (this.div_) {\nthis.div_.style.visibility = \"visible\";\n}\n}\nvar geocoder = null;\nvar map = null;\nvar bounds = null;\nvar heatmap = null;\nvar pointArray = [];\nfunction addMarker( coord, content, markerOptions ) {\nif( !map ) {\nmap = new google.maps.Map(document.getElementById('map-canvas'), { zoom: 6, center: coord });\nbounds = new google.maps.LatLngBounds();\nheatmap = new google.maps.visualization.HeatmapLayer({ map: map, radius: 80 });\n}\nbounds.extend( coord );\nif( !markerOptions ) markerOptions = {};\nmarkerOptions.map = map;\nmarkerOptions.position = coord;\nmarker = new google.maps.Marker( markerOptions );\nvar tooltip = new Tooltip({ marker:marker, content:content, cssClass:'tooltip' });\nreturn marker;\n}\nfunction initialize() {\nif( payload ) { for( v in payload ) window[v] = payload[v]; payload = null; }\nlocationCount.sort( function(x, y) { return lexical_compare([-x[1], x[0]], [-y[1], y[0]]); } );\nvar countMax = 0, countTotal = 0;\nfor( var i = 0; i {-{ locationCount.length; ++i ) {\ncountTotal += locationCount[i][1];\ncountMax = Math.max( countMax, locationCount[i][1] );\n}\nvar countFactor = 32 * (countMax / countTotal);\ngeocoder = new google.maps.Geocoder();\nvar icon = 'data:image/png;base64,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';\nvar content = '{-{h3}-}Race{-{/h3}-}{-{div}-}Participants: {-{strong}-}' + countTotal + '{-{/strong}-}{-{/div}-}';\nif( raceCoords && raceCoords.length == 2 ) {\nraceLatLng = new google.maps.LatLng(raceCoords[0], raceCoords[1]);\naddMarker( raceLatLng, content, { zIndex: locationCount.length+1, icon: icon } );\n}\nelse if( raceAddress ) {\ngeocoder.geocode( {'address': raceAddress}, function(results, status) {\nif( status == google.maps.GeocoderStatus.OK ) {\nraceLatLng = results[0].geometry.location;\naddMarker( raceLatLng, content, { zIndex: locationCount.length+1, icon: icon } );\n}\nelse\nconsole.log('\"' + raceAddress + '\": Geocode unsuccessful: ' + status);\n}\n);\n}\nlocationGeocodeCount = 0;\nvar delay = 300;\nfunction showLocation() {\nif( locationGeocodeCount == locationCount.length ) {\nmap.fitBounds( bounds );\nheatmap.setData( pointArray )\n}\nelse {\nfunction getGeocodeCallback(address, count) {\nfunction doGeocode(results, status) {\nif( status == google.maps.GeocoderStatus.OK ) {\nvar coord = results[0].geometry.location;\nvar content = '{-{h3}-}'+ address + '{-{/h3}-}' + '{-{div}-}Participants: {-{strong}-}' + count + '{-{/strong}-}{-{/div}-}';\nvar href = null;\nif( raceLatLng ) {\ncontent += 'Click for Directions...';\nhref = 'http://www.google.com/maps/?' +\n'saddr=' + coord.lat() + ',' + coord.lng() +\n'&daddr=' + raceLatLng.lat() + ',' + raceLatLng.lng();\n}\nvar marker = addMarker( coord, content, {zIndex: locationCount.length-locationGeocodeCount} );\nif( href )\ngoogle.maps.event.addListener( marker, 'click', function() { window.open(href, '_blank'); } );\npointArray.push( {location: coord, weight: count} );\nheatmap.setData( pointArray );\nsetTimeout( showLocation, delay );\n}\nelse if( status == google.maps.GeocoderStatus.OVER_QUERY_LIMIT ) {\nconsole.log('\"' + address + '\": Geocode unsuccessful: ' + status);\n--locationGeocodeCount;\nif( map && bounds )\nmap.fitBounds( bounds );\nsetTimeout( showLocation, 2000 );\n}\nelse {\nconsole.log('\"' + address + '\": Geocode unsuccessful: ' + status);\nsetTimeout( showLocation, delay );\n}\n}\nreturn doGeocode;\n}\nvar lc = locationCount[locationGeocodeCount++];\ngeocoder.geocode( { 'address': lc[0]}, getGeocodeCallback(lc[0], lc[1]) );\n}\nupdateTitle();\n}\nsetTimeout( showLocation, delay );\nupdateLocationCountPieChart();\nupdateLocationRegionCountPieChart();\nupdateLocationCountTable();\n}\nfunction updateTitle() {\ndocument.getElementById( 'idTitle' ).innerHTML =\n(raceName ? raceName : 'Race') + ' Travel Map' +\n' (showing ' + locationGeocodeCount + '/' + locationCount.length + ' locations)';\n}\nfunction updateLocationCountTable() {\nvar container = document.getElementById( 'idLocationCountTable' );\nif( !container.table )\ncontainer.table = new google.visualization.Table( container );\nvar dataTable = new google.visualization.DataTable();\ndataTable.addColumn( 'string', 'City' );\ndataTable.addColumn( 'number', '#' );\ndataTable.addColumn( 'number', '%' );\ndataTable.addColumn( 'number', 'Sum' );\nvar total = 0.0;\nfor( var i = 0; i {-{ locationCount.length; ++i )\ntotal += locationCount[i][1];\nvar cumulative = 0.0, cumulativePercent = 0.0;\nfor( var i = 0; i {-{ locationCount.length; ++i ) {\ncumulative += locationCount[i][1];\nvar percent = 100 * locationCount[i][1] / total;\ncumulativePercent += percent;\ndataTable.addRow( [\nlocationCount[i][0],\nlocationCount[i][1],\n{v:locationCount[i][1], f:percent.toFixed(1)},\n{v:cumulative, f:cumulative.toFixed(0) + ' (' + cumulativePercent.toFixed(1) + '%)'}\n] );\n}\ncontainer.table.draw( dataTable );\n}\nfunction updateLocationCountPieChart() {\nvar container = document.getElementById( 'idLocationCountPieChart' );\nif( !container.chart )\ncontainer.chart = new google.visualization.PieChart( container );\nvar chartData = [['Location', 'Count']];\nfor( var i = 0; i {-{ locationCount.length; ++i )\nchartData.push( [locationCount[i][0], locationCount[i][1]] );\nvar data = google.visualization.arrayToDataTable( chartData );\nvar options = { title: 'Cities (' + locationCount.length + ')', pieHole: 0.4, legend: 'none' };\ncontainer.chart.draw(data, options);\n}\nfunction updateLocationRegionCountPieChart() {\nvar container = document.getElementById( 'idLocationRegionCountPieChart' );\nif( !container.chart )\ncontainer.chart = new google.visualization.PieChart( container );\nvar rc = {};\nfor( var i = 0; i {-{ locationCount.length; ++i ) {\nvar fields = locationCount[i][0].split( ',' );\nvar region = fields[fields.length-1].trim();\nif( region in rc )\nrc[region] += 1;\nelse\nrc[region] = 1;\n}\nvar regionCount = [];\nfor( region in rc )\nregionCount.push( [region, rc[region]] );\nregionCount.sort( function(x, y) { return lexical_compare([-x[1], x[0]], [-y[1], y[0]]); } );\nvar chartData = [['Region', 'Count']];\nfor( var i = 0; i {-{ regionCount.length; ++i )\nchartData.push( [regionCount[i][0], regionCount[i][1]] );\nvar data = google.visualization.arrayToDataTable( chartData );\nvar options = { title: 'Regions (' + regionCount.length + ')', pieHole: 0.4, legend: 'none' };\ncontainer.chart.draw(data, options);\n}\ngoogle.maps.event.addDomListener(window, 'load', initialize);\n{-{/script}-}\n{-{/head}-}\n{-{body}-}\n{-{h2 id=\"idTitle\"}-}{-{/h2}-}\n{-{div id=\"map-canvas\" style=\"display: block; float: left; width: 100%; height: 500px\"}-}{-{/div}-}\n{-{div}-}\n{-{div id=\"idLocationCountPieChart\" style=\"height: 400px\" class=\"left\"}-}{-{/div}-}\n{-{div id=\"idLocationRegionCountPieChart\" style=\"height: 400px\" class=\"left\"}-}{-{/div}-}\n{-{div id=\"idLocationCountTable\" style=\"height: 400px\" class=\"left\"}-}{-{/div}-}\n{-{/div}-}\n{-{p/}-}\nPowered by {-{a href=\"http://www.sites.google.com/site/crossmgrsoftware\"}-}CrossMgr{-{/a}-}.\n{-{/body}-}\n{-{/html}-}\n"};
/* !!! payload end !!! */
var raceName = null;
var organizer = null;
var timestamp = null;
var email = null;
var raceAddress = null;
var raceIsRunning = null;
var raceWasRunning = null;
var raceIsUnstarted = null;
var raceIsFinished = null;
var data = null;
var catDetails = null;
var isTimeTrial = null;
var winAndOut = null;
var catDetailsByName = {};
var lapDetails = null;
var hideDetails = null;		
var showDetails = false;	
var showCourseAnimation = true;
var version = null;
var raceNotes = null;
var primes = null;
var arrivalMode = null;
var mapMode = null;
var cycleCategoriesMode = null;
var catPosIndex = null;
var showCategorySummary = null;
var kioskMode = null;
var licenseLinkTemplate = null;
var flags = null;
var canvas = null;
var r = 100.0;				
var t = 0.0;				
var tLast = 0.0;			
var tDelta = 0.0;			
var tMax = 0.0;				
var laneMax = 8;			
var lapCur = 0;				
var framesPerSecond = 32;	
var speedup = 1.0;			
var categories = [];		
var categoryCur = 'All';	
var animationSeconds = 90;	
var suspendAnimation = false;	
var numsToWatchStr = null;	
var categoryStr = null;		
var numsToWatch = {};		
var resultsDiv = null;
var showLapsFrequency = -1;	
var lapDataOption = 0;		
var loopContinuously = true;
var fontMult = 1.0;			
var showTimeDecimals = false;
var displayUnits = 'km';
var reverseDirection = null;	
var finishTop = null;			
var tRace = null;				
var raceStartTime = null;		
var animationObj = null;		
var situationObj = null;
var lapChartObj = null;
var catUpdateTime = {};			
var rfid = null;				
var gpsPoints = null;			
var gpsTotalElevationGain = null;	
var gpsAltigraph = null;		
var gpsIsPointToPoint = null;	
var courseCoordinates = null;	
var courseViewerTemplate = null;
var travelMap = null;	
var infoFields = null;			
var langCur = null;				
var roadRaceFinishTimes = null;	
var gpsPointsTest =  [ ];
var checkeredFlag = new Image();
checkeredFlag.src =
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAgCAYAAAD5VeO1AAAEsklEQVRIibWVX0jTaxjHH//029lcVqvM0taNGUHNinGOnkGohJWtQ4KaFEVySlSSUixzTFwZxYnROv2ByisLgwqCIRRhF4EcKsjgeBrDgUqYDhvLJtoyt33OTZPCKLX83L0Xz+f78uV5eUVmiM/na/b7/TUznfsuL1++PM4nbt682V5VVbXkp4jLy8uP6/V6Hj58yPPnz1mwYAEGg2Hs6NGjuT8kttvtxuXLl4dFhNWrV3PhwgXi4uIQEaxW65jP58uflbijo2Phhw8f/m1tbSUpKYlnz54BcP/+fUpLSwmFQkQikbDX6z1ps9lipy222Wyxbre7LdpzU1MTPT09AHg8HrZs2YLb7QagsbGRnJyc/rq6Ov205Lt3725ftWoVT5484erVq4gIS5cuxel0YjQaERF0Oh3Xr1+frGnjxo3B3t5ewzfFTU1NtfPmzUNEKCgowGKxEBMTQ3x8PE6nk4aGBmJjYzGZTLx//57z58+jUqm4ceMGoVAo8ObNm+Kvint7ew0TExOBy5cvk5GRgc/nA+DWrVs4HI5oS7S0tEzWAnDt2jX8fj8Aw8PDrVPEJ06cSHv9+nUPwOjoKBUVFQwMDADgdDoxmUy8evWKjx8/snXrVtavX4/L5eLx48eo1WrS09Pp6OhwtbW1ab4QX7x4UTGZTENr166lq6uL/fv3IyLo9Xru3r2LTqdDRFixYgV2ux0RQUTIysqisrISESE1NTVcU1Pz+5RbHzt27EF04NSpU+zduxcRISUlBY/HQ1VVFSLCkSNHCIVCNDY2snjxYrq6uohEIpw9ezZ8+PDhyilir9d7IBQKcfr0afbs2UMkEgHAbrfz6NGjyV6vXLnCyMjI5PnMmTOMjo4SiUTwer1TxQ0NDcXv3r0bA+ju7ubgwYMEAgEA6urqyMvLY2hoiP7+flauXElmZiZ9fX2cO3cOEWHDhg08ffq0ZYq4trbWoNfrJ4xGIy9evMBgMCAiGAwGmpubiYmJQUTIyMigoqJisueysjJ27tyJiJCZmemvrq7+ZYr8D7O5Mz4+HkVRuHfv3uRATk4Ob9++Zd++fcTFxXHnzh2CwSBlZWVs2rSJkZERJiYmsFqtfovFsm6KWETEYDBo8rdt++fSpUtBgHA4jM1mY3Bw8Iuew+FwdH+pr69nfHycUCg05vF4fv2q+HN27dp1cnBwcGB8fJzs7GwKCwsZHh6mvb0dRVEwm834fD4KCgoQETZv3ozL5TrwXXGU34zG/Jrqam+018LCQnJzcyd7djgcmEwmRISioqKOaYuj6HS6VLPZ3JeSkkJ3dzeBQIDi4mIOHToEQDAYpL6+/j+bzRY/Y7mIyPbt25U/S0tvj42NDQN0dnZisVgIh8MEg0GX2+3WzUr8OTt27Kjt7OwcSEtLQ0QoKSkZd7vdX9+M2bBmzZrsvLw8v6IolJeXW3+aOEpycvISU1bWg/nz56f/dPknYrUajUWjUpnnKkC0anWhWlGOFxUVTf8zngmLtNp1apXKISIL5yZg0aLEBLXasTAh4duf8Y+QoFbXqBWlZM4CEjWafK1GYxWR2b3a7wYkJqapVaq/tVpt0pwELFu2TJOgVv8lIskiIv8DQ4HqhmfkzxMAAAAASUVORK5CYII=";
var colours = [
'rgb(255, 0, 0)',
'rgb(0, 0, 255)',
'rgb(255, 255, 0)',
'rgb(255, 0, 255)',
'rgb(0, 255, 255)'
];
var topThreeColours = [
'rgb(255,215,0)',
'rgb(230,230,230)',
'rgb(205,133,63)',
'rgb(128,128,128)',
'rgb(128,128,128)'
];
function isCanvasSupported() {
var elem = document.createElement('canvas');
return !!(elem.getContext && elem.getContext('2d'));
}
var canvasSupported = true;
Array.prototype.back = function() {
return this[this.length-1];
};
Array.prototype.binSearch = function( v ) {
var L = this.length, i = -1, m;
while( L - i > 1 )
{
if( this[m = ((L + i)>>1)] < v )
i = m;
else
L = m;
}
return L;
}
Array.prototype.swap = function( x, y ) {
var tmp = this[x];
this[x] = this[y];
this[y] = tmp;
}
String.prototype.escapeHTML = function ()
{                                        
var r =                                                               
this.replace(/&/g,'&amp;').
replace(/>/g,'&gt;').
replace(/</g,'&lt;').
replace(/"/g,'&quot;').
replace(/'/g,'&rsquo;');
return r;
};
String.prototype.escapeID = function() {
return this.replace(/[&<>"'(){}\[\]!@#$%^* ]/g,'_');
};
function encode_utf8( s ) {
return unescape( encodeURIComponent(s) );
}
function decode_utf8( s ) {
return decodeURIComponent( escape(s) );
}
function isEmptyObject( obj ) {
for ( var name in obj ) {
return false;
}
return true;
}
var hidden, visibilityChange; 
if (typeof document.hidden !== "undefined") { 
hidden = "hidden";
visibilityChange = "visibilitychange";
} else if (typeof document.mozHidden !== "undefined") {
hidden = "mozHidden";
visibilityChange = "mozvisibilitychange";
} else if (typeof document.msHidden !== "undefined") {
hidden = "msHidden";
visibilityChange = "msvisibilitychange";
} else if (typeof document.webkitHidden !== "undefined") {
hidden = "webkitHidden";
visibilityChange = "webkitvisibilitychange";
}
var flagImages = null;
function GetFlagImage( uci ) {
if( !flagImages ) {
if( !flags )
return null;
flagImages = {};
for( var cc in flags ) {
img = new Image();
img.src = flags[cc];
img.className = 'flag';
flagImages[cc] = img;
}
}
return flagImages[uci.substring(0, 3)];
}
var translations = {
'languageCode':	['en',				'fr',					'es'],
'language':		['English',			'Français',				'Español'],
'hello':		['Hello!',			'Bonjour!',				'¡Hola!'],
'Email Comments/Suggestions': ['Email Comments/Suggestions', 'Email Commentaires/Suggestions', 'E-mail Comentarios/Sugerencias'],
'Powered by':	['Powered by',		'Propulsé par',			'Desarrollado por'],
'created':		['created',			'créé',					'creada'],
'Refresh':		['Refresh',			'Actualiser',			'Actualizar'],
'by':			['by',				'par',					'por'],
'at':			['at',				'à',					'en'],
'miles':		['miles',			'miles',				'millas'],
'Gap':			['Gap',				'Écart',				'Lapso'],
'Name':			['Name',			'Nom',					'Nombre'],
'LastName':		['Last Name',		'Dernier nom',			'Apellido'],
'FirstName':	['First Name',		'Prénom',				'Nombre'],
'Team':			['Team',			'Équipe',				'Equipo'],
'Category':		['Category',		'Catégorie',			'Categoria'],
'Nat.':			['Nat.',			'Nat.',					'Nac.'],
'State':		['State',			'État',					'Estado'],
'Prov.':		['Prov.',			'Prov.',				'Prov.'],
'City':			['City',			'Ville',				'Ciudad'],
'License':		['License',			'Licence',				'Licencia'],
'Age':			['Age',				'Âge',					'Edad'],
'Time':			['Time',			'Temps',				'Tiempo'],
'Lap':			['Lap',				'Tour',					'Vuelta'],
'lap':			['lap',				'tour',					'vuelta'],
'laps':			['laps',			'tours',				'vueltas'],
'laps of':		['laps of',			'tours de',				'vueltas de'],
'Laps of':		['laps of',			'tours de',				'vuelta de'],
'Laps to go':	['laps to go',		'tours à faire',		'vueltas antes de la meta'],
'to go':		['to go',			'à faire',				'antes de la meta'],
'of':			['of',				'de',					'de'],
'1st lap':		['1st lap',			'premier tour',			'primera vuelta'],
'more laps of':	['more laps of',	'tours de plus de',		'vueltas más de'],
'Estimated':	['Estimated',		'Estimé',				'Estimado'],
'Distance':		['distance',		'la distance',			'la distancia'],
'Start':		['start',			'au début',				'el comienzo'],
'ClockStartTime':	['Clock Start',		"Heure de début",	'Inicio reloj'],
'ClockFinishTime':	['Clock Finish',	"Heure d'arrivées",	'Acadabo reloj'],
'StartTime':	['Stopwatch Start',	"Premier chrono",		'Primero tiempo'],
'FinishTime':	['Stopwatch Stop',	"Deuxième chrono",		'Segundo tiempo'],
'ByFinishers':	['Show by Finishers',"Afficher par des arrivées","Mostrado de finalistas"],
'CycleCategories':	['Cycle Categories',"Faites défiler les catégories .","Puede cambiar entre las categorías."],
'Winner':		['winner',			'gagnant',				'ganador'],
'starters':		['starters',		'entrées',				'aperitivos'],
'finishers':	['finishers',		'arrivées',				'finalistas'],
'registered':	['registered',		"inscrit",				"registrado"],
'Show 100s of Seconds': ['Show 100s of Seconds', 'Afficer 100s de seconds', 'Mostrar 100s de segundos'],
'Hide Lap Info':['Hide Lap Info',	'Masquer les infos de tour',	'Ocultar la info de vuelta'],
'Show Every Lap':['Show Every Lap',	'Afficher tous les tours', 'Mostrar todas las vueltas'],
'Show Every {} Laps': ['Show Every {} Laps','Afficher tous les {} tours', 'Mostrar cada {} vueltas'],
'Show:':		['Show:',			'Afficher:',			'Mostrar:'],
'All':			['All',				'Tous',					'Todo'],
'Lap Times':	['Times',			'Temps',				'Tiempos'],
'Race Times':	['Race Times',		'Temps de course',		'Tiempos de carrera'],
'Race Time':	['Race',			'Temps de la course',		'Tiempo de carrera'],
'Time Gaps':	['Gaps',			"Écarts",				'Diferencia'],
'Gap Percents':	['Percent',			'Pour cent',			'Ciento'],
'Lap Speed':	['Speed',			'Vitesse',				'Velocidad'],
'Projected Time':['Projected Time',	'Temps prévu',			'Tiempo projectada'],
'Est. Distance Gap': ['Est. Distance',	"Distance est.", 		'Est. distancia'],
'Race Chart':	['Race Chart',		'Tableau de la course',		'Tabla de carrera'],
'Race Position':	['Race Position',	'Position de course',		'Posición de carrera'],
'Show Start Offsets':	['Show Start Offsets',	'Afficher commencer décalages',	'Mostrar empezar a desplazamientos'],
'Show Details':	['Show Details',	'Afficher les détails',	'Mostrar los detalles'],
'Race Lightning':	['Race Lightning',		"Éclair de course",	'Rayo de carrera'],
'Loop Continuously':['Loop Continuously',	'Boucle continue',	'Repetirá continuamente'],
'Playback Speed':['Playback Speed',	'Vitesse de lecture',		'Velocidad de reproducción'],
'Units:':		['Units:',			'Unités:',					'Unidades:'],
'Play':			['Play',			'Lecture',					'Reproducir'],
'Rewind':		['Rewind',			'Rembobinez',				'Rebobinar'],
'Stop':			['Stop',			'Stop',						'Detener'],
'Size':			['Size',			'Taille',					'Ramaño'],
'Text':			['Text',			'Texte',					'Texto'],
'Highlight Numbers': ['Highlight Numbers', 'Numéros de souligner', 'Números de relieve'],
'Track':		['Oval Track',		'Piste oval',				'Pista ovalada'],
'GPX':			['GPX Course',		'GPX',						'GPX'],
'Apply':		['Apply',			'Appliquer',				'Aplicar'],
'Chip Timing':	['Chip Timing',		'RFID Chronométrage',		'Cronometraje RFID'],
'Google Earth Ride': ['See Course on Google Earth', 'Montrez cours sur Google Earth', 'Mostrar curso en Google Earth'],
'Course Map': 	['See Course on Google Maps', "Montrez cours sur Google Maps", "Mostrar curso en Google Maps"],
'Participant Map':['Participant Map', 'Carte des participants', 'Maps de los participantes'],
'Get Directions':['Get Directions',	"Obtenir un itinéraire",	"Cómo llegar"],
'Total':		['Total',			'Gain',						'Ganancia'],
'Elevation':	['Elevation',		'total',					'total'],
'Gain':			['Gain',			"d'altitude",				'de la elevación'],
'time penalty':	['time penalty',	"pénalité de temps",		"penalización de tiempo"],
'Factor':		['Factor%',			'Facteur%',					'Factor%'],
'ElapsedTime':	['ElapsedTime',		'Chrono',					'Tiempo transcurrido'],
'TimeSlider':	['Time Slider',		'Curseur de temps',			'Deslizador de tiempo'],
'TimeSliderInstructions':	['Slide to Change Time', "Faites glisser pour changer Temps", "Deslice para cambiar Tiempo"],
'ClickGroupInstructions':	['Click Group for Details', "Cliquez sur Groupe pour plus de détails", "Haga clic en Grupo para detalles"],
'Situation':	['Situation',		'Situation',				'Situación'],
'Leaders':		['Leaders',			'Tête',						'Cabeza'],
'Chase Group':	['Chase Group',		'Chase',					'Caza'],
'LapsDown':		['Laps Down',		'Rours de retard',			'Vueltas atrás'],
'CategorySummary':	['Category Summary',"Catégorie résumé",			"Resumen de la categoría"],
'ShowCategorySummary':['Show Category Summary',"Afficher le catégorie résumé",	"Mostrar el resumen de la categoría"],
'Sponsor':		['Sponsor',			"Promoteur",				"Patrocinador"],
'Cash':			['Cash',			"Argent",					"Dinero"],
'Merchandise':	['Merchandise',		"Marchendise",				"Mercancía"],
'Lapped':		['Lapped',			"Doublés",					"Doblados"],
'race in progress':	['race in progress - results unofficial', "course en cours - résultats non officiels",	"carrera en curso - resultados extraoficiales"],
'last':			['','','']
};
(function() {
var key = 'Show Every {} Laps';
var showLaps = [2, 3, 5, 10, 15, 20, 25, 50, 100];
var showTr = translations[key];
for( var i = 0; i < showLaps.length; ++i ) {
var tr = [];
for( var j = 0; j < showTr.length; ++j )
tr.push( showTr[j].replace('{}', showLaps[i]) );
translations[key.replace('{}', showLaps[i])] = tr;
}
})();
function _( f ) {
var t = translations[f];
return t ? t[langCur] : f;
}
function ordinal( value ) {
value = parseInt( value );
if( langCur == 1 ) return value == 1 ? (value+'er') : (value+'e');
if( langCur == 2 ) return value + '.&#xb0;';
if( Math.floor((value % 100)/10) != 1 )
return value + ['th','st','nd','rd','th','th','th','th','th','th'][value%10];
return value + "th";
}
var degreesToRadians = Math.PI / 180.0;
var radiansToDegrees = 180.0 / Math.PI;
function CompassBearing( lat1, lon1, lat2, lon2 )
{
lat1 *= degreesToRadians;
lat2 *= degreesToRadians;
var diffLong = (lon2 - lon1) * degreesToRadians;
var x = Math.sin(diffLong) * Math.cos(lat2);
var y = Math.cos(lat1) * Math.sin(lat2) - (Math.sin(lat1) * Math.cos(lat2) * Math.cos(diffLong));
var bearing = Math.atan2(x, y) * radiansToDegrees;
while( bearing < 0.0 )
bearing += 360.0;
return bearing;
}
function GetLapRatio( leaderRaceTimes, tCur, iLapHint )
{
var maxLaps = leaderRaceTimes.length - 1;
if( maxLaps < 1 )
return [0, 0.0];
if( 0 <= iLapHint && iLapHint < maxLaps &&
leaderRaceTimes[iLapHint] <= tCur && tCur < leaderRaceTimes[iLapHint+1] ) {
lapRatio = (tCur - leaderRaceTimes[iLapHint]) / (leaderRaceTimes[iLapHint + 1] - leaderRaceTimes[iLapHint]);
}
else if( tCur <= leaderRaceTimes[0] ) {
iLapHint = 0;
lapRatio = 0.0;
}
else if ( tCur >= leaderRaceTimes.back() ) {
iLapHint = maxLaps - 1;
lapRatio = 1.0;
}
else {
iLapHint = Math.max( 0, Math.min(maxLaps, iLapHint) );
for( iLapHint = (leaderRaceTimes[iLapHint] < tCur ? iLapHint+1 : 0); iLapHint < maxLaps; ++iLapHint ) {
if( leaderRaceTimes[iLapHint] <= tCur )
break;
}
lapRatio = (tCur - leaderRaceTimes[iLapHint]) / (leaderRaceTimes[iLapHint + 1] - leaderRaceTimes[iLapHint]);
}
return [iLapHint, lapRatio];
}
function doReload( forceRefresh ) {
if( !forceRefresh )
return RefreshPayload();
var params = [
'raceCat=' + encodeURIComponent(encode_utf8(categoryCur)),
'highlight=' + document.getElementById('idNumsToWatch').value,
'lang=' + getLanguageCode()
];
if( cycleCategoriesMode )
params.push( 'cycleCategoriesMode=t' );
if( showCategorySummary )
params.push( 'showCategorySummary=t' );
if( arrivalMode )
params.push( 'arrivalMode=t' );
if( mapMode )
params.push( 'mapMode=t' );
if( kioskMode )
params.push( 'kioskMode=t' );
var href = window.location.href;
var qMark = href.indexOf( '?' );
if( qMark != -1 )
href = href.substring( 0, qMark );
href += '?' + params.join('&');
CloseWebSocket();
if( window.location.href != href )
window.location.href = href;
else
window.location.reload( true );
}
var reloadTriggered = false;
function TriggerReload( leaderRaceTimes, tCur, iLapHint )
{
if( !raceIsRunning || reloadTriggered )
return;
var maxLaps = leaderRaceTimes.length - 1;
if( maxLaps < 1 )
return;
if( 0 <= iLapHint && iLapHint < maxLaps &&
leaderRaceTimes[iLapHint] <= tCur && tCur < leaderRaceTimes[iLapHint+1] ) {
if( leaderRaceTimes[iLapHint+1] - tCur < 1.0 ) {
reloadTriggered = true;
setTimeout( RefreshPayload, Math.round(7000 + Math.random() * 5000) );
}
}
}
function OpenRiderDashboardViewerWindow( bib )
{
var dataToGo = {};
var catDetailsToGo = [];
for( var i = 0; i < catDetails.length; ++i ) {
var c = catDetails[i];
for( var p = 0; p < c.pos.length; ++p ) {
if( c.pos[p] == bib ) {
catDetailsToGo.push( c );
for( var p = 0; p < c.pos.length; ++p )
dataToGo[c.pos[p]] = data[c.pos[p]];
break;
}
}
}	
var payload = {'bib': bib, 'raceName': raceNameText + ': ' + raceDate, 'data':dataToGo, 'catDetails':catDetailsToGo};
var d = data[bib];
var name = (d.FirstName && d.LastName ? d.FirstName + ' ' + d.LastName : d.FirstName ? d.FirstName : d.LastName);
var newTitle = bib + ': ' + name + ' Dashboard';
var template = riderDashboard.replace(/{-{/g, '<').replace(/}-}/g, '>').replace(
'payload = null;', 'payload=' + JSON.stringify(payload) + ';' ).replace(
'TTIITTLLEE', newTitle.escapeHTML() );
var w = window.open( '', '', '', true );
w.document.write( template );
w.document.close();
}
function GetLocationCount() {
if( !travelMap )
return [];
var locCnt = {};
for( bib in data ) {
var d = data[bib];
var city = d['City'];
if( !city ) continue;
var region = (d['Prov'] || d['State'] || d['StateProv']);
if( !region ) continue;
var location = city + ', ' + region;
if( location in locCnt )
locCnt[location] += 1;
else
locCnt[location] = 1;
}
var locationCount = [];
for( location in locCnt )
locationCount.push( [location, locCnt[location]] );
return locationCount;
}
function OpenTravelMapWindow() {
var locationCount = GetLocationCount();
if( locationCount.length == 0 )
return;
var payload = {
'raceName': raceNameText + ': ' + raceDate,
'locationCount':locationCount
};
if( courseCoordinates )
payload.raceCoords = [courseCoordinates[1],courseCoordinates[0]];
if( raceAddress )
payload.raceAddress = raceAddress;
var template = travelMap.replace(/{-{/g, '<').replace(/}-}/g, '>').replace(
'payload = null;', 'payload=' + JSON.stringify(payload) + ';' );
var w = window.open( '', '', '', true );
w.document.write( template );
w.document.close();
}
function OpenCourseViewerWindow()
{
if( !courseCoordinates || !courseViewerTemplate )
return;
var payload = {};
var fields = ['courseCoordinates', 'raceNameText', 'raceDate', 'email', 'displayUnits', 'organizer',
'gpsAltigraph', 'gpsIsPointToPoint', 'gpsTotalElevationGain', 'lengthKm' ];
for( var f = 0; f < fields.length; ++f ) {
var key = fields[f];
var value = window[key];
if( value )
payload[key] = value;
}
var newTitle = 'Map: ' + payload['raceNameText'] + ' ' + payload['raceDate'];
var template = courseViewerTemplate.replace(/{-{/g, '<').replace(/}-}/g, '>').replace(
'payload = null;', 'payload=' + JSON.stringify(payload) + ';' ).replace(
'TTIITTLLEE', newTitle.escapeHTML() );
var w = window.open( '', '', '', true );
w.document.write( template );
w.document.close();
}
function LineNormal( x1, y1, x2, y2, normLen )
{
var dx = x2 - x1, dy = y2 - y1;
var scale = (normLen / 2.0) / Math.sqrt( dx*dx + dy*dy );
dx *= scale;
dy *= scale;
return [x1 + dy, y1 - dx, x1 - dy, y1 + dx];
}
function getRiderPositionTime( num )
{
var info = data[num];
if( !info )
return [null, null];
var raceTimes = info['raceTimes'];
if( !raceTimes || raceTimes.length == 0 )
return [null, null];
var p;
if( t <= raceTimes[0] )
{
var firstLapRatio = info['flr'];
p = 1.0 - firstLapRatio;
p -= Math.floor(p) - 1.0;
return [p, t];
}
var tSearch = t;
var finishTime = info['finishTime'];
if( finishTime != null && finishTime < t )
tSearch = finishTime;
if( tSearch >= raceTimes.back() )
{
var lastRaceTime = raceTimes.back();
p = raceTimes.length + (tSearch - lastRaceTime) / (lastRaceTime - raceTimes[raceTimes.length-2]);
}
else
{
var i = info['iLast'];
if( !(raceTimes[i-1] < tSearch && tSearch <= raceTimes[i]) )
{
++i;
if( !(raceTimes[i-1] < tSearch && tSearch <= raceTimes[i]) )
{
i = raceTimes.binSearch( tSearch );
if( raceTimes[i] < tSearch )
++i;
}
info['iLast'] = i;
}
if( i == 1 )
{
var firstLapRatio = info['flr'];
p = (tSearch - raceTimes[i-1]) / (raceTimes[i] - raceTimes[i-1]);
p = 1.0 - firstLapRatio + p * firstLapRatio;
p -= Math.floor(p) - 1.0;
}
else
p = i + (tSearch - raceTimes[i-1]) / (raceTimes[i] - raceTimes[i-1]);
}
return [p, tSearch];
}
function DrawCircle( ctx, x, y, radius )
{
ctx.beginPath();
ctx.arc(x, y, radius, 0.0, Math.PI*2, true);
ctx.closePath();
ctx.fill();
ctx.stroke();
}
function DrawLine( ctx, x1, y1, x2, y2 )
{
ctx.beginPath();
ctx.moveTo( x1, y1 );
ctx.lineTo( x2, y2 );
ctx.stroke();
}
function TimeDifference( a, b )
{
if( showTimeDecimals )
{
a *= 100.0;
b *= 100.0;
}
var t = ~~a - ~~b;
if( showTimeDecimals )
t /= 100.0;
return t;
}
function FormatTime( t ) {
var tStr = '';
if( t < 0 )
{
tStr = '-';
t = -t;
}
var secs = ~~t;
var h = ~~(secs / (60*60));
var m = (~~(secs / 60) % 60);
var s = ~~(secs % 60);
if( h > 0 )
tStr += h + (m < 10 ? ':0' : ':') + m + (s < 10 ? ':0' : ':') + s;
else
tStr += m + (s < 10 ? ':0' : ':') + s;
if( showTimeDecimals )
{
var decimals = ~~((t - ~~t) * 100);
tStr += (decimals < 10 ? '.0' : '.') + decimals;
}
return tStr;
}
function FormatTimeGap( t )
{
var tStr = '';
if( t < 0 )
{
tStr = '-';
t = -t;
}
var secs = ~~t;
var h = ~~(secs / (60*60));
var m = (~~(secs / 60) % 60);
var s = ~~(secs % 60);
if( h > 0 )
tStr += h + (m < 10 ? 'h0' : 'h') + m + (s < 10 ? "'0" : "'") + s;
else
tStr += m + (s < 10 ? "'0" : "'") + s;
if( showTimeDecimals )
{
var decimals = ~~((t - ~~t) * 100);
tStr += (decimals < 10 ? '.0' : '.') + decimals;
}
tStr += '"';
return tStr;
}
function getShortName( num )
{
var d = data[num + ''];
var name = '';
if( d['LastName'] )
{
name = d['LastName'];
if( d['FirstName'] )
name += ', ' + d['FirstName'].substring(0, 1) + '.'
}
else if( d['FirstName'] )
name = d['FirstName'];
return name;
}
function FixedFormat( x, Length, Decimals ) {
var s = x.toFixed( Decimals );
if( s.length < Length )
s = Array(Length - s.length + 1).join('0') + s;
return s;
}
function TrackAnimation()
{
this.iLapDistance = 0;
this.getXYfromPosition = function( lane, position )
{
position -= ~~(position);
var curveLength = (r/2.0) * Math.PI;
var trackLength = 4*r + 2 * curveLength;
var laneWidth = (r/2.0) / laneMax;
var laneLength = lane * laneWidth;
var riderLength = trackLength * position;
if( riderLength <= r/2 )
return [2*r + r/2.0 + riderLength, r + r/2.0 + laneLength];
riderLength -= r/2;
if( riderLength <= curveLength )
{
a = Math.PI * riderLength / curveLength;
rd = r/2 + laneLength;
return [3*r + rd*Math.sin(a), r + rd*Math.cos(a)];
}
riderLength -= curveLength;
if( riderLength <= 2*r )
return [3*r - riderLength, r/2 - laneLength];
riderLength -= 2*r;
if( riderLength <= curveLength )
{
a = Math.PI * (1.0 + riderLength / curveLength);
rd = r/2 + laneLength;
return [r + rd*Math.sin(a), r + rd*Math.cos(a)];
}	
riderLength -= curveLength;
return [r + riderLength, r + r/2 + laneLength];
}
this.getRiderXYPT = function( num, lane )
{
var positionTime = getRiderPositionTime( num );
if ( positionTime[0] == null )
return [null, null, null, null];
if( data[num]['finishTime'] != null && t >= data[num]['finishTime'] )
{
lapCur = Math.max( lapCur, data[num]['raceTimes'].length );
return [null, null, positionTime[0], positionTime[1]];
}
lapCur = Math.max(lapCur, ~~positionTime[0]);
var xypt = this.getXYfromPosition( lane, positionTime[0] );
if( reverseDirection )
xypt[0] = r * 4 - xypt[0];
if( finishTop )
xypt[1] = r * 2 - xypt[1];
xypt.push( positionTime[0] );
xypt.push( positionTime[1] );
return xypt;
}
this.resetCache = function() { this.cache = {}; }
this.Refresh = function()
{
if( !canvas || !canvasSupported || document[hidden] )
return;
var dc = canvas.getContext('2d');
dc.textBaseline = "top";
var width = canvas.width;
var height = canvas.height;
var backColour = 'white';
dc.fillStyle = backColour;
dc.fillRect(0, 0, width, height );
if( width < 80 || height < 80 )
return;
r = ~~(width / 4);
if( r * 2 > height )
r = ~~(height / 2);
r -= (r & 1);			
var tHeight = r / 8;
var fontHeight = ~~(tHeight * fontMult);
var fontStr = fontHeight + "px Arial";
var fontStrHightlight = ~~(tHeight * 1.6 * fontMult) + "px Arial";
dc.font = fontStr;
//trackColour = 'rgb(0,255,0)';
trackColour = '#7FE57F';
dc.fillStyle = trackColour;
dc.strokeStyle = trackColour;
DrawCircle( dc, r, r, r );
DrawCircle( dc, 3*r, r, r );
dc.fillRect( r, 0, 2*r, 2*r + 2 );
laneWidth = (r/2) / laneMax;
dc.fillStyle = backColour;
dc.strokeStyle = backColour;
DrawCircle( dc, r, r, r/2 - laneWidth );
DrawCircle( dc, 3*r, r, r/2 - laneWidth );
var pp = [r, r/2 + laneWidth, 2*r, r - 2*laneWidth + 1];
dc.fillRect( pp[0], pp[1], pp[2], pp[3] );
dc.strokeRect( pp[0], pp[1], pp[2], pp[3] );
for( var i = 0; i <= 3; ++i )
{
var p = 0.25 * i;
var p1 = this.getXYfromPosition(-1, p);
var p2 = this.getXYfromPosition(laneMax+0.25, p);
if( reverseDirection )
{
p1[0] = 4*r - p1[0];
p2[0] = 4*r - p2[0];
}
if( finishTop )
{
p1[1] = 2*r - p1[1];
p2[1] = 2*r - p2[1];
}
if( i == 0 )
{
var sfWidth = 8;
dc.strokeStyle = '#FFFFFF';
dc.fillRect( p1[0] - sfWidth / 2, Math.min(p1[1], p2[1]), sfWidth, r );
dc.strokeStyle = 'black';
dc.lineWidth = 2;
}
else
{
dc.lineWidth = 1;
dc.strokeStyle = 'rgb(64,64,64)';
}
DrawLine( dc, p1[0], p1[1], p2[0], p2[1] );
}
dc.strokeStyle = 'black';
dc.fillStyle = 'black';
dc.lineWidth = 1;
numSize = (r/2)/laneMax;
lapCur = 0;
var riderRadius = laneWidth * 0.75;
var thickLine = r / 24;
var hasFirstLapRatio = false;
firstLapRatio = 1.0;
if( data )
{
var riderXYPT = [];
var cd = catDetailsByName[categoryCur];
for( var p = 0; p < cd.pos.length; ++p )
{
var num = cd.pos[p];
if( !hasFirstLapRatio )
{
hasFirstLapRatio = true;
if( cd['firstLapDistance'] && cd['lapDistance'] )
firstLapRatio = cd['firstLapDistance'] / cd['lapDistance'];
}
var xypt = this.getRiderXYPT( num, num % laneMax );
if( xypt[2] == null )
continue;
xypt.splice( 0, 0, num );
riderXYPT.push( xypt );
}
riderXYPT.sort(function(x, y)
{
var r = (y[3] ? y[3] : 0) - (x[3] ? x[3] : 0);	
if( r == 0 )
r = (x[4] ? x[4] : 0) - (y[4] ? y[4] : 0);	
if( r == 0 )
r = (x[0] - y[0]);							
return -r;
});
var leaders = [];
for( var i = riderXYPT.length - 1; i >= 0 && leaders.length < 3; --i )
leaders.push( riderXYPT[i][0] );
var topThree = {};
for( var i = 0; i < leaders.length; ++i )
topThree[leaders[i]] = i;
var riderPosition = {};
for( var i = 0; i < riderXYPT.length; ++i )
{
var rxypt = riderXYPT[i];
riderPosition[rxypt[0]] = riderXYPT.length - i;
var x = rxypt[1];
if( x == null )
continue;
num = rxypt[0];
var y = rxypt[2];
dc.fillStyle = colours[num % colours.length];
var j = topThree[num];
if( j != undefined )
{
dc.strokeStyle = topThreeColours[j];
dc.lineWidth = thickLine;
if( numsToWatch[num] != undefined )
dc.font = fontStrHightlight;
}
else
{
j = numsToWatch[num];
if( j != undefined )
{
dc.strokeStyle = 'white';
dc.lineWidth = thickLine * 1.5;
dc.font = fontStrHightlight;
}
}
if( isNaN(x) || isNaN(y) )
continue;
//DrawCircle( dc, x, y, riderRadius );
dc.beginPath(); dc.arc(x, y, riderRadius, 0.0, Math.PI*2, true); dc.closePath(); dc.fill(); dc.stroke();
dc.fillStyle = 'black';
dc.fillText(num+'', x+numSize, y-numSize );
if( j != undefined )
{
dc.strokeStyle = 'black';
dc.lineWidth = 1;
dc.font = fontStr;
}
}
}
dc.fillStyle = 'black';
if( lapCur > 0 )
{
var table = [[],[]];
if( leaders.length > 0 ) {
var leaderRaceTimes = data[leaders[0]]['raceTimes'];
var maxLaps = leaderRaceTimes.length - 1;
var glr = GetLapRatio( leaderRaceTimes, t, this.iLapDistance );
this.iLapDistance = glr[0];
TriggerReload( leaderRaceTimes, t, this.iLapDistance );
var lapRatio = glr[1];
lapRatio = Math.floor(lapRatio * 10.0) / 10.0		
table[0].push( FixedFormat(this.iLapDistance + lapRatio, 5, 1) + ' ' + _('Laps of') + ' ' + maxLaps );
table[1].push( FixedFormat(maxLaps - this.iLapDistance - lapRatio, 5, 1) + ' ' + _('Laps to go') );
var leaderCategory = data[leaders[0]]['raceCat'];
var cat = (leaderCategory && catDetailsByName ? catDetailsByName[leaderCategory] : null);
if( cat ) {
var distanceCur = null, distanceRace = null;
if( cat['lapDistance'] ) {
var flr = data[leaders[0]]['flr']; if( !flr ) flr = 1.0;
var distanceLap = cat['lapDistance'];
if( cat['distanceUnit'] != displayUnits )
distanceLap *= (displayUnits == 'km' ? 1.60934 : 0.621371);
distanceRace = distanceLap * (flr + maxLaps - 1);
if( this.iLapDistance == 0 )
distanceCur = lapRatio * (distanceLap * flr);
else
distanceCur = distanceLap * (flr + this.iLapDistance - 1 + lapRatio);
}
else if( cat['raceDistance'] && leaderRaceTimes[0] != leaderRaceTimes.back() ) {
distanceRace = cat['raceDistance'];
if( cat['distanceUnit'] != displayUnits )
distanceRace *= (displayUnits == 'km' ? 1.60934 : 0.621371);
var distanceCur = (t - leaderRaceTimes[0]) / (leaderRaceTimes.back() - leaderRaceTimes[0]) * distanceRace;
distanceCur = Math.max( 0.0, Math.min(distanceCur, distanceRace) );
}
if( distanceCur != null ) {
if( distanceCur != distanceRace )
distanceCur = Math.floor( distanceCur * 10.0 ) / 10.0;
table[0].push( FixedFormat(distanceCur, 5, 1) + ' ' + _(displayUnits) + ' ' + _('of') + ' ' + distanceRace.toFixed(1) );
table[1].push( FixedFormat(distanceRace - distanceCur, 5, 1) + ' ' + _(displayUnits) + ' ' + _('to go') );
}
}
}
var xRight  = 3*r + r/7;
for( var col = table[0].length - 1; col >= 0; --col ) {
var tWidth = 0;
for( var row = 0; row < table.length; ++row ) {
tWidth = Math.max( tWidth, dc.measureText(table[row][col]).width );
}
xRight -= tWidth;
var yCur = r + r/2 - laneWidth - fontHeight * 1.2 - fontHeight;
for( var row = 0; row < table.length; ++row ) {
var value = table[row][col];
var tShow = value.replace(/^0+/, '');
if( tShow.substring(0, 1) == '.' )
tShow = '0' + tShow;
dc.fillText( tShow, xRight + dc.measureText(Array(value.length - tShow.length + 1).join('0')).width, yCur );
yCur += fontHeight;
}
xRight -= fontHeight / 2.5;
}
}
var leaderWidthMax = 0;
var xLeft = ~~(r * 0.8);
if( leaders )
{
var x = xLeft;
var y = r / 2 + laneWidth * 1.5;
dc.fillText( 'Leaders:', x, y );
y += tHeight * 1.2;
thickLine = tHeight / 5;
riderRadius = tHeight / 3.5;
for( var i = 0; i < leaders.length; ++i )
{
var num = leaders[i];
dc.lineWidth = 1;
dc.strokeStyle = backColour;
dc.fillStyle = trackColour;
dc.fillRect( x - thickLine/4, y - thickLine/4, tHeight + thickLine/2, tHeight  + thickLine/2 );
dc.strokeStyle = topThreeColours[i];
dc.lineWidth = thickLine;
dc.fillStyle = colours[num % colours.length];
DrawCircle( dc, x + tHeight / 2, y + tHeight / 2, riderRadius );
dc.fillStyle = 'black';
var leadStr = num + ' ' + getShortName(num);
var tWidth = dc.measureText(leadStr).width;
if( tWidth > leaderWidthMax )
leaderWidthMax = tWidth;
dc.fillText( leadStr, x + tHeight * 1.2, y );
y += tHeight * 1.2;
}
}
if( numsToWatch )
{
var colCount = 0;
var x = xLeft + tHeight * 1.2 + leaderWidthMax + dc.measureText(' ').width;
var yTop = r / 2 + laneWidth * 1.5 + tHeight * 1.2;
var y = yTop;
var rp = [];
for( n in numsToWatch )
{
var p = riderPosition[n];
if( p != undefined )
rp.push( [p, n] );
}
rp.sort(function(x, y) { return x[0] - y[0]; });
dc.fillStyle = 'black';
for( var i = 0; i < rp.length && i < 3; ++i )
{
var num = rp[i][1];
dc.fillText( '(' + rp[i][0] + ') ' + num + ' ' + getShortName(num), x, y );
y += tHeight * 1.2;
if( y >= r * 1.5 - tHeight * 1.5 )
{
if( ++colCount == 2 )
break;
y = yTop;
x += tWidth * 1.2;
}
}
}
dc.fillStyle = 'black';
var tStr = FormatTime( t );
var tWidth = dc.measureText(tStr).width;
dc.fillText( tStr, 4*r - tWidth, 2*r - tHeight );
}
}
function GeoTrack()
{
this.setData = function( gpsData )
{
this.gpsPoints = gpsData;
this.xMax = 0.0;
this.yMax = 0.0;
var dCum = 0.0;
this.cumDistance = [];
var gpsPointsLength = this.gpsPoints.length;
for( var i = 0; i < gpsPointsLength; ++i )
{
var g = gpsData[i];
this.xMax = Math.max( this.xMax, g[0] );
this.yMax = Math.max( this.yMax, g[1] );
this.cumDistance.push( dCum );
dCum += g[2];
}
this.distanceTotal = dCum;
this.x = 0;
this.yBottom = 0;
this.mult = 1.0;
this.cache = {};
}
this.resetCache = function() { this.cache = {}; }
this.getXYTrack = function()
{
var x = this.x;
var yBottom = this.yBottom;
var mult = this.mult;
var track = [];
var gpsPointsLength = this.gpsPoints.length;
for( var i = 0; i < gpsPointsLength; ++i )
{
var p = this.gpsPoints[i];
track.push( [p[0] * mult + x, yBottom - p[1] * mult] );
}
return track;
}
this.getXY = function( lap, id )
{
if( id == undefined )
id = -1;
var lap = lap - (~~lap);								
var lapDistance = lap * this.distanceTotal;				
var lenGpsPoints = this.gpsPoints.length;
var i = -1;
if( id in this.cache )
{
i = this.cache[id] % lenGpsPoints;
if( !(this.cumDistance[i] <= lapDistance && lapDistance <= this.cumDistance[i] + this.gpsPoints[i][2]) )
{
i = (i + 1) % lenGpsPoints;
if( !(this.cumDistance[i] <= lapDistance && lapDistance <= this.cumDistance[i] + this.gpsPoints[i][2]) )
i = -1;
}
}
if( i == -1 )
{
i = this.cumDistance.binSearch(lapDistance);
if( this.cumDistance[i] > lapDistance )
i += lenGpsPoints - 1;
i %= lenGpsPoints;
}
if( gpsIsPointToPoint )
i = Math.min( i, lenGpsPoints - 2 )
this.cache[id] = i;
var pCur = this.gpsPoints[i], pNext = this.gpsPoints[(i+1)%lenGpsPoints];
var segDistance = lapDistance - this.cumDistance[i];
var segRatio = segDistance / pCur[2];
var x = pCur[0] + (pNext[0] - pCur[0]) * segRatio;
var y = pCur[1] + (pNext[1] - pCur[1]) * segRatio;
return [x * this.mult + this.x, this.yBottom - y * this.mult];
}
this.setDisplayRect = function( x, y, width, height )
{
if( width <= 0 || height <= 0 )
{
this.mult = 1.0;
this.x = x;
this.yBottom = y + height;
return;
}
var mult = Math.min( width / this.xMax, height / this.yMax );
var w = this.xMax * mult, h = this.yMax * mult;
var xBorder = (width - w) / 4.0;
var yBorder = (height - h) / 2.0;
this.mult = mult;
this.x = xBorder + x;
this.yBottom = y + height;
}
}
function colorBetween( r1, g1, b1, r2, g2, b2, x )
{
var r = (r1 + (r2 - r1) * x).toFixed(0);
var g = (g1 + (g2 - g1) * x).toFixed(0);
var b = (b1 + (b2 - b1) * x).toFixed(0);
return 'rgb(' + r + ',' + g + ',' + b + ')';
}
function Altigraph()
{
this.altigraph = [];
this.yMax = -1000000.0;
this.yMin = 1000000.0
this.xMax = 0.0;
this.setData = function( altigraph )
{
if( !altigraph || altigraph.length == 0 )
altigraph = [];
this.altigraph = altigraph;
this.yMax = -1000000.0;
this.yMin = 1000000.0
this.xMax = 0.0;
for( var i = 0; i < altigraph.length; ++i )
{
if( altigraph[i][1] > this.yMax )
this.yMax = altigraph[i][1];
if( altigraph[i][1] < this.yMin )
this.yMin = altigraph[i][1];
}
if( altigraph.length > 0 )
this.xMax = altigraph[altigraph.length-1][0];
if( this.yMin == this.yMax )
{
this.altigraph = []
gpsAltigraph = null;
gpsTotalElevationGain = null;
}
}
this.empty = function() { return this.altigraph.length == 0; }
this.draw = function( dc, x, y, width, height )
{
if( this.altigraph.length == 0 || this.xMax == 0 || !gpsTotalElevationGain )
return;
dc.save();
y += 2;		
height -= 2;
var fontSize = (height*0.95)/4.0;
dc.font = fontSize + 'px Arial';
var minLabel = '0';
var maxLabel = ((this.yMax - this.yMin) * (displayUnits == 'km' ? 1.0 : 3.28084)).toFixed(0) + (displayUnits == 'km' ? ' m' : ' ft');
var labelWidth = Math.max( dc.measureText(minLabel).width, dc.measureText(maxLabel).width );
var altigraph = this.altigraph;
var teg = 0.0;
for( var i = 1; i < this.altigraph.length; ++i )
teg += Math.max(0.0, altigraph[i][1] - altigraph[i-1][1]);
var tegLabel = '';
var tegWidth = 0;
var tegText = [('Total'), ('Elevation'), ('Gain')];
if( gpsTotalElevationGain )
{
tegLabel = (gpsTotalElevationGain * (displayUnits == 'km' ? 1.0 : 3.28084)).toFixed(0) + (displayUnits == 'km' ? ' m' : ' ft');
tegWidth = dc.measureText(tegLabel).width;
for( var i = 0; i < tegText.length; ++i )
tegWidth = Math.max( tegWidth, dc.measureText(tegText[i]).width );
}
var border = 4;
if( labelWidth + border*2 + tegWidth > width )
{
dc.restore();
return;
}
var xMult = (width - labelWidth - border*2 - tegWidth) / this.xMax;
var yMult = height / (this.yMax - this.yMin);
var points = [];
for( var i = 0; i < this.altigraph.length; ++i )
points.push( [(x + labelWidth + border + altigraph[i][0] * xMult), (y + height - (altigraph[i][1] - this.yMin) * yMult)] );
for( var i = 1; i < this.altigraph.length; ++i )
{
var grade = (altigraph[i][1] - altigraph[i-1][1]) / (altigraph[i][0] - altigraph[i-1][0]);
if( grade > 0 )
dc.fillStyle = colorBetween( 255,255,255, 255,0,0, Math.min(1.0,  grade / 0.12) );
else
dc.fillStyle = colorBetween( 255,255,255,   0,0,0, Math.min(1.0, -grade / 0.12) );
dc.beginPath();
dc.moveTo( points[i-1][0], points[i-1][1] );
dc.lineTo( points[i  ][0], points[i  ][1] );
dc.lineTo( points[i  ][0], y + height );
dc.lineTo( points[i-1][0], y + height );
dc.closePath();
dc.fill();
}
dc.strokeStyle = '#000000';
dc.lineWidth = 2;
dc.beginPath();
dc.moveTo( points[0][0], points[0][1] );
for( var i = 1; i < this.altigraph.length; ++i )
dc.lineTo( points[i][0], points[i][1] );
dc.stroke();
dc.lineWidth = 1;
dc.beginPath();
dc.moveTo( x + labelWidth + border, y + height );
dc.lineTo( x + width - border - tegWidth, y + height );
dc.stroke();
dc.lineWidth = 1;
dc.beginPath();
dc.moveTo( x + labelWidth + border, y );
dc.lineTo( x + labelWidth + border, y + height );
dc.stroke();
dc.beginPath();
dc.moveTo( x + width - tegWidth - border, y );
dc.lineTo( x + width - tegWidth - border, y + height );
dc.stroke();
dc.fillStyle = '#000000';
dc.textAlign = 'right';
dc.textBaseline = 'top';
dc.fillText( maxLabel, x + labelWidth, y );
dc.textBaseline = 'bottom';
dc.fillText( minLabel, x + labelWidth, y + height );
if( gpsTotalElevationGain )
{
dc.textBaseline = 'top';
dc.textAlign = 'left';
var xCur = x + width - tegWidth;
var yCur = y + (height - fontSize * 1.05 * 4) / 2;
for( var i = 0; i < tegText.length; ++i )
{
dc.fillText( tegText[i], xCur, yCur );
yCur += fontSize * 1.05;
}
dc.fillText( tegLabel, xCur, yCur );
}
dc.restore();
}
}
var infoLines = 1;
function GeoAnimation()
{
this.xBanner = 300;
this.geoTrack = new GeoTrack();
this.altigraph = new Altigraph();
this.compassLocation = 'SE';
this.widthLast = -1;
this.heightLast = -1;
this.iLapDistance = 0;
this.tBannerLast = -1;
this.drawCompass = function( dc, width, height, tHeight )
{
dc.save();
var size = width / 20;
var x = this.compassLocation[1] == 'E' ? width - size * 1.4 : size * 1.4;
var y = this.compassLocation[0] == 'N' ? size * 1.4 + tHeight * 3 : height - size * 1.4;
if( this.compassLocation[0] == 'S' && gpsTotalElevationGain )
y -= height / 20;
var factor = 7.0;
var pseg1 = [[0,0], [size/factor,size/factor], [0,size]];		
var pseg2 = [[0,0], [-size/factor,size/factor], [0,size]];
var labels = ['S', 'E', 'N', 'W'];
dc.fillStyle = '#000000';
dc.strokeStyle = '#000000';
dc.lineWidth = 1;
var fontSize = size/4;
dc.font = fontSize + 'px serif';
dc.textAlign = 'center';
for( var i = 0; i < 4; ++i )
{
dc.fillText( labels[i], x + pseg1[2][0]*1.2, y + pseg1[2][1]*1.2 - fontSize/2 );
dc.beginPath();
dc.moveTo( x, y );
for( var p = 0; p < pseg1.length; ++p )
{
dc.lineTo( x + pseg1[p][0], y + pseg1[p][1] );
pseg1[p] = [pseg1[p][1], -pseg1[p][0]];	
}
dc.stroke()
dc.beginPath();
dc.moveTo( x, y );
for( var p = 0; p < pseg2.length; ++p )
{
dc.lineTo( x + pseg2[p][0], y + pseg2[p][1] );
pseg2[p] = [pseg2[p][1], -pseg2[p][0]];	
}
dc.fill()
}
dc.restore();
}
this.drawBanner = function( dc, width, height, tHeight, bannerItems )
{
drawSegment( dc, 0, 0, width, tHeight*1.2, '#0000CC', '#0000EE' );
if( bannerItems.length == 0 )
return
var y = tHeight * 0.1;
tHeight *= 0.85;
var x = this.xBanner;
var tWidth;
var positionFont = (tHeight*.7) + "px Arial";
var numberFont = 'italic bold ' + tHeight + "px Arial";
var nameFont = 'bold ' + tHeight + "px Arial";
while( x < width )
{
for( var i = 0; i < bannerItems.length && x < width; ++i )
{
var position = bannerItems[i][1];
var num = bannerItems[i][0];
var name = getShortName( num );
if( position == 1 )
{
x += tHeight / 2;
tWidth = checkeredFlag.width;
if( x + tWidth > 0 && x < width )
dc.drawImage( checkeredFlag, x, y );
x += tWidth + tHeight / 2;
}
dc.font = positionFont;
tWidth = dc.measureText(position).width;
if( x + tWidth > 0 && x < width )
{
dc.fillStyle = '#FFFFFF';
dc.fillText(position, x, y );
}
x += tWidth + tHeight / 4;
dc.font = numberFont;
tWidth = dc.measureText(num).width;
if( x + tWidth > 0 && x < width)
{
dc.fillStyle = '#FFFF00';
dc.fillText(num, x, y );
}
x += tWidth + tHeight / 3;
dc.font = nameFont;
tWidth = dc.measureText(name).width;
if( x + tWidth > 0 && x < width )
{
dc.fillStyle = '#FFFFFF';
dc.fillText(name, x, y );
}
x += tWidth + tHeight;
}
if( x < 0 )
this.xBanner = x;
}
var tBanner = (new Date().getTime()) / 1000.0;
if( this.tBannerLast < 0 )
this.tBannerLast = tBanner;
this.xBanner -= 64.0 * (tBanner - this.tBannerLast);
this.tBannerLast = tBanner;
}
this.resetCache = function() { this.geoTrack.resetCache(); }
this.getRiderXYPT = function( num )
{
var positionTime = getRiderPositionTime( num );
if( positionTime[0] == null )
return [null, null, null, null];
if( data[num]['finishTime'] != null && t >= data[num]['finishTime'] )
{
lapCur = Math.max( lapCur, data[num]['raceTimes'].length );
return [null, null, positionTime[0], positionTime[1]];
}
lapCur = Math.max(lapCur, ~~positionTime[0]);
var xy = this.geoTrack.getXY( positionTime[0], num );
return [xy[0], xy[1], positionTime[0], positionTime[1]];
}
this.Refresh = function()
{
if( !canvas || !canvasSupported || document[hidden] )
return;
var dc = canvas.getContext('2d');
dc.textBaseline = "top";
var width = canvas.width;
var height = canvas.height;
var sizeChanged = false;
if( width != this.widthLast || height != this.heightLast )
{
this.widthLast = width;
this.heightLast = height;
sizeChanged = true;
}
var backColour = 'white';
dc.fillStyle = backColour;
if( width < 80 || height < 80 )
{
dc.fillRect(0, 0, width, height );
return;
}
if( gpsTotalElevationGain && !this.altigraph.empty() )
{
var altigraphHeight = height / 8;
if( sizeChanged )
{
dc.fillRect(0, 0, width, height );
this.altigraph.draw( dc, 0, height - altigraphHeight, width, altigraphHeight );
}
height -= altigraphHeight;
}
dc.fillRect(0, 0, width, height );
r = ~~(width / 4);
if( r * 2 > height )
r = ~~(height / 2);
r -= (r & 1);			
var border = 8;
var tHeight = ~~((r / 8) * fontMult);
laneWidth = (r/2) / laneMax;
var fontStr = (tHeight*.8) + "px Arial";
var textVSpace = tHeight*0.2;
var fontStrHightlight = ~~(tHeight * 1.1) + "px Arial";
dc.font = fontStr;
compassSize = (width / 20) * 1.4 * 2;
var trackWidth = width - border * 2 - laneWidth*2 - compassSize;
var topMargin = 2*border + tHeight * infoLines + textVSpace;
var trackHeight = height - topMargin;
this.geoTrack.setDisplayRect( border, topMargin, trackWidth, trackHeight - laneWidth );
dc.beginPath();
var points = this.geoTrack.getXYTrack();
dc.moveTo( points[0][0], points[0][1] );
var pointsLength = points.length;
for( var i = 1; i < pointsLength; ++i )
dc.lineTo( points[i][0], points[i][1] );
if( !gpsIsPointToPoint )
dc.closePath();
dc.lineJoin = "round";
dc.strokeStyle = "#808080";
dc.lineWidth = laneWidth * 1.25 + 2;
dc.stroke();
var trackColour = '#7FE57F';
dc.strokeStyle = trackColour;
dc.lineWidth = laneWidth * 1.25;
dc.stroke();
dc.strokeStyle = '#505050';
dc.lineWidth = 1;
dc.stroke();
this.drawCompass( dc, width, height, tHeight )
var finishLineLen = laneWidth * 2;
var fLine;
if( gpsIsPointToPoint )
fLine = LineNormal( points[points.length-1][0], points[points.length-1][1], points[points.length-2][0], points[points.length-2][1], finishLineLen );
else
fLine = LineNormal( points[0][0], points[0][1], points[1][0], points[1][1], finishLineLen );
dc.beginPath()
dc.moveTo( fLine[0], fLine[1] );
dc.lineTo( fLine[2], fLine[3] );
dc.strokeStyle = "#FFFFFF";
dc.lineWidth = laneWidth / 1.5;
dc.stroke();
dc.strokeStyle = "#000000";
dc.lineWidth = laneWidth / 5;
dc.stroke();
if( gpsIsPointToPoint )
fLine = LineNormal( points[points.length-1][0], points[points.length-1][1], points[points.length-2][0], points[points.length-2][1], laneWidth * 4 );
else
fLine = LineNormal( points[0][0], points[0][1], points[1][0], points[1][1], laneWidth * 4 );
dc.drawImage( checkeredFlag, fLine[2] - checkeredFlag.width/2, fLine[3] - checkeredFlag.height/2 );
dc.strokeStyle = 'black';
dc.fillStyle = 'black';
dc.lineWidth = 1;
numSize = (r/2)/laneMax;
lapCur = 0;
var riderRadius = laneWidth * 0.5;
var thickLine = r / 32;
var hasFirstLapRatio = false;
firstLapRatio = 1.0;
if( data )
{
var riderXYPT = [];
var cd = catDetailsByName[categoryCur];
for( var p = 0; p < cd.pos.length; ++p )
{
var num = cd.pos[p];
if( !hasFirstLapRatio )
{
hasFirstLapRatio = true;
if( cd['firstLapDistance'] && cd['lapDistance'] )
firstLapRatio = cd['firstLapDistance'] / cd['lapDistance'];
}
var xypt = this.getRiderXYPT( num );
if( xypt[2] == null )
continue;
xypt.splice( 0, 0, num );
riderXYPT.push( xypt );
}
riderXYPT.sort(function(x, y)
{
var r = (y[3] ? y[3] : 0) - (x[3] ? x[3] : 0);	
if( r == 0 )
r = (x[4] ? x[4] : 0) - (y[4] ? y[4] : 0);	
if( r == 0 )
r = (x[0] - y[0]);							
return -r;
});
var leaders = [];
for( var i = riderXYPT.length - 1; i >= 0 && leaders.length < 5; --i )
leaders.push( riderXYPT[i][0] );
var topThree = {};
for( var i = 0; i < leaders.length; ++i )
topThree[leaders[i]] = i;
var riderPosition = {};
for( var i = 0; i < riderXYPT.length; ++i )
{
var rxypt = riderXYPT[i];
riderPosition[rxypt[0]] = riderXYPT.length - i;
var x = rxypt[1];
if( x == null )
continue;
num = rxypt[0];
var y = rxypt[2];
dc.fillStyle = colours[num % colours.length];
var j = topThree[num];
if( j != undefined )
{
dc.strokeStyle = topThreeColours[j];
dc.lineWidth = thickLine;
if( numsToWatch[num] != undefined )
dc.font = fontStrHightlight;
}
else
{
j = numsToWatch[num];
if( j != undefined )
{
dc.strokeStyle = '#ffa500';
dc.lineWidth = thickLine * 1.5;
dc.font = fontStrHightlight;
}
}
if( isNaN(x) || isNaN(y) )
continue;
//DrawCircle( dc, x, y, riderRadius );
dc.beginPath(); dc.arc(x, y, riderRadius, 0.0, Math.PI*2, true); dc.closePath(); dc.fill(); dc.stroke();
if( topThree[num] != undefined || numsToWatch[num] != undefined )
{
if( isEmptyObject(numsToWatch) || numsToWatch[num] != undefined )
{
dc.fillStyle = 'black';
dc.fillText(num+'', x+numSize, y-numSize );
}
}
if( j != undefined )
{
dc.strokeStyle = 'black';
dc.lineWidth = 1;
dc.font = fontStr;
}
}
}
dc.fillStyle = '#222';
yCur = tHeight+textVSpace*1.6;
tStr = FormatTime( t );
dc.fillText( tStr, width - dc.measureText(tStr).width, yCur );
yCur += tHeight;
if( leaders.length > 0 ) {
var leaderRaceTimes = data[leaders[0]]['raceTimes'];
if( leaderRaceTimes && leaderRaceTimes.length > 0 && leaderRaceTimes[0] < leaderRaceTimes.back() ) {
var table = [];
var leaderRaceTimes = data[leaders[0]]['raceTimes'];
var maxLaps = leaderRaceTimes.length - 1;
var glr = GetLapRatio( leaderRaceTimes, t, this.iLapDistance );
this.iLapDistance = glr[0];
TriggerReload( leaderRaceTimes, t, this.iLapDistance );
var lapRatio = glr[1];
lapRatio = Math.floor(lapRatio * 10.0) / 10.0		
table.push( FixedFormat(this.iLapDistance + lapRatio, 5, 1) + ' ' + _('Laps of') + ' ' + maxLaps );
table.push( FixedFormat(maxLaps - this.iLapDistance - lapRatio, 5, 1) + ' ' + _('Laps to go') );
var leaderCategory = data[leaders[0]]['raceCat'];
var cat = (leaderCategory && catDetails ? catDetails[leaderCategory] : null);
if( cat ) {
var distanceCur = null, distanceRace = null;
if( cat['lapDistance'] ) {
var flr = data[leaders[0]]['flr']; if( !flr ) flr = 1.0;
var distanceLap = cat['lapDistance'];
if( cat['distanceUnit'] != displayUnits )
distanceLap *= (displayUnits == 'km' ? 1.60934 : 0.621371);
distanceRace = distanceLap * (flr + maxLaps - 1);
if( this.iLapDistance == 0 )
distanceCur = lapRatio * (distanceLap * flr);
else
distanceCur = distanceLap * (flr + this.iLapDistance - 1 + lapRatio);
}
else if( cat['raceDistance'] && leaderRaceTimes.length > 0 && leaderRaceTimes[0] != leaderRaceTimes.back() ) {
distanceRace = cat['raceDistance'];
if( cat['distanceUnit'] != displayUnits )
distanceRace *= (displayUnits == 'km' ? 1.60934 : 0.621371);
distanceCur = (t - leaderRaceTimes[0]) / (leaderRaceTimes.back() - leaderRaceTimes[0]) * distanceRace;
distanceCur = Math.max( 0.0, Math.min(distanceCur, distanceRace) );
}
if( distanceCur != null ) {
if( distanceCur != distanceRace )
distanceCur = Math.floor( distanceCur * 10.0 ) / 10.0;
table.push( '' );
table.push( FixedFormat(distanceCur, 5, 1) + ' ' + _(displayUnits) + ' ' + _('of') + ' ' + distanceRace.toFixed(1) );
table.push( FixedFormat(distanceRace - distanceCur, 5, 1) + ' ' + _(displayUnits) + ' ' + _('to go') );
}
}
var widthMax = 0;
for( var w = 0; w < table.length; ++w )
widthMax = Math.max( widthMax, dc.measureText(table[w]).width );
var yCur, xCur;
if( this.compassLocation[0] == 'N' )
yCur = height - tHeight * (table.length + 1);
else
yCur = tHeight+textVSpace*1.6 + tHeight * 2;
if( this.compassLocation[1] == 'E' )
xCur = width - widthMax;
else
xCur = 0;
for( var w = 0; w < table.length; ++w ) {
yCur += tHeight;
if( !table[w] )
continue;
var value = table[w];
var tShow = value.replace( /^0+/, '' );
if( tShow[0] == '.' )
tShow = '0' + tShow;
dc.fillText( tShow, xCur + dc.measureText(Array(value.length - tShow.length + 1).join('0')).width, yCur );
}
}
}
var bannerItems = [];
for( var i = 0; i < leaders.length; ++i )
bannerItems.push( [leaders[i], i+1] );
if( !isEmptyObject(numsToWatch) )
{
var rp = [];
for( var n in numsToWatch )
{
var p = riderPosition[n];
if( p != undefined )
rp.push( [p, n] );
}
rp.sort(function(x, y) { return x[0] - y[0]; });
for( var i = 0; i < rp.length; ++i )
bannerItems.push( [rp[i][1], rp[i][0]] );
}
this.drawBanner( dc, width, height, tHeight, bannerItems );
}
}
function _initAnimation()
{
tLast = (new Date).getTime();
suspendAnimation = false;
}
function NextFrame()
{
tDelta = ((new Date).getTime() - tLast);
SetTime( t + (tDelta/1000.0) * speedup );
tLast += tDelta;
if( !suspendAnimation )
{
if( t < tMax )
setTimeout( NextFrame, 1000.0 / framesPerSecond );
else if( loopContinuously && !raceIsRunning )
{
t = 0;
setTimeout( NextFrame, 1000.0 / framesPerSecond );
}
}
}
function HasDisplayUnit( aData )
{
for( var num in aData )
{
var info = aData[num];
if( info['speed'] )
return true;
}
return false;
}
function GetDistanceUnit( aData )
{
for( var num in aData )
{
var info = aData[num];
if( info['speed'] )
{
var speedUnit = info['speed'].split(' ')[1];
return (speedUnit.substring(0, 1) == 'k' ? 'km' : 'miles');
}
}
return 'km';
}
var lastRaceTime = 0;
function SetData( aData, tCur )
{
if( !catDetails )
catDetails = [];
catDetailsByName = {};
for( var i = 0; i < catDetails.length; ++i )
catDetailsByName[catDetails[i].name] = catDetails[i];
data = (aData || null);
if( tCur != undefined )
t = tCur;
var hasLapSpeeds = false;
var hasMultipleLaps = false;
lastRaceTime = 0;
for( var num in data )
{
var info = data[num];
info['iLast'] = 1;
if( info['raceTimes'] && info['raceTimes'].length > 2 )
hasMultipleLaps = true;
if( info['lapSpeeds'] )
hasLapSpeeds = true;
if( info['status'] == 'Finisher' && info['raceTimes'].length > 1 )
info['finishTime'] = info['raceTimes'].back()
else
info['finishTime'] = info['lastTime']
if( info['finishTime'] )
lastRaceTime = Math.max( info['finishTime'], lastRaceTime );
}
categories = [];
for( var i = 0; i < catDetails.length; ++i )
categories.push( catDetails[i].name );
var catHTML = '';
if( categories.length > 2 )
{
var catHTML = '<div id="buttongroup">';
for( var i = 0; i < categories.length; ++i )
{
var cat = categories[i];
catHTML +=
'<label class="green">' +
'<input ' +
'type="radio" ' +
'name="categorySelect" ' +
'id="idCat' + i + '" ' +
'onClick="SelectCategory(\''+i+'\');" ' +
(cat == categoryCur ? 'checked="true"': '') +
'/>' +
'<span>' + cat.escapeHTML() + '</span>' +
'</input>' +
'</label>';
}
catHTML += '</div><hr class="invisible"/>';
}
else if( categories.length > 1 )
catHTML = '<h2>' + categories[1].escapeHTML() + '</h2>';
document.getElementById('idCategories').innerHTML = catHTML;
var options = [
{ i:0, name:'Lap Times',	value:'showLapTimes',		requiresMultipleLaps:false, requiresLapSpeeds:false },
{ i:1, name:'Race Times',	value:'showRaceTimes',		requiresMultipleLaps:true, requiresLapSpeeds:false },
{ i:2, name:'Time Gaps',	value:'showLapGaps',		requiresMultipleLaps:true, requiresLapSpeeds:false },
{ i:3, name:'Gap Percents',	value:'showGapPercent',		requiresMultipleLaps:false, requiresLapSpeeds:false },
{ i:4, name:'Lap Speed',	value:'showLapSpeed',		requiresMultipleLaps:true, requiresLapSpeeds:true },
{ i:5, name:'Est. Distance Gap',value:'showDistanceGap',requiresMultipleLaps:true, requiresLapSpeeds:true }
];
var showOptionsSpan = document.getElementById( 'idShowOptions' );
var showHTML = '<div id="display_menu"><label class="heading" data-tr="Show:"></label><div class="buttonset">';
var firstOption = true;
for( var i = 0; i < options.length; ++i )
{
var o = options[i];
if( o.requiresMultipleLaps && !hasMultipleLaps )
continue;
if( o.requiresLapSpeeds && !hasLapSpeeds )
continue;
showHTML += '<input type="radio" name="showOptions" id="idShowOption' + i + '" onClick="SetLapDataOption('+o.i+');"';
if( firstOption )
{
showHTML += ' checked="true"';
firstOption = false;
}
showHTML += '/><label for="idShowOption' + i + '" data-tr="' + o.name +'"></label>&nbsp;';
}
showHTML += '</div></div>';
showOptionsSpan.innerHTML = showHTML;
if( animationObj != null )
animationObj.Refresh();
}
function Animate( tRunning, aTMax, tCur )
{
StopAnimate();
_initAnimation();
if( !canvas )
return;
t = (tCur || 0);
if( !data )
return;
if( aTMax == undefined )
{
tMax = 0;
for( var num in data )
if( data[num]['raceTimes'].length > 0 )
tMax = Math.max(tMax, data[num]['raceTimes'].back());
}
else
tMax = aTMax;
speedup = (raceIsRunning ? 1.0 : tMax / tRunning);
setTimeout( NextFrame, 1000.0/framesPerSecond );
}
function createChild( parent, tag )
{
var child = document.createElement(tag);
parent.appendChild( child );
return child;
}
function createTextChild( parent, s )
{
var child = document.createTextNode(s);
parent.appendChild( child );
return child;
}
var statusSortSeq = { 'Finisher':1, 'PUL':2, 'OTL':6, 'DNF':3, 'DQ':4, 'DNS':5, 'NP':7 };
function CmpResultsData( x, y )
{
var xStatus = statusSortSeq[x[4]], yStatus = statusSortSeq[y[4]];
var dStatus = xStatus - yStatus
if( dStatus != 0 )
return dStatus;
var d = x[0] - y[0];
if( d != 0 )
return -d;
if( x[4] == 'Finisher' )
return x[1] - y[1];
var d = x[5] - y[5];
if( d != 0 )
return d;
return x[2] - y[2];
}
function CmpCategoryResultsData( x, y )
{
var c = x[6] - y[6];
if( c )
return c;
return CmpResultsData( x, y );
}
function getStartOffset( num ) {
var d = data[num];
return d.raceTimes && d.raceTimes.length > 0 ? d.raceTimes[0] : 0;
}
function UpdateCatPosIndex() {
for( var c = 0; c < catDetails.length; ++c ) {
var catDetail = catDetails[c];
var posIndex = {};
var finisherCount = 0;
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetail.pos[p];
var d = data[num];
if( d.status == 'Finisher' ) {
posIndex[num] = p+1;
++finisherCount;
}
}
catDetail.posIndex = posIndex;
catDetail.finisherCount = finisherCount;
}
}
function GetAllCategoryResults( num ) {
var results = [];
if( catDetails && catDetails.length > 0 ) {
if( !catDetails[0].posIndex )
UpdateCatPosIndex();
for( var c = 0; c < catDetails.length; ++c ) {
var catDetail = catDetails[c];
if( catDetail.name != 'All' && catDetail.posIndex[num] )
results.push( catDetail.posIndex[num] + '/' + catDetail.finisherCount + ' ' + catDetail.name );
}
}
return results.join( ',  ' );
}
//----------------------------------------------------------------------
function applyRAM( dest, ram ) {
var src, i, k;
src = ram.a;
for( k in src )
dest[k] = src[k];
src = ram.m;
for( k in src )
dest[k] = src[k];
src = ram.r;
for( i = src.length-1; i >= 0; --i )
delete dest[src[i]];
}
function PostMessageRefresh() {
SetData( data, undefined );
SetRaceTime();
setCategory( categoryCur );			
RefreshResultsTable();
RefreshRaceChart();
SituationRefresh();
if( animationObj )
animationObj.resetCache();		
Animate( animationSeconds, undefined, t );
}
function SyncMsgPayload( msg ) {
for( f in msg.reference )
window[f] = msg.reference[f];
}
function isCurrentResults() {
return window.location.href.indexOf("CurrentResults.html") >= 0;
}
function isPreviousResults() {
return window.location.href.indexOf("PreviousResults.html") >= 0;
}
var versionCount = 0;
function ProcessRAM( msg ) {
if( !isCurrentResults() ) {
if( raceName && msg.reference.raceName != raceName )
return true;
}
if( msg.cmd != 'ram' || msg.reference.versionCount != versionCount + 1 )
return false;
if( !data )
data = {};
applyRAM( data, msg.infoRAM );
var c, k, f;
var catDetailsCur = {};
if( catDetails )
for( c = 0; c < catDetails.length; ++c )
catDetailsCur[catDetails[c].name] = catDetails[c];
applyRAM( catDetailsCur, msg.categoryRAM );
catDetails = [];
for( k in catDetailsCur )
catDetails.push( catDetailsCur[k] );
catDetails.sort( function(a, b) {return a.iSort - b.iSort;} );
SyncMsgPayload( msg );
return true;
}
var baselinePending = false;
function ProcessBaseline( msg ) {
if( !isCurrentResults() ) {
if( msg.reference.raceName != raceName )
return true;
}
if( msg.cmd != 'baseline' )
return false;
data = msg.info;
var c, k, f;
catDetails = [];
for( k in msg.categoryDetails )
catDetails.push( msg.categoryDetails[k] );
catDetails.sort( function(a, b) {return a.iSort - b.iSort;} );
SyncMsgPayload( msg );
baselinePending = false;	
return true;
}
var websocket = null;
var timeoutID = null;
function RetryResetWebSocket() {
if( timeoutID === null )
timeoutID = setTimeout( ResetWebSocket, 5000 );
}
function ResetWebSocket() {
if( window.location.port != '8765' )	
return;
if( timeoutID !== null ) {
clearTimeout( timeoutID );
timeoutID = null;
}
if ("WebSocket" in window) {
if( websocket && websocket.readyState != websocket.CLOSED ) {
websocket.close();
websocket = null;
}
var wsurl = 'ws://' + window.location.hostname + ':' + (parseInt(window.location.port) + 1) + '/';
//var wsurl = 'ws://' + 'localhost' + ':' + (parseInt(window.location.port) + 1) + '/';
console.log( 'wsurl="' + wsurl + '"' );
websocket = new window.WebSocket( wsurl );
websocket.onmessage = function( evt ) {
var isCurResults = isCurrentResults();
var localRaceName = isCurResults ? 'CurrentResults' : raceName;
var msg = JSON.parse( evt.data );
if( !msg.reference ) {
console.log( evt.data );
return;
}
if( msg.reference.raceName == raceName || isCurResults ) {
if( msg.cmd == 'ram' ) {
if( ProcessRAM(msg) )
PostMessageRefresh();
else {
if( !baselinePending ) {
websocket.send( JSON.stringify({'cmd':'send_baseline', 'raceName':localRaceName}) );
baselinePending = true;
}
}
}
else if( msg.cmd == 'baseline' ) {
if( ProcessBaseline(msg) )
PostMessageRefresh();
}
}
else if( msg.cmd == 'reload_previous' && isPreviousResults() ) {
RefreshPayload();
}
};
websocket.onerror = function(e) {
console.log('WebSocket: Error.  Scheduling reconnect in 5 seconds...');
RetryResetWebSocket();
};
websocket.onclose = function(e) {
console.log('WebSocket: Closed.  Scheduling reconnect in 5 seconds...');
RetryResetWebSocket();
};
}
}
function CloseWebSocket() {
if( websocket )
websocket.close();
websocket = null;
}
function RefreshResultsTableArrival( raceTimesLength, raceTimesCopy )
{
var riderBib = [];		
var riderInfo = {};		
var categoryLaps;
var leaderTime;
var catTypes = (categoryCur == 'All' ? ['Start Wave', 'Component'] : ['Start Wave']);
for( var cc = 0; cc < catTypes.length; ++cc ) {
for( var c = 0; c < catDetails.length; ++c ) {
var catDetail = catDetails[c];
var catName = catDetail.name;
if( categoryCur != 'All' ) {
if( catDetail.catType != catTypes[cc] )
continue;
}
else {
if( categoryCur != catName )
continue;
}
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
var d = data[num];
if( p == 0 ) {
categoryLaps = raceTimesLength[num];
leaderTime = raceTimesCopy[num].back() - raceTimesCopy[num][0];
if( d['factor'] )
leaderTime *= d.factor / 100.0;
}
if( d['status'] != 'Finisher' || riderInfo[num] || raceTimesLength[num] == 0 )
continue;
var riderLaps = raceTimesLength[num];
var riderTime = raceTimesCopy[num][raceTimesLength[num]-1] - raceTimesCopy[num][0];
if( d.factor )
riderTime *= d.factor / 100.0;
var gap = '';
var gapValue = catDetails[c].gapValue[p];
if( gapValue > 0 )
gap = FormatTimeGap( gapValue );
else if( gapValue < 0 )
gap = gapValue + ' ' + (gapValue == -1 ? _('lap') : _('laps'));
riderInfo[num] = {
'pos': p+1,
'gap': gap,
'catName': catName,
'time': riderTime,
'finishTime': d.clockStartTime + riderTime
};
riderBib.push( num );
}
}
}
riderBib.sort( function(a, b) { return riderInfo[b].finishTime - riderInfo[a].finishTime; } );
//
var curFields = {};
var allFactorsEqual = true;
var firstFactor = null;
var speedUnit = '';
var distanceUnit = '';
for( var i = 0; i < riderBib.length; ++i ) {
var num = riderBib[i];
var d = data[num];
for( var f = 0; f < infoFields.length; ++f )
if( d[infoFields[f]] )
curFields[infoFields[f]] = true;
if( d['factor'] ) {
if( firstFactor == null )
firstFactor = d['factor'];
if( firstFactor != d['factor'] )
allFactorsEqual = false;
}
if( !speedUnit && d['speed'] ) {
speedUnit = d['speed'].split(' ')[1];
distanceUnit = (speedUnit.substring(0, 1) == 'k' ? 'km' : 'miles');
}
}
var hasFactor = !allFactorsEqual;
var lastTimeField = hasFactor ? 'lastTime' : 'lastTimeOrig';
var hasFirstLastName = (curFields['FirstName'] && curFields['LastName']);
if( hasFirstLastName ) {
curFields['FirstName'] = false;
curFields['LastName'] = false;
curFields['Name'] = true;
}
curFields['Category'] = false;
var table = document.createElement('TABLE');
table.className = 'results';
thead = createChild( table, 'THEAD' );
tr = createChild( thead, 'TR' );
createTextChild( td = createChild(tr, 'TH'), _('Bib') );
td.id = 'idNonNumeric';
for( var f = 0; f < infoFields.length; ++f ) {
if( curFields[infoFields[f]] ) {
createTextChild( td = createChild(tr, 'TH'), _(infoFields[f]) );
td.id = 'idNonNumeric';
}
}
createTextChild( td = createChild(tr, 'TH'), _('Seq') );
td.id = 'idNonNumeric';
createTextChild( td = createChild(tr, 'TH'), _('CategorySummary') );
td.id = 'idNonNumeric';
createTextChild( td = createChild(tr, 'TH'), _('ClockFinishTime') );
createTextChild( td = createChild(tr, 'TH'), _('ClockStartTime') );
createTextChild( td = createChild(tr, 'TH'), _('Time') );
if( hasFactor )
createTextChild( td = createChild(tr, 'TH'), _('Factor') );
if( speedUnit )
createTextChild( td = createChild(tr, 'TH'), displayUnits == 'km' ? 'km/h' : 'mph' );
tbody = createChild( table, 'TBODY' );
for( var i = 0; i < riderBib.length; ++i ) {
var num = riderBib[i];
var info = riderInfo[num];
var d = data[num];
tr = createChild(tbody, 'TR');
tr.className = ((i & 1) ? 'odd' : 'even');
var projectedLap = (raceIsRunning && d.interp && d.laps && d.interp[d.laps]);
function createTD( tr ) {
var td = createChild(tr, 'TD');
return td;
}
createTextChild( td = createTD(tr), num );
for( var f = 0; f < infoFields.length; ++f ) {
var field = infoFields[f];
if( curFields[field] ) {
var v;
if( field == 'Name' ) {
if( d['LastName'] && d['FirstName'] )
v = d['LastName'] + ',&nbsp;' + d['FirstName'];
else
v = d['LastName'] || d['FirstName'];
}
else
v = d[field];
td = createTD(tr);
if( v && field == 'License' && licenseLinkTemplate )
v = '<a href="' + licenseLinkTemplate + v + '" target="_blank">'+v+'</a>';
td.innerHTML = v;
if( field != 'Age' && field != 'Factor' )
td.id = 'idNonNumeric'; 
}
}
createTextChild( td = createTD(tr), riderBib.length - i );
createTextChild( td = createTD(tr), GetAllCategoryResults(num) );
td.id = 'idNonNumeric';
createTextChild( td = createTD(tr), FormatTime(info.finishTime) );
createTextChild( td = createTD(tr), FormatTime(d.clockStartTime) );
createTextChild( td = createTD(tr), FormatTime(info.time) );
if( hasFactor )
createTextChild( td = createTD(tr), (d['factor'] ? d['factor'] : 100.0).toFixed(2) );
if( speedUnit ) {
var speed = d['speed'];
if( speed )
createTextChild( td = createTD(tr), FormatSpeed(parseFloat(speed.split(' ')[0]), distanceUnit, false) );
else
createTextChild( td = createTD(tr), '' );
}
}
resultsDiv.appendChild( table );
}
function GetPrimesTable( primeFromBib, pos ) {
if( !primes || primes.length == 0 )
return null;
var primesCur = [];
for( var p = 0; p < pos.length; ++p ) {
if( primeFromBib[pos[p]] != undefined )
for( var i = 0; i < primeFromBib[pos[p]].length; ++i )
primesCur.push( primeFromBib[pos[p]][i] );
}
if( primesCur.length == 0 )
return null;
primesCur.sort( function(x, y) {return x-y;} );
var hasMerchandise=false, hasCash=false, hasPoints=false, hasTimeBonus=false, hasSponsor=false, hasName=false, hasTeam=false;
for( var p = 0; p < primesCur.length; ++p ) {
var prime = primes[primesCur[p]];
var bib = prime.winnerBib;
var info = data[bib];
hasCash = (hasCash || prime.cash);
hasMerchandise = (hasMerchandise || prime.merchandise);
hasSponsor = (hasSponsor || prime.sponsor);
hasPoints = (hasPoints || prime.points);
hasTimeBonus = (hasTimeBonus || prime.timeBonus);
hasName = (hasName || (info['FirstName'] || info['LastName']));
hasTeam = (hasTeam || info['Team']);
}
var table = document.createElement('TABLE');
table.className = 'results';
var thead = createChild( table, 'THEAD' );
var tr = createChild( thead, 'TR' );
var td;
createTextChild( td = createChild(tr, 'TH'), _('Primes') );
td.style.fontSize = '120%';
td.colSpan = (1 + 1 + (hasName?1:0) + (hasTeam?1:0) + 1 + 1 + 1 +
(hasCash?1:0) + (hasMerchandise?1:0) + (hasPoints?1:0) + (hasTimeBonus?1:0) + 1);
td.id = 'idNonNumeric';
var tr = createChild( thead, 'TR' );
createTextChild( td = createChild(tr, 'TH'), '');
createTextChild( td = createChild(tr, 'TH'), _('Bib'));
if( hasName ) {
createTextChild( td = createChild(tr, 'TH'), _('Name'));
td.id = 'idNonNumeric';
}
if( hasTeam ) {
createTextChild( td = createChild(tr, 'TH'), _('Team'));
td.id = 'idNonNumeric';
}
createTextChild( td = createChild(tr, 'TH'), _('laps to go').replace(/^./, function (match) {return match.toUpperCase();}));
createTextChild( td = createChild(tr, 'TH'), _('For'));
td.id = 'idNonNumeric';
createTextChild( td = createChild(tr, 'TH'), _('Position'));
td.id = 'idNonNumeric';
if( hasCash )
createTextChild( td = createChild(tr, 'TH'), _('Cash'));
if( hasMerchandise ) {
createTextChild( td = createChild(tr, 'TH'), _('Merchandise'));
td.id = 'idNonNumeric';
}
if( hasSponsor ) {
createTextChild( td = createChild(tr, 'TH'), _('Sponsor'));
td.id = 'idNonNumeric';
}
if( hasPoints )
createTextChild( td = createChild(tr, 'TH'), _('Points'));
if( hasTimeBonus )
createTextChild( td = createChild(tr, 'TH'), _('Time Bonus'));
var tbody = createChild( table, 'TBODY' );
for( var p = 0; p < primesCur.length; ++p ) {
var prime = primes[primesCur[p]];
var bib = prime.winnerBib;
var info = data[bib];
var tr = createChild( thead, 'TR' );
createTextChild( td = createChild(tr, 'TD'), (primesCur[p]+1) + '.');
createTextChild( td = createChild(tr, 'TD'), bib );
if( hasName ) {
var s = '';
if( info.LastName )		s = info.LastName;
if( info.FirstName )	s += (s ? ', ' : '') + info.FirstName;
createTextChild( td = createChild(tr, 'TD'), s );
td.id = 'idNonNumeric';
}
if( hasTeam ) {
createTextChild( td = createChild(tr, 'TD'), info.Team ? info.Team : '' );
td.id = 'idNonNumeric';
}
createTextChild( td = createChild(tr, 'TD'), prime.lapsToGo );
createTextChild( td = createChild(tr, 'TD'), prime.effortType != 'Custom' ? _(prime.effortType) : prime.effortCustom );
td.id = 'idNonNumeric';
createTextChild( td = createChild(tr, 'TD'), prime.position ? ordinal(prime.position) : '' );
td.id = 'idNonNumeric';
if( hasCash )
createTextChild( td = createChild(tr, 'TD'), prime.cash ? prime.cash.toFixed(2) : '');
if( hasMerchandise ) {
createTextChild( td = createChild(tr, 'TD'), prime.merchandise ? prime.merchandise : '');
td.id = 'idNonNumeric';
}
if( hasSponsor ) {
createTextChild( td = createChild(tr, 'TD'), prime.sponsor ? prime.sponsor : '');
td.id = 'idNonNumeric';
}
if( hasPoints )
createTextChild( td = createChild(tr, 'TD'), prime.points ? (prime.points != parseInt(prime.points) ? prime.points.toFixed(2) : prime.points) : '');
if( hasTimeBonus )
createTextChild( td = createChild(tr, 'TD'), prime.timeBonus ? FormatTime(prime.timeBonus).replace(/\..+$/,'') : '' );
}
return table;
}
var sameValue = '"';
function RefreshResultsTable()
{
resultsDiv.innerHTML = '';
if( !data )
return;
var primeFromBib = {};
if( primes && primes.length > 0 ) {
for( var i = 0; i < primes.length; ++i ) {
var winnerBib = primes[i].winnerBib;
if( !winnerBib )
continue;
if( primeFromBib[winnerBib] )
primeFromBib[winnerBib].push( i );
else
primeFromBib[winnerBib] = [i];
}
}
var raceTimesLength = {};
var raceTimesCopy = {};
if( raceIsRunning ) {
for( var num in data ) {
var raceTimes = data[num]['raceTimes'];
var adjust = 0.0;
if( isTimeTrial ) {
adjust = data[num]['startTime'];
if( !adjust )
adjust = 0.0;
}
raceTimesLength[num] = raceTimes.binSearch( t - adjust );
raceTimesCopy[num] = raceTimes.slice(0);
}
}
else {
for( var num in data ) {
var raceTimes = data[num]['raceTimes'];
raceTimesLength[num] = raceTimes.length;
raceTimesCopy[num] = raceTimes.slice(0);
}
}
if( isTimeTrial && arrivalMode ) {
RefreshResultsTableArrival( raceTimesLength, raceTimesCopy );
return;
}
if( showLapsFrequency < 0 ) {
var maxLaps = 0;
for( var num in data ) {
if( maxLaps < raceTimesLength[num] )
maxLaps = raceTimesLength[num];
}
var showLaps = document.getElementById('idShowLaps');
for( var i = 0; i < showLaps.options.length; ++i ) {
var freqCur = parseInt(showLaps.options[i].value, 10);
if( freqCur != 0 && (~~(maxLaps / freqCur) <= 12 || i == showLaps.options.length - 1) ) {
showLaps.selectedIndex = i;
showLapsFrequency = freqCur;
break;
}
}
}
var speedUnit = '';
var distanceUnit = '';
for( var c = 0; c < catDetails.length; ++c ) {
var catDetail = catDetails[c];
var catName = catDetail.name;
if( catName == 'All' )
continue;
if( categoryCur != 'All' && categoryCur != catName )
continue;
var curFields = {};
var hasLapSpeeds = false;
var allFactorsEqual = true;
var firstFactor = null;
var showingAllLaps = true;
var starters = 0, finishers = 0, finishersPercent = 0.0;
var finishTimeLast = 'xxx', gapValueLast = -1;
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
var d = data[num];
if( d['factor'] ) {
if( firstFactor == null )
firstFactor = d['factor'];
if( firstFactor != d['factor'] )
allFactorsEqual = false;
}
if( !speedUnit && d['speed'] ) {
speedUnit = d['speed'].split(' ')[1];
distanceUnit = (speedUnit.substring(0, 1) == 'k' ? 'km' : 'miles');
}
if( !hasLapSpeeds && d['lapSpeeds'] )
hasLapSpeeds = true;
var raceTimes = raceTimesCopy[num];
if( raceTimesLength[num] != raceTimes.length )
showingAllLaps = false;
}
var hasFactor = !allFactorsEqual;
var lastTimeField = hasFactor ? 'lastTime' : 'lastTimeOrig';
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
var d = data[num];
var lastTime = d[lastTimeField];
var raceTimes = raceTimesCopy[num];
if( raceTimes.length > 0 ) {
var firstTime = raceTimes[0];
for( var j = 0; j < raceTimes.length; ++j )
raceTimes[j] -= firstTime;
}
for( var f = 0; f < infoFields.length; ++f )
if( d[infoFields[f]] )
curFields[infoFields[f]] = true;
if( d['status'] != 'DNS' )
starters += 1;
if( d['status'] == 'Finisher' )
finishers += 1;
}
if( starters > 0 )
finishersPercent = (100.0 * finishers) / starters;
var hasFirstLastName = (curFields['FirstName'] && curFields['LastName']);
if( hasFirstLastName ) {
curFields['FirstName'] = false;
curFields['LastName'] = false;
curFields['Name'] = true;
}
var tLapMin = 100000 * 60.0 * 60.0;
var sLapMax = 0.0;
var lapMinCoords = null;
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
var info = data[num];
if( info.lapSpeeds ) {
var lapSpeeds = info.lapSpeeds;
for( var i = 0; i < lapSpeeds.length; ++i ) {
var s = lapSpeeds[i];
if( s > sLapMax ) {
sLapMax = s;
lapMinCoords = [p, i+1];
}
}
}
else {
var raceTimes = raceTimesCopy[num];
for( var i = 1; i < raceTimesLength[num]; ++i ) {
var tMax = Math.max(raceTimes[i] - raceTimes[i-1], 0.0);
if( tMax < tLapMin ) {
tLapMin = tMax;
lapMinCoords = [p, i];
}
}
}
}
var table = document.createElement('TABLE');
table.className = 'results';
var leaderNum = catDetails[c].pos[0];
var leaderraceTimes = raceTimesCopy[leaderNum];
var catStr = catName;
var thead = createChild( table, 'THEAD' );
var tr = createChild( thead, 'TR' );
tr.onclick = doReload;
tr.style.cursor = 'pointer';
var td;
createTextChild( td = createChild(tr, 'TH'), catName + (raceIsUnstarted ? ': ' + catDetail.pos.length + ' ' + _('registered') : '') );
var catTitleTD = td;
td.style.fontSize = '120%';
td.colSpan = 4;
td.id = 'idNonNumeric';
var tdTitle = td;
var numHeaders = 0;
thead = createChild( table, 'THEAD' );
tr = createChild( thead, 'TR' );
tr.onclick = doReload;
tr.style.cursor = 'pointer';
createTextChild( td = createChild(tr, 'TH'), _('Pos') );	++numHeaders;
createTextChild( td = createChild(tr, 'TH'), _('Bib') );	++numHeaders;
td.id = 'idNonNumeric';
for( var f = 0; f < infoFields.length; ++f ) {
if( curFields[infoFields[f]] ) {
createTextChild( td = createChild(tr, 'TH'), _(infoFields[f]) );
td.id = 'idNonNumeric';
++numHeaders;
}
}
if( showCategorySummary ) {
createTextChild( td = createChild(tr, 'TH'), _('CategorySummary') );	++numHeaders;
td.id = 'idNonNumeric';
}
if( isTimeTrial ) {
createTextChild( td = createChild(tr, 'TH'), _('ClockStartTime') );	++numHeaders;
createTextChild( td = createChild(tr, 'TH'), _('StartTime') );	++numHeaders;
createTextChild( td = createChild(tr, 'TH'), _('FinishTime') );	++numHeaders;
}
if( hasFactor ) {
createTextChild( td = createChild(tr, 'TH'), _('ElapsedTime') );	++numHeaders;
createTextChild( td = createChild(tr, 'TH'), _('Factor') );	++numHeaders;
}
createTextChild( td = createChild(tr, 'TH'), _('Time') );	++numHeaders;
if( !hasFactor )
createTextChild( td = createChild(tr, 'TH'), _('Gap') );	++numHeaders;
if( speedUnit ) {
createTextChild( td = createChild(tr, 'TH'), displayUnits == 'km' ? 'km/h' : 'mph' );
++numHeaders;
}
var categoryLaps	= raceTimesLength[leaderNum];
if( winAndOut ) {
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
if( raceTimesLength[num] && raceTimesLength[num] > categoryLaps )
categoryLaps = raceTimesLength[num];
}
}
var leaderTime	= raceTimesLength[leaderNum] ? raceTimesCopy[leaderNum][raceTimesLength[leaderNum]-1] : 99999;
if( categoryLaps > 2 && showLapsFrequency != 0 ) {
for( var i = 1; i < categoryLaps; ++i ) {
if( (i % showLapsFrequency == 0 || i == 1 || i == categoryLaps-1)  ) {
createTextChild( td = createChild(tr, 'TH'), _('Lap') + ' ' + i );
++numHeaders;
}
}
}
if( !showingAllLaps ) {
createTextChild( td = createChild(tr, 'TH'), '...' );
++numHeaders;
}
tdTitle.colSpan = numHeaders;
tbody = createChild( table, 'TBODY' );
for( var p = 0; p < catDetail.pos.length; ++p ) {
var position, num;
if( arrivalMode ) {
if( !catDetail.finisherCount )
UpdateCatPosIndex();
if( p < catDetail.finisherCount ) {
position = catDetail.finisherCount - p;
num = catDetails[c].pos[position-1];
}
else {
position = p + 1;
num = catDetails[c].pos[p];
}
}
else {
position = p + 1;
num = catDetails[c].pos[p];
}
var d = data[num];
function createTD( tr ) {
var td = createChild(tr, 'TD');
return td;
}
tr = createChild(tbody, 'TR');
tr.className = ((r & 1) ? 'odd' : 'even');
var riderLaps	= raceTimesLength[num];
var riderTime	= raceTimesLength[num] ? raceTimesCopy[num][raceTimesLength[num]-1] : 99999;
var raceTimes	= raceTimesCopy[num];
var isFinisher	= (d['status'] == 'Finisher');
var tFinish = (isFinisher ? riderTime : 0.0);
tr.onclick = function(n) { return function() {ToggleNumberHighlight(n);}; }(num);
var posText = (isFinisher ? '' + position + (data[num]['relegated'] ? ' REL' : ''): d['status'] );
createTextChild( td = createTD(tr), posText );
var a = createChild( td = createTD(tr), 'A' );
createTextChild( a, num );
if( d['status'] != 'DNS' && d['status'] != 'NP' && raceTimes.length >= 2 ) {
a.onclick = function(n) { return function() {OpenRiderDashboardViewerWindow(n);}; }(num);
a.href = 'javascript:void(0)';
}
var iFastestLap = -1, iSlowestLap = -1;
if( d.lapSpeeds && d.lapSpeeds.length > 1 ) {
iFastestLap = iSlowestLap = 0;
for( var i = 1; i < d.lapSpeeds.length; ++i ) {
if( d.lapSpeeds[i] > d.lapSpeeds[iFastestLap] )
iFastestLap = i;
if( d.lapSpeeds[i] <= d.lapSpeeds[iSlowestLap] )
iSlowestLap = i;
}
}
for( var f = 0; f < infoFields.length; ++f ) {
var field = infoFields[f];
if( curFields[field] ) {
var v;
if( field == 'Name' ) {
if( d['LastName'] && d['FirstName'] )
v = d['LastName'] + ',&nbsp;' + d['FirstName'];
else
v = d['LastName'] || d['FirstName'];
}
else
v = d[field];
td = createTD(tr);
if( v && field == 'License' && licenseLinkTemplate )
v = '<a href="' + licenseLinkTemplate + v + '" target="_blank">'+v+'</a>';
else if( field == 'UCICode' && v ) {
var img = GetFlagImage( v );
if( img ) {
span = createChild( td, 'SPAN' );
span.style.whiteSpace = "nowrap";
span.appendChild( img.cloneNode(true) );
createTextChild( span, ' ' + v );
v = null;
}
}
if( v )
td.innerHTML = v;
if( field != 'Age' && field != 'Factor' )
td.id = 'idNonNumeric'; 
}
}
if( position == 1 && isFinisher && distanceUnit && d['speed'] ) {
var tFinishStr = FormatTime( tFinish );
var dot = tFinishStr.indexOf('.');
if( dot > 0 )
tFinishStr = tFinishStr.substring(0, dot);
catStr = '';
var cd = catDetail;
if( cd.raceDistance )
catStr += _('Distance') + ': ' + FormatDistance(cd.raceDistance, cd.distanceUnit ? cd.distanceUnit : 'km', true);
if( cd.lapDistance && cd.laps > 1 ) {
if( catStr )
catStr += ', ';
if( cd.firstLapDistance && cd.firstLapDistance != cd.lapDistance ) {
catStr += (
_('1st lap') + ' ' + FormatDistance(cd.firstLapDistance, cd.distanceUnit ? cd.distanceUnit : 'km', true) + ', ' +
(cd.laps-1) + ' ' + _('more laps of') + ' ' + FormatDistance(cd.lapDistance, cd.distanceUnit ? cd.distanceUnit : 'km', true));
}
else
catStr += cd.laps + ' ' + _('laps of') + ' ' + FormatDistance(cd.lapDistance, cd.distanceUnit ? cd.distanceUnit : 'km', true);
}
if( raceStartTime ) {
if( catStr )
catStr += ', ';
catStr += _('Start') + ': ' + FormatTime(raceStartTime + cd.startOffset);
}
catStr +=  '<br/>';
catStr +=
(raceIsRunning ? _('Estimated') + ': ' : '') +
_('Winner') + ': ' + tFinishStr + ' ' + _('at') + ' ' +
FormatSpeed(parseFloat(d['speed'].split(' ')[0]), cd.distanceUnit ? cd.distanceUnit : 'km', true) + ', ' +
starters + ' ' + _('starters') + ', ' +
finishers + ' ' + _('finishers') + ' (' + finishersPercent.toFixed(1) + '%)';
catTitleTD.innerHTML = '<span class="biggerFont">' + catName +
(raceIsRunning ? " (" + _('race in progress') + ')' : '') + '</span>' +
'<br/><span class="smallfont">' + catStr + '</span>';
}
if( showCategorySummary ) {
createTextChild( td = createTD(tr), GetAllCategoryResults(num) );
td.id = 'idNonNumeric'; 
}
if( isTimeTrial ) {
createTextChild( td = createTD(tr), d['clockStartTime'] ? FormatTime(d['clockStartTime']) : '' );
createTextChild( td = createTD(tr), d['startTime'] ? FormatTime(d['startTime']) : '' );
var ttPenalty = (d['ttPenalty'] ? d['ttPenalty'] : 0.0);
createTextChild( td = createTD(tr),
(isFinisher && d['startTime'] && d['lastTimeOrig'])
? FormatTime(d['startTime']+d['lastTimeOrig']-ttPenalty)
: '' );
}
if( hasFactor ) {
var tFinishOrig = (isFinisher ? Math.max(d['lastTimeOrig'] - getStartOffset(num), 0.0) : 0.0);
var finishTimeOrig = (isFinisher ? FormatTime(tFinishOrig) : '');
createTextChild( td = createTD(tr), finishTimeOrig );
var factor = d['factor'];
if( !factor )
factor = 100.0;
createTextChild( td = createTD(tr), factor.toFixed(2) );
}
var finishTime = '';
if( isFinisher && d[lastTimeField] > 0.0 ) {
finishTime = FormatTime(d[lastTimeField] - getStartOffset(num) );
if( isTimeTrial ) {
if( d['ttPenalty'] )
finishTime += '*';
}
else {
if( roadRaceFinishTimes ) {
if( finishTime == finishTimeLast )
finishTime = sameValue;
else
finishTimeLast = finishTime;
}
}
}
createTextChild( td = createTD(tr), finishTime );
if( finishTime == sameValue )
td.className = 'same-value';
var gap = (winAndOut ? FormatTimeGap(0) : '');
var gapValue = catDetail.gapValue[position-1];
if( isFinisher ) {
if( gapValue > 0 ) {
if( roadRaceFinishTimes && gapValue == gapValueLast )
gap = sameValue;
else if( r != 0 && lapDataOption == 3 )
gap = '+' + ((100.0 * gapValue) / (leaderTime - getStartOffset(num))).toFixed(2);
else
gap = FormatTimeGap( gapValue );
}
else if( gapValue < 0 ) {
gap = gapValue + ' ' + (gapValue == -1 ? _('lap') : _('laps'));
}
else if( roadRaceFinishTimes && gapValue == 0.0 && gapValueLast == 0.0 ) {
gap = sameValue;
}
gapValueLast = gapValue;
}
if( !hasFactor ) {
createTextChild( td = createTD(tr), gap );
if( gap == sameValue )
td.className = 'same-value';
}
if( speedUnit ) {
var speed = d['speed'];
if( speed )
createTextChild( td = createTD(tr), FormatSpeed(parseFloat(speed.split(' ')[0]), distanceUnit, false) );
else
createTextChild( td = createTD(tr), '' );
}
if( categoryLaps > 2 && showLapsFrequency != 0 ) {
for( var i = 1; i < categoryLaps; ++i ) {
if( !(i % showLapsFrequency == 0 || i == 1 || i == raceTimesLength[num]-1)  )
continue
if( i >= raceTimesLength[num] ) {
createTextChild( td = createChild(tr, 'TD'), ' ' );
continue;
}
switch( lapDataOption )
{
case 0:	
createTextChild( td = createChild(tr, 'TD'), FormatTime(Math.max(raceTimes[i] - raceTimes[i-1], 0.0)) );
break;
case 1:	
createTextChild( td = createChild(tr, 'TD'), FormatTime(raceTimes[i]) );
break;
case 2:	
if( r == 0 )
createTextChild( td = createChild(tr, 'TD'), FormatTime(Math.max(raceTimes[i] - raceTimes[i-1], 0.0)) );
else {
var v = TimeDifference(raceTimes[i], raceTimesCopy[leaderNum][i]);
createTextChild( td = createChild(tr, 'TD'), FormatTimeGap(v) );
}
break;
case 3:	
if( r == 0 )
createTextChild( td = createChild(tr, 'TD'), FormatTime(Math.max(raceTimes[i] - raceTimes[i-1], 0.0)) );
else
{
var v = (100.0 * (raceTimes[i] - raceTimesCopy[leaderNum][i])) / raceTimesCopy[leaderNum][i];
var sign = '+';
if( v < 0 )
{
sign = '-';
v = -v;
}
createTextChild( td = createChild(tr, 'TD'), sign + v.toFixed(2) + '%' );
}
break;
case 4:	
createTextChild( td = createChild(tr, 'TD'), FormatSpeed(d.lapSpeeds[i-1], distanceUnit, false) );
break;
case 5: 
if( r == 0 )
createTextChild( td = createChild(tr, 'TD'), '-' );
else {
var dt = raceTimes[i] - raceTimesCopy[leaderNum][i];
var s = d.lapSpeeds && d.lapSpeeds.length >= i ? d.lapSpeeds[i-1] : 0.0;
var v = '';
if( s > 0.0 )
{
var distance = s * (dt / (60.0*60.0));
v = FormatDistanceGap( distance, distanceUnit );
}
createTextChild( td = createChild(tr, 'TD'), v );
}
break;
}
var classes = [];
var isFastestLap = (lapMinCoords && p == lapMinCoords[0] && i == lapMinCoords[1]);
if( isFastestLap )													classes.push( 'fastest' );
else { 
if( i == iFastestLap+1 )										classes.push( 'fastest-lap' );
else if( i == iSlowestLap+1 )									classes.push( 'slowest-lap' );
}
if( numsToWatch[num] )												classes.push( 'highlight' );
if( classes )	td.className = classes.join( ' ' );
}
}
if( !showingAllLaps )
createTextChild( td = createTD(tr), '' );
}
var hasTTPenalties = false;
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
var d = data[num];
if( d.ttPenalty ) {
hasTTPenalties = true;
break;
}
}
if( hasTTPenalties ) {
tr = createChild( tbody, 'TR' );
tr.className = 'noborder';
for( var k = 0; k < numHeaders; ++k ){
createTextChild( td = createChild(tr, 'TD'), '' );
td.innerHTML = '&nbsp;'
}
var penaltyColCount = numHeaders;
for( var f in curFields )
--penaltyColCount;
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetails[c].pos[p];
var d = data[num];
if( d.ttPenalty ) {
tr = createChild( tbody, 'TR' );
tr.className = 'noborder';
createTextChild( td = createChild(tr, 'TD'), '' );				
createTextChild( td = createChild(tr, 'TD'), '* ' + num );		
for( var f = 0; f < infoFields.length; ++f )					
{
var field = infoFields[f];
if( curFields[field] )
{
var v;
if( field == 'Name' )
{
if( d['LastName'] && d['FirstName'] )
v = d['LastName'] + ',&nbsp;' + d['FirstName'];
else
v = d['LastName'] || d['FirstName'];
}
else
v = d[field];
td = createChild(tr, 'TD');
td.innerHTML = v;
if( field != 'Age' )
td.id = 'idNonNumeric'; 
}
}
td = createChild( tr, 'TD' );
td.id = 'idNonNumeric'; 
td.setAttribute( 'colspan', penaltyColCount );
td.innerHTML = d.ttPenalty.toFixed(3) + ' sec ' + _('time penalty') + (d.ttNote ? (' - ' + d.ttNote.escapeHTML()) : '');
}
}
}
resultsDiv.appendChild( table );
var primesTable = GetPrimesTable( primeFromBib, catDetail.pos );
if( primesTable )
resultsDiv.appendChild( primesTable );
createChild(resultsDiv, 'P').innerHTML = '&nbsp;'
}
}
function byte2Hex(n) {
var nybHexString = "0123456789ABCDEF";
return String(nybHexString.substr((n >> 4) & 0x0F,1)) + nybHexString.substr(n & 0x0F,1);
}
function RGB2Color(r,g,b) {
return '#' + byte2Hex(r) + byte2Hex(g) + byte2Hex(b);
}
function makeColorGradient(frequency1, frequency2, frequency3,
phase1, phase2, phase3,
center, width, len)
{
if (len == undefined)      len = 50;
if (center == undefined)   center = 128;
if (width == undefined)    width = 127;
var grad = [];
for (var i = 0; i <= len; ++i)
{
var red = Math.sin(frequency1*i + phase1) * width + center;
var grn = Math.sin(frequency2*i + phase2) * width + center;
var blu = Math.sin(frequency3*i + phase3) * width + center;
grad.push( RGB2Color(red,grn,blu) );
}
return grad.slice(1);  
}
function lighterColor( k ) {
var s = '#';
for( var i = 0; i < 3; ++i )
{
var c = parseInt(k.substring(1 + i*2, 1 + i*2 + 2), 16);
c += (255 - c) * 0.6;
c = ~~c;
s += (c < 16 ? '0' : '') + c.toString(16);
}
return s;
}
function drawSegment( c, x, y, w, h, color, colorLighter ) {
c.save();
var gr = c.createLinearGradient( x, y, x, y+h );
gr.addColorStop(0.0, color);
gr.addColorStop(0.33, colorLighter);
gr.addColorStop(1.0, color );
c.fillStyle = gr;
c.fillRect( x, y, w, h );
if( color != '#FFFFFF' )
{
c.strokeStyle = '#000';
c.strokeRect( x, y, w, h );
}
c.restore();
}
function drawDiamond( c, xCenter, yCenter, radius ) {
c.save();
c.beginPath();
c.moveTo( xCenter + radius, yCenter );
c.lineTo( xCenter         , yCenter - radius );
c.lineTo( xCenter - radius, yCenter );
c.lineTo( xCenter         , yCenter + radius );
c.closePath();
var grd = c.createRadialGradient( 0+ xCenter, - radius*0.50 + yCenter, 0, 0 + xCenter, radius + 1 + yCenter, radius );
grd.addColorStop(0, '#FFFFFF');
grd.addColorStop(1, 'rgb(220,220,0)');
c.fillStyle = 'rgb(220,220,0)';
c.fill();
c.fillStyle = grd;
c.fill();
c.lineWidth = 1.0;
c.strokeStyle = 'rgb(128,128,128)';
c.stroke();
c.restore();
}
function drawStar( c, xCenter, yCenter, numPoints, radius, radiusInner ) {
c.save();
c.beginPath();
var angle = (Math.PI * 2.0) / numPoints;
var angle2 = angle / 2.0;
c.moveTo( 0 + xCenter, -radius + yCenter );
for( var p = 0; p < numPoints; ++p ) {
var a = p * angle + angle2 + Math.PI / 2.0;
c.lineTo( Math.cos(a) * radiusInner+ xCenter, -Math.sin(a) * radiusInner+ yCenter );
a = (p + 1) * angle + Math.PI / 2.0;
c.lineTo( Math.cos(a) * radius+ xCenter, -Math.sin(a) * radius+ yCenter );
}
c.closePath();
var grd = c.createRadialGradient( 0+ xCenter, - radius*0.50 + yCenter, 0, 0 + xCenter, radius + 1 + yCenter, radius );
grd.addColorStop(0, '#FFFFFF');
grd.addColorStop(1, 'rgb(255,165,0)');
c.fillStyle = 'rgb(255,165,0)';
c.fill();
c.fillStyle = grd;
c.fill();
c.lineWidth = 1.0;
c.strokeStyle = 'rgb(128,128,128)';
c.stroke();
c.restore();
}
var xFactorCur = 0.0;
var	barHeightCur = 0.0;
var	labelsWidthCur = 0.0;
var segmentsCur = [];
function findPos(obj) {
var curleft = curtop = 0;
if (obj.offsetParent) {
curleft = obj.offsetLeft
curtop = obj.offsetTop
while (obj = obj.offsetParent) {
curleft += obj.offsetLeft
curtop += obj.offsetTop
}
}
return [curleft,curtop];
}
var hoverTimer = null;
var xEvent = null;
var yEvent = null;
function RaceChartProcessMouse( event )
{
var canvasRaceChart = document.getElementById('idRaceChart');
var pos = findPos( canvasRaceChart );
xEvent = event.pageX - canvasRaceChart.offsetLeft;
yEvent = event.pageY - canvasRaceChart.offsetTop;
if( hoverTimer != null )
clearTimeout( hoverTimer );	
hoverTimer = setTimeout( "RaceChartUpdateInfo()", 25 );
}
function RaceChartProcessClick( event )
{
var canvasRaceChart = document.getElementById('idRaceChart');
var pos = findPos( canvasRaceChart );
xEvent = event.pageX - canvasRaceChart.offsetLeft;
yEvent = event.pageY - canvasRaceChart.offsetTop;
for( var s = 0; s < segmentsCur.length; ++s )
{
var seg = segmentsCur[s];
if( seg[0] <= xEvent && xEvent < (seg[0] + seg[2]) &&
seg[1] <= yEvent && yEvent < (seg[1] + seg[3]) )
{
var num = seg[5];
document.getElementById('idNumsToWatch').value = num + '';
SetNumsToWatch();
return;
}
}
}
function getRiderName( num ) {
var name = '';
var riderData = data[num];
if( riderData )
{
if( riderData['LastName'] )
name = riderData['LastName'];
if( riderData['FirstName'] )
{
if( name )
name = name + ', ' + riderData['FirstName'];
else
name = riderData['FirstName'];
}
}
return name;
}
function getRiderTeam( num ) {
var team = '';
var riderData = data[num];
if( riderData && riderData['Team'] )
team = riderData['Team'];
return team;
}
function getRiderNameNum( num ) {
var name = getRiderName(num);
if( name )
return name + ' ' + num;
return num + '';
}
function RaceChartUpdateInfo()
{
RefreshRaceChart();
var canvasRaceChart = document.getElementById('idRaceChart');
for( var s = 0; s < segmentsCur.length; ++s )
{
var seg = segmentsCur[s];
if( seg[0] <= xEvent && xEvent < (seg[0] + seg[2]) &&
seg[1] <= yEvent && yEvent < (seg[1] + seg[3]) )
{
var hover = seg[4];
var num = seg[5];
var name = getRiderNameNum( num );
var lap = seg[6];
hover = name + ': ' + _('Lap') + ' ' + hover;
if( showDetails ) {
var d = data[num];
if( d.interp[lap] )
hover += '\n' + _('Projected Time');
var detail = lapDetails[num + ',' + lap];
if( detail ) {
for( var dd = 0; dd < detail.length; ++dd ) {
if( detail[dd] )
hover += '\n' + detail[dd];
}
}
}
hover = hover.trim();
var splitHover = hover.split( '\n' );
var hoverLines = splitHover.length;
var fontHeight = 14;
var height = fontHeight * hoverLines + fontHeight / 2.0;
var margin = fontHeight / 4.0 - 1;
var c = canvasRaceChart.getContext('2d');
c.font = fontHeight + 'px Arial';
c.save();
c.lineWidth = 3;
c.strokeStyle = '#000';
c.strokeRect( seg[0], seg[1], seg[2]-1, seg[3]-1 );
var textWidth = 0;
for( var isp = 0; isp < splitHover.length; ++isp )
textWidth = Math.max( textWidth, c.measureText(splitHover[isp]).width );
var drawDirection = (x + textWidth > canvasRaceChart.width*0.90 ? -1 : 1);
c.lineWidth = 1;
var x = xEvent, y = yEvent;
c.fillStyle = '#FFF';
c.beginPath();
c.moveTo( x, y );
y -= fontHeight;
var yMax = y;
c.lineTo( x, y );
x += drawDirection * textWidth;
c.lineTo( x, y );
y -= height / 2;
c.arc( x, y, height / 2, Math.PI / 2, 3 * Math.PI / 2, drawDirection > 0 );
y -= height / 2;
var yMin = y;
x -= drawDirection * textWidth;
c.lineTo( x, y );
y += height / 2;
c.arc( x, y, height / 2, 3 * Math.PI / 2, drawDirection > 0 ? Math.PI : 0.0, drawDirection > 0 );
c.closePath();
c.fill();
c.stroke();
c.fillStyle = '#000';
c.textBaseline = 'top';
var yText = yMin + (yMax - yMin - splitHover.length*fontHeight) / 2;
for( var isp = 0; isp < splitHover.length; ++isp, yText += fontHeight )
c.fillText( splitHover[isp], xEvent - (drawDirection < 0 ? textWidth : 0), yText );
c.restore();
c.lineWidth = 2;
return;
}
}
}
function RefreshRaceChart()
{
var canvasRaceChart = document.getElementById('idRaceChart');
if( !data || !canvasRaceChart || !canvasSupported || winAndOut )
return;
var iFromCategory = {};
for( var i = 0; i < categories.length; ++i )
iFromCategory[categories[i]] = i;
var showStartOffsetOption = document.getElementById('idShowStartOffsetOption');
var showStartOffsetButton = document.getElementById('idShowStartOffsets');
var showStartOffsets = showStartOffsetButton.checked;
showDetails = document.getElementById('idShowDetails').checked;
var categoriesUsed = {};
var dataMax = 0;
var resultsData = [];
var lapsMax = 0;
for( var c = 0; c < catDetails.length; ++c )
{
var catDetail = catDetails[c];
var catName = catDetail.name;
if( catName == 'All' )
continue;
if( categoryCur != 'All' && categoryCur != catName )
continue;
for( var p = 0; p < catDetail.pos.length; ++p )
{
var num = catDetail.pos[p];
var d = data[num];
var raceTimes = d['raceTimes'].slice(0);	
if( catDetail.catType != 'Start Wave' && raceTimes.length > 0 )
{
for( var j = 1; j < raceTimes.length; ++j )
raceTimes[j] -= raceTimes[0];
raceTimes[0] = 0;
}
resultsData.push( [	raceTimes.length,
raceTimes.length ? raceTimes.back() : 99999,
num,
raceTimes,
d['status'],
d['finishTime'],
iFromCategory[catName]
] );
categoriesUsed[catName] = true;
if( raceTimes.length > 0 )
{
if( raceTimes.back() > dataMax )
dataMax = raceTimes.back();
if( raceTimes.length > lapsMax )
lapsMax = raceTimes.length;
}
}
}
if( resultsData.length == 0 || lapsMax == 0 )
{
canvasRaceChart.height = 8;
return;
}
var categoryCount = 0;
for( var c in categoriesUsed )
++categoryCount;
var rowMin = 14, rowMax = rowMin*2, rows = resultsData.length + categoryCount + 2;
if( canvasRaceChart.height / rows < rowMin )
canvasRaceChart.height = ~~(rowMin * rows);
else if( canvasRaceChart.height / rows > rowMax )
canvasRaceChart.height = ~~(rowMax * rows);
var width = canvasRaceChart.width;
var height = canvasRaceChart.height;
var dc = canvasRaceChart.getContext('2d');
var backColour = 'white';
dc.textBaseline = "top";
dc.fillStyle = backColour;
dc.fillRect(0, 0, width, height );
resultsData.sort( CmpCategoryResultsData );
var iNum = 2;
var iRaceTimes = 3;
var iStatus = 4;
var iCategory = 6;
showStartOffsetOption.className = 'hidden';
var startOffset = resultsData[0][iRaceTimes][0];
for( var i = 1; i < resultsData.length; ++i ) {
if( resultsData[i][iRaceTimes][0] != startOffset ) {
showStartOffsetOption.className = 'shown';
startOffset = 0.0;
break;
}
}
if( startOffset != 0.0 ) {
for( var i = 0; i < resultsData.length; ++i ) {
var raceTimes = resultsData[i][iRaceTimes];
for( var j = 0; j < raceTimes.length; ++j )
raceTimes[j] -= startOffset;
}
dataMax -= startOffset;
}
else if( !showStartOffsets ) {
dataMax = 0;
for( var i = 0; i < resultsData.length; ++i ) {
var num = resultsData[i][iNum];
var d = data[num];
var raceTimes = resultsData[i][iRaceTimes];
if( raceTimes.length > 0 ) {
startOffset = raceTimes[0];
if( startOffset ) {
for( var j = 0; j < raceTimes.length; ++j )
raceTimes[j] -= startOffset;
}
if( raceTimes.back() > dataMax )
dataMax = raceTimes.back();
}
}
}
lapsMax = resultsData.length > 0 ? resultsData[0][iRaceTimes].length : 0;
var colors = makeColorGradient(2.4,2.4,2.4,0,2,4,128,127,500);
var lighterColors = [];
for( var i = 0; i < colors.length; ++i )
lighterColors.push( lighterColor(colors[i]) );
var barHeight = ~~(height / (resultsData.length + 3 + (categoryCur == 'All' ? categories.length-1 : 0)));
if( barHeight < 4 || dataMax == 0 )
return;
barHeight = Math.min( barHeight, 18 );
var minimizeLabels = false;
var normalTextHeight = barHeight * 0.80;
var textHeight = normalTextHeight;
var fontStr = textHeight + "px Arial";
dc.font = fontStr;
var textWidthLeft = dc.measureText('0000').width;
for( var i = 0; i < resultsData.length; ++i ) {
var rd = resultsData[i];
var num = rd[iNum];
textWidthLeft = Math.max(	dc.measureText(getRiderNameNum(num) + '0:0').width,
dc.measureText(categories[rd[iCategory]] + '0:0').width,
textWidthLeft );
}
var legendSep = 4;			
var labelsWidthLeft = textWidthLeft + legendSep;
var labelsWidthRight = dc.measureText('0000').width + legendSep;
var drawLabels = true;
if( labelsWidthLeft + labelsWidthRight > width ) {
labelsWidthLeft = labelsWidthRight = 0;
drawLabels = false;
}
var xLeft = labelsWidthLeft;
var xRight = width - labelsWidthRight;
var yBottom = barHeight * (resultsData.length + categoryCount + 1);
var yTop = 2 * barHeight;
var lineWidth = 0.5;
var fontLegendStr = (normalTextHeight*.75) + "px Arial";
dc.font = fontLegendStr;
textHeight = (normalTextHeight * .75);
textWidth = dc.measureText( dataMax < 60*60 ? '00:00' : '00:00:00' ).width;
var numLabels = (xRight - xLeft) / (textWidth * 2.0);
var idealInterval = dataMax / numLabels;
var intervals = [1, 2, 5, 10, 15, 20, 30, 1*60, 2*60, 5*60, 10*60, 15*60, 20*60, 30*60, 1*60*60, 2*60*60, 4*60*60, 8*60*60, 12*60*60, 24*60*60];
for( d = 1; d < intervals.length - 1 && intervals[d] < idealInterval; ++d )
continue;
d = intervals[d];
var dFactor = (xRight - xLeft) / dataMax;
dc.strokeStyle = 'black';
dc.fillStyle = 'black';
dc.lineWidth = lineWidth;
for( var tCur = 0; tCur < dataMax; tCur += d ) {
var x = xLeft + tCur * dFactor;
var s = FormatTime(tCur);
var w = dc.measureText(s).width;
dc.fillText( s, x - w/2, barHeight + 2 );
if( !minimizeLabels )
dc.fillText( s, x - w/2, yBottom + 4 );
DrawLine( dc, x, yBottom+3, x, yTop-3 );
}
dc.font = fontStr;
textHeight = normalTextHeight;
textWidth = dc.measureText('0000').width;
dc.lineCap = 'butt';
dc.lineJoin = 'miter';
var categoryStartOffset = 0;
var xFactor = (width - labelsWidthLeft - labelsWidthRight) / dataMax;
var yLast = 2 * barHeight;
var yHighlight = null;
segmentsCur = [];
var iCategoryLast = -1;
for( var i = 0; i < resultsData.length; ++i ) {
if( i == 0 || resultsData[i][iCategory] != iCategoryLast ) {
if( !showStartOffsets )
categoryStartOffset = resultsData[i][iRaceTimes] ? resultsData[i][iRaceTimes][0] : 0;
iCategoryLast = resultsData[i][iCategory];
if( i == 0 ) {
dc.fillStyle = '#FFFFFF';
var w = dc.measureText(categories[iCategoryLast] + '0:00').width;
dc.fillRect( legendSep, yLast, w + 1, barHeight + 1 );
dc.fillStyle = '#000000';
dc.fillText( categories[iCategoryLast], legendSep, yLast - barHeight );
DrawLine( dc, 0, yLast, width - labelsWidthRight + 1, yLast );
}
else {
var negOffset = -4;
dc.fillStyle = '#FFFFFF';
dc.fillRect( negOffset, yLast, width - labelsWidthRight + 1 - negOffset, barHeight + 1 );
dc.strokeRect( negOffset, yLast, width - labelsWidthRight + 1 - negOffset, barHeight );
dc.fillStyle = '#000000';
dc.fillText( categories[iCategoryLast], legendSep, yLast );
yLast += barHeight;
}
}
yCur = yLast + barHeight;
xLast = labelsWidthLeft;
xCur = xLast;
var num = resultsData[i][iNum];
var raceTimes = resultsData[i][iRaceTimes];
if( resultsData[i][iStatus] != 'Finisher' ) {
dc.fillStyle = dnfBackgroundColour;
dc.fillRect( 0, yLast, width, yCur - yLast + 1 );
}
dc.strokeStyle = "#0F0F0F";
for( var j = 0; j < raceTimes.length; ++j ) {
if( raceIsRunning && raceTimes[j] > t )
break;
var tCur = raceTimes[j] - categoryStartOffset;
xCur = ~~(labelsWidthLeft + tCur * xFactor);
if( j == 0 ) {
dc.fillStyle = resultsData[i][iStatus] == 'Finisher' ? '#FFFFFF' : dnfBackgroundColour;
dc.fillRect( xLast, yLast, xCur - xLast + 1, yCur - yLast + 1 );
dc.strokeRect( xLast, yLast, xCur - xLast + 1, yCur - yLast + 1 );
}
else {
var riderData = data[num];
var hover = j + ', ' + FormatTime(raceTimes[j] - raceTimes[j-1]);
drawSegment( dc, xLast, yLast, xCur - xLast + 1, yCur - yLast + 1, colors[j], lighterColors[j] );
segmentsCur.push( [xLast, yLast, xCur - xLast + 1, yCur - yLast + 1, hover, num, j] );
if( showDetails ) {
var detail = lapDetails[num + ',' + j];
if( detail && detail[0] ) {
dc.fillStyle = '#000000';
dc.fillText( detail[0], xLast + 2, yLast + (yCur - yLast - textHeight) / 2 );
}
}
}
xLast = xCur;
}
xCur = ~~(labelsWidthLeft + dataMax * xFactor);
dc.fillStyle = resultsData[i][iStatus] == 'Finisher' ? '#FFFFFF' : dnfBackgroundColour;
dc.fillRect( xLast, yLast, width - xLast, yCur - yLast + 1 );
dc.strokeRect( xLast, yLast, xCur - xLast + 1, yCur - yLast + 1 );
dc.fillStyle = '#000000';
var lab = getRiderName( resultsData[i][iNum] );
if( lab )
lab += ' ' + resultsData[i][iNum];
else
lab = resultsData[i][iNum] + '';
dc.fillStyle = '#000000';
dc.fillText( lab, labelsWidthLeft - dc.measureText(lab).width - legendSep, yLast );
if( !minimizeLabels ) {
lab = resultsData[i][iNum] + '';
dc.fillText( lab, width - labelsWidthRight + legendSep, yLast );
}
if( numsToWatch[resultsData[i][iNum]] != undefined ) {
dc.save()
dc.strokeStyle = "#000000";
var lineWidth = 2;
dc.lineWidth = lineWidth;
dc.strokeRect( lineWidth / 2, yLast, width - lineWidth / 2, yCur - yLast + 1 - lineWidth );
dc.restore();
}
if( showDetails ) {
xLast = labelsWidthLeft;
xCur = xLast;
for( var j = 0; j < raceTimes.length; ++j ) {
if( raceIsRunning && raceTimes[j] > t )
break;
var tCur = raceTimes[j] - categoryStartOffset;
xCur = ~~(labelsWidthLeft + tCur * xFactor);
if( j != 0 ) {
var num = resultsData[i][iNum];
var d = data[num];
if( d && d.interp[j] )
drawDiamond( dc, xCur, (yCur + yLast) / 2.0, barHeight / 2.0 );
else {
var detail = lapDetails[num + ',' + j];
if( detail && detail[1] )
drawStar( dc, xCur, (yCur + yLast) / 2.0, 5, barHeight / 2.0, barHeight / 4.0 );
}
}
xLast = xCur;
}
}
yLast = yCur;
}
xFactorCur = xFactor;
barHeightCur = barHeight;
labelsWidthCur = labelsWidthLeft;
}
function Rect( x, y, width, height ) {
this.x = x;
this.y = y;
this.width = width;
this.height = height;
}
Rect.prototype.GetLeft = function() { return this.x; }
Rect.prototype.GetRight = function() { return this.x + this.width; }
Rect.prototype.GetTop = function() { return this.y; }
Rect.prototype.GetBottom = function() { return this.y + this.height; }
Rect.prototype.GetWidth = function() { return this.width; }
Rect.prototype.GetHeight = function() { return this.height; }
Rect.prototype.SetTop = function( y ) { this.y = y; }
Rect.prototype.SetBottom = function( y ) { this.y = y - this.height; }
Rect.prototype.SetLeft = function( x ) { this.x = x; }
Rect.prototype.SetRight = function( x ) { this.x = x - this.width; }
Rect.prototype.ContainsXY = function(x, y) {
return this.x <= x && x <= this.x + this.width && this.y <= y && y <= this.y + this.height;
}
Rect.prototype.print = function( label ) {
console.log( label + ': Rect(' + this.x + ',' + this.y + ',' + this.width + ',' + this.height + ')' );
}
Rect.prototype.Intersects = function( r ) {
return !(
r.x + r.width < this.x ||
this.x + this.width < r.x ||
r.y + r.height < this.y ||
this.y + this.height < r.y
);
}
var _resultsNums = [];
var _raceTMax = null;
var _lastCategory = '';
function GetValidResultsNums() {
if( _lastCategory == categoryCur )
return _resultsNums;
_resultsNums = [];
_raceTMax = null;
for( var c = 0; c < catDetails.length; ++c )
{
var catDetail = catDetails[c];
if( categoryCur != catDetail.name )
continue;
for( var p = 0; p < catDetail.pos.length; ++p ) {
var num = catDetail.pos[p];
var d = data[num];
var raceTimes = d['raceTimes'];
if( raceTimes && raceTimes.length >= 2 )
_resultsNums.push( num );
}
break;
}
_lastCategory = categoryCur;
return _resultsNums;
}
function GetRaceTMax() {
if( _lastCategory == categoryCur && _raceTMax != null )
return _raceTMax;
var resultsNums = GetValidResultsNums();
_raceTMax = 0.0;
for( var i = 0; i < resultsNums.length; ++i ) {
var d = data[resultsNums[i]];
if( d ) {		
var raceTimes = d['raceTimes'];
if( raceTimes.back() > _raceTMax )
_raceTMax = raceTimes.back();
}
}
return _raceTMax;
}
function ShortFormatTimeGap( t ) {
var tStr = FormatTimeGap( t );
if( tStr.substring(0, 3) == "0'0" )
tStr = tStr.substring(3);
else if( tStr.substring(0,2) == "0'" )
tStr = tStr.substring(2);
return tStr;
}
function GetLapLE( raceTimes, t ) {
var lap = raceTimes.binSearch( t );
if( lap >= raceTimes.length )
lap = raceTimes.length - 1;
return raceTimes[lap] > t ? lap-1 : lap;
}
function GetPositionSpeed( raceTimes, t ) {
var lap = GetLapLE( raceTimes, t );
var lapStartTime = raceTimes[lap];
var lapTime = 0.0;
if( lap+1 < raceTimes.length )
lapTime = raceTimes[lap+1] - raceTimes[lap];
else
lapTime = raceTimes[lap] - raceTimes[lap-1];
var speed = 1.0 / lapTime;
return {'position': lap + (t - lapStartTime) * speed, 'speed': speed};
}
function GetLeaderGap( leaderPosition, leaderSpeed, leaderRaceTimes, raceTimes, t ) {
if( !raceTimes || raceTimes.length == 0 )
return null;
if( t >= raceTimes[raceTimes.length-1] ) {
if( t >= leaderRaceTimes[leaderRaceTimes.length-1] )
return {
'gap':leaderRaceTimes.length == raceTimes.length ? raceTimes[raceTimes.length-1] - leaderRaceTimes[leaderRaceTimes.length-1] : null,
'lapsDown': raceTimes.length - leaderRaceTimes.length
};
return {'gap':null, 'lapsDown':raceTimes.length - leaderRaceTimes.length};
}
var ps = GetPositionSpeed( raceTimes, t );
var riderPosition = ps.position, riderSpeed = ps.speed;
var deltaPostion = leaderPosition - riderPosition;
var positionFraction = deltaPostion - Math.floor(deltaPostion);
if( positionFraction < 0.0 )
positionFraction += 1.0;
return {'gap':positionFraction / leaderSpeed, 'lapsDown': -Math.floor(deltaPostion)};
}
function PathFromPoints( dc, points, xTranslate, yTranslate ) {
xTranslate = xTranslate ? xTranslate : 0;
yTranslate = yTranslate ? yTranslate : 0;
dc.beginPath();
dc.moveTo( points[0][0] + xTranslate, points[0][1] + yTranslate );
for( var p = 1; p < points.length; ++p )
dc.lineTo( points[p][0] + xTranslate, points[p][1] + yTranslate );
}
function GetSituationGaps( t ) {
var BigTime = 1000.0*24.0*60.0*60.0;
var resultsNums = GetValidResultsNums();
if( resultsNums.length == 0 )
return [];
var maxLaps = 0;
for( var i = 0; i < resultsNums.length; ++i ) {
var d = data[resultsNums[i]];
if( d && d.raceTimes && d.raceTimes.length - 1 > maxLaps )
maxLaps = d.raceTimes.length - 1;
}
if( t == undefined ) {
if( raceIsRunning && timestamp ) {
var tServer = (new Date(timestamp[0]).getTime()) / 1000.0;
var tBrowser = (new Date().getTime()) / 1000.0;
while( tBrowser - tServer < 0 )
tBrowser += 60*60;
t = timestamp[1] + (tBrowser - tServer);
}
else
t = BigTime;
}
var raceTMax = GetRaceTMax();
t = Math.min( t, raceTMax );
var leaderRaceTimes = [];
for( var lap = 0; lap <= maxLaps; ++lap ) {
var tMinLap = BigTime;
for( var i = 0; i < resultsNums.length; ++i ) {
var d = data[resultsNums[i]];
if( d && d.raceTimes.length > lap && d.raceTimes[lap] < tMinLap )
tMinLap = d.raceTimes[lap];
}
leaderRaceTimes.push( tMinLap );
}
function getInfo( num, lapsDown ) {
var d = data[num];
var names = [];
if( d.LastName ) names.push( d.LastName );
if( d.FirstName ) names.push( d.FirstName.slice(0, 1) );
if( lapsDown != 0 )
num = '\u2198' + num;
return num + ' ' + names.join(',') + (lapsDown != 0 ? ' (' + lapsDown + ')': '');
}
var ps = GetPositionSpeed( leaderRaceTimes, t );
var leaderPosition = ps.position, leaderSpeed = ps.speed;
var gaps = [];
for( var i = 0; i < resultsNums.length; ++i ) {
var num = resultsNums[i];
var d = data[num];
if( d ) {
gapLapsDown = GetLeaderGap( leaderPosition, leaderSpeed, leaderRaceTimes, d.raceTimes, t );
if( gapLapsDown != null && gapLapsDown.gap != null )
gaps.push( [gapLapsDown.gap, getInfo(num, gapLapsDown.lapsDown), num] );
}
}
gaps.sort( function(a, b) { return a[0] - b[0]; } );
if( gaps.length > 0 ) {
var gapMin = gaps[0][0];
if( gapMin > 0 ) {
for( var g = 0; g < gaps.length; ++g )
gaps[g][0] -= gapMin;
}
}
var thisLap = GetLapLE(leaderRaceTimes, t);
var tCur = t;
var tAfterLeader = t - leaderRaceTimes[thisLap];
var laps = leaderRaceTimes.length - 1;
var lap = Math.min( thisLap + 1, laps );
var lapsToGo = Math.max(laps - lap, 0);
var title = 
'   ' + _('Lap') + ': ' + lap + '/' + laps + '   ' + _('Laps to go') + ': ' + lapsToGo +
'    ' + _('Race Time') + ': ' + FormatTime(tCur);
return {"gaps":gaps, "tAfterLeader":tAfterLeader, "title":title, "tCur":tCur};
}
function Situation( situationCanvas, timeRange, detailDiv) {
this.situationCanvas = situationCanvas;
this.timeRange = timeRange;
this.detailDiv = detailDiv;
var groupIndexColour = '#FFCC99';
var groupGapColour = 'rgb(255,255,102)';
var groupSizeColour = '#99CCFF';
var groupColour = 'rgb(128,128,255)';
var packColour = 'rgb(200,255,200)';
var greyPenColour = 'rgb(100,100,100, 0.64)';
var greyBrushColour = 'rgb(232,232,232)';
var blackColour = '#000000';
var whiteColour = '#FFFFFF';
this.gaps = [];
this.groupRectList = [];
this.groupFullData = [];
this.tAfterLeader = null;
this.title = null;
this.tCur = null;
this.zoom = 1.0;
this.groupClickHandler = null;
//	self.Bind(wx.EVT_LEFT_UP, self.OnMouseUp )
this.SetData = function( gaps, tAfterLeader, title, tCur ) {
this.gaps = (gaps && gaps.length > 0) ? gaps : [];
this.tAfterLeader = tAfterLeader;
this.title = title;
this.tCur = tCur;
this.DrawDetails( null, null, null, null );
this.Refresh();
}
this.SetZoom = function( zoom ) {
this.zoom = zoom;
this.Refresh();
}
this.Refresh = function() { this.Draw(); }
this.Draw = function() {
var dc = situationCanvas.getContext('2d');
var width = situationCanvas.width;
var height = situationCanvas.height;
dc.fillStyle = whiteColour;
dc.fillRect( 0, 0, width, height );
this.groupRectList = [];
this.groupFullData = [];
function SetGreyPen() { dc.strokeStyle = greyPenColour; dc.lineWidth = 1; }
var maxGapSec = 20.0*60.0*60.0;	
var groups = [];
var group = [];
var gapPrev = null;
for( var g = 0; g < this.gaps.length; ++g ) {
var gap = this.gaps[g];
if( gap[0] > maxGapSec )
break;
if( gapPrev == null || gap[0] - gapPrev[0] <= 1.0 )
group.push( gap );
else {
groups.push( group );
group = [gap];
}
gapPrev = gap;
}
if( group.length > 0 )
groups.push( group );
this.groupFullData = [];
var groupMax = 0;
var groupTimeMaxSize = null;
for( var g = 0; g < groups.length; ++g ) {
var group = groups[g];
this.groupFullData.push( group.slice() );
if( group.length > groupMax ) {
groupMax = group.length;
groupTimeMaxSize = group[0][0];
}
}
for( var i = 0; i < groups.length; ++i ) {
var group = groups[i];
if( group.length == 0 )
continue;
var groupSize = group.length;
if( group.length > 10 ) {
group = [].concat( group.slice(0,5), [[group[5][0], '...']], group.slice(group.length-5, group.length) );
}
if( i == 0 )
group.splice( 0, 0, [group[0][0], 'Lead  \u200B  ' + groupSize] );
else
group.splice( 0, 0, [group[0][0], 'Chase\u00A0' + i + '  ' + ShortFormatTimeGap(group[0][0]) + 'gap  ' + groupSize] );
groups[i] = group;
}
var fontHeight = height / 40;
if( fontHeight == 0 )
return;
var font = fontHeight + 'px Arial';
dc.font = font;
var spaceWidth = fontHeight / 2;
var boldFont = 'bold ' + fontHeight + 'px Arial';
var smallFontHeight = fontHeight * 0.75;
var smallFont = smallFontHeight + 'px Arial';
dc.font = font;
dc.fillStyle = blackColour;
dc.textBaseline = "top";
var border = Math.min( width, height ) / 25;
var xLeft = border*2;
var yTop = border*2.25 + fontHeight;
if( this.title != null )
dc.fillText( this.title, xLeft, border );
if( groups.length == 0 )
return;
function GetGroupTextExtent( group ) {
var widthMax = 0;
var widthCur;
for( var g = 0; g < group.length; ++g ) {
if( numsToWatch[group[g][2]] != undefined ) {
dc.save();
dc.font = boldFont;
widthCur = dc.measureText(group[g][1]).width;
dc.restore();
}
else
widthCur = dc.measureText(group[g][1]).width;
widthMax = Math.max( widthMax, widthCur );
}
return {"width":widthMax, "height":group.length*fontHeight*1.1};
}
var lastWidth = GetGroupTextExtent( groups[groups.length-1] ).width;
var xRight = width - border - lastWidth;
var yBottom = height - border;
var gapMax = 0.0;
if( groups.length > 0 && groups[0].length > 0 ) {
var groupFirst = groups[0], groupLast = groups[groups.length-1];
var tFirst = groupFirst[0][0];
var tLast = groupLast[groupLast.length-1][0];
gapMax = tLast - tFirst;
}
var xScale = (xRight - xLeft) / (gapMax != 0.0 ? gapMax : 1.0) * this.zoom;
function drawFinishLine() {
if( this.tAfterLeader == null )
return;
var x = xLeft + this.tAfterLeader * xScale;
var flWidth = width / 32;
if( x - flWidth > width )
return;
var flTop = yTop - border / 2;
var flBottom = flTop + border;
dc.strokeStyle = 'rgb(220,220,220)';
dc.lineWidth = Math.max(width / 800, 1);
dc.fillStyle = whiteColour;
dc.fillRect( x - flWidth / 2, flTop, flWidth, flBottom - flTop );
dc.strokeRect( x - flWidth / 2, flTop, flWidth, flBottom - flTop );
dc.lineWidth = flWidth / 4;
dc.lineCap = 'butt';
DrawLine( dc, x, flTop, x, flBottom );
dc.fillStyle = whiteColour;
dc.fillRect( width-border, 0, width, height );
}
drawFinishLine();
dc.strokeStyle = blackColour;
dc.lineWidth = 1;
dc.fillStyle = blackColour;
DrawLine( dc, xLeft - border, yTop, width-border, yTop );
var arrowLength = border * 0.8;
var points = [[0,0], [arrowLength, arrowLength/4], [arrowLength, -arrowLength/4]];
PathFromPoints( dc, points, border/2, yTop ); dc.closePath();
dc.fill();
dc.stroke();
SetGreyPen();
var groupTitleBrushes = [
groupIndexColour,
groupGapColour,
groupSizeColour,
];
var existingRects = [];	
var groupHeight = height / 40;
var groupRectList = [];
for( var g = 0; g < groups.length; ++g ) {
var group = groups[g];
var xBegin = xLeft + group[0][0] * xScale;
var xEnd = xLeft + group[group.length-1][0] * xScale;
dc.fillStyle = groupColour;
dc.fillRect( xBegin - groupHeight/2, yTop - groupHeight/2, xEnd - xBegin + groupHeight, groupHeight );
dc.strokeStyle = blackColour;
dc.lineCap = 'butt';
dc.lineWidth = height / 100;
DrawLine( dc, xBegin, yTop, xEnd, yTop );
var xText = xBegin;
var yText = yTop + groupHeight/2 + fontHeight;
var gte = GetGroupTextExtent( group );
var gWidth = gte.width;
var gHeight = gte.height;
var gRect = new Rect( xText, yText, gWidth + spaceWidth*2, gHeight + fontHeight*0.6 );
var conflict = true;
while( conflict ) {
conflict = false;
for( var ir = 0; ir < existingRects.length; ++ir ) {
var r = existingRects[ir];
if( r.GetRight() < gRect.GetLeft() )
break;
if( r.Intersects(gRect) ) {
gRect.SetTop( r.GetBottom()+1 );
conflict = true;
}
}
}
existingRects.push( gRect );
for( var i = existingRects.length-2; i >= 0;  --i ) {
if( existingRects[i].GetRight() < existingRects[i+1].GetRight() )
existingRects.swap(i, i+1);
else
break;
}
groupRectList.push( [group, gRect] );
}
SetGreyPen();
for( var g = 0; g < groupRectList.length; ++g ) {
var gRect = groupRectList[g][1];
DrawLine( dc, gRect.GetLeft(), yTop, gRect.GetLeft(), gRect.GetTop() );
}
dc.textBaseline = "top";
for( var ig = 0; ig < groupRectList.length; ++ig ) {
var group = groupRectList[ig][0], gRect = groupRectList[ig][1];
SetGreyPen();
dc.fillStyle = group[0][0] != groupTimeMaxSize ? greyBrushColour : packColour;
dc.fillRect( gRect.GetLeft(), gRect.GetTop(), gRect.GetWidth()-1, gRect.GetHeight()-fontHeight/2, fontHeight/3 );
dc.strokeRect( gRect.GetLeft(), gRect.GetTop(), gRect.GetWidth()-1, gRect.GetHeight()-fontHeight/2, fontHeight/3 );
var xText = gRect.GetLeft();
SetGreyPen();
dc.fillStyle = blackColour;
var yText = gRect.GetTop()
for( var i = 0; i < group.length; ++i ) {
var gap = group[i];
if( i == 0 ) {
var title = gap[1];
var fieldWidths = [-spaceWidth+2];
var iSpace = 0;
while( true ) {
var iSpace = title.indexOf( '  ', iSpace );
if( iSpace < 0 ) {
fieldWidths.push( dc.measureText(title).width + spaceWidth );
break;
}
fieldWidths.push( dc.measureText(title.slice(0,iSpace)).width + spaceWidth );
iSpace += 1;
}
fieldWidths[fieldWidths.length-1] += spaceWidth/2;
var iBrush = (fieldWidths.length > 2 ? 0 : 2);
var xLast = xText;
for( var iField = 1; iField < fieldWidths.length; ++iField ) {
var tWidth = fieldWidths[iField] - fieldWidths[iField-1]
dc.fillStyle = groupTitleBrushes[iBrush];
dc.fillRect( xLast, yText, tWidth, fontHeight*1.08 );
dc.strokeRect( xLast, yText, tWidth, fontHeight*1.08 );
iBrush += 1;
xLast += tWidth;
}
}
dc.fillStyle = blackColour;
if( numsToWatch[gap[2]] != undefined ) {
dc.save();
dc.font = boldFont;
dc.fillText( gap[1], xText + spaceWidth, yText+fontHeight*0.07 );
dc.restore();
}
else
dc.fillText( gap[1], xText + spaceWidth, yText+fontHeight*0.07 );
yText += fontHeight*1.1;
}
}
this.groupRectList = groupRectList;
SetGreyPen();
dc.fillStule = greyBrushColour;
dc.font = smallFont;
var yUp = yTop - groupHeight - smallFontHeight
var yText = yUp + smallFontHeight/2;
var yTextCenter = yText + smallFontHeight * 0.5;
yUp += smallFontHeight/4;
var arrowLength = smallFontHeight * 0.75;
var leftArrow = [[0,0], [arrowLength, arrowLength/4], [arrowLength, -arrowLength/4]];
var rightArrow = [[0,0], [-arrowLength, arrowLength/4], [-arrowLength, -arrowLength/4]];
dc.textBaseline = "middle";
for( var iGroup = 1; iGroup < groups.length; ++iGroup ) {
var groupPrev = groups[iGroup-1], groupNext = groups[iGroup];
var tPrev = groupPrev[groupPrev.length-1][0], tNext = groupNext[0][0];
var xPrev = xLeft + tPrev * xScale, xNext = xLeft + tNext * xScale;
var sepStr = ShortFormatTimeGap(tNext - tPrev);
var tWidth = dc.measureText( sepStr ).width;
if( xNext - xPrev < tWidth * 1.25 )
continue;
DrawLine( dc, xPrev, yTop, xPrev, yUp );
DrawLine( dc, xNext, yTop, xNext, yUp );
if( xNext - xPrev > tWidth + arrowLength * 4 ) {
DrawLine( dc, xPrev, yTextCenter, xPrev + (xNext - xPrev - tWidth) / 2 - 2, yTextCenter );
DrawLine( dc, xNext - (xNext - xPrev - tWidth) / 2 + 2, yTextCenter, xNext, yTextCenter );
PathFromPoints( dc, leftArrow, xPrev, yTextCenter ); dc.closePath(); dc.stroke(); dc.fill();
PathFromPoints( dc, rightArrow, xNext, yTextCenter ); dc.closePath(); dc.stroke(); dc.fill();
}
dc.fillStyle = blackColour;
dc.fillText( sepStr, xPrev + (xNext - xPrev - tWidth) / 2, yTextCenter );
}
}
this.processClick = function( event ) {
var rect = this.situationCanvas.getBoundingClientRect();
var xEvent = event.clientX - rect.left;
var yEvent = event.clientY - rect.top;
for( var i = 0; i < this.groupRectList.length; ++i ) {
var gRect = this.groupRectList[i][1];
if( gRect.ContainsXY( xEvent, yEvent ) ) {
this.DrawDetails( gRect, i, this.groupFullData[i], this.tCur, null );
return;
}
}
this.DrawDetails( null, null, null, null );
}
this.DrawDetails = function( gRect, groupIndex, groupInfo, raceTime, clockTime ) {
this.detailDiv.innerHTML = '';
if( groupIndex == undefined || groupIndex == null ) {
var text = '\u25C0&nbsp;&nbsp;' + _('TimeSliderInstructions') + '<br/><br/><br/><br/><br/>\u25C0&nbsp;&nbsp;' + _('ClickGroupInstructions');
var para = createChild( this.detailDiv, 'p' );
para.innerHTML = text;
para.id = 'detailTitle';
return;
}
var bigSpace = '&nbsp;&nbsp;&nbsp;&nbsp;';
var title = 
(groupIndex != 0 ? _('Chase Group') + ': ' + groupIndex : _('Leaders') + ': \u2714') + 
(groupIndex != 0 ? bigSpace + _('Gap') + ': ' + ShortFormatTimeGap(groupInfo[0][0]) : '') +
bigSpace +_('Size') + ': ' + groupInfo.length + 
(raceTime != null ? bigSpace + _('Race Time') + ': ' + FormatTime(raceTime) : '' ) + 
(clockTime != null ? bigSpace + _('Clock') + ': ' + FormatTime(clockTime) : '' );
var para = createChild( this.detailDiv, 'p' );
para.innerHTML = title;
para.id = 'detailTitle';
var nums = [];
var lapsDown = {};
var sequence = {};
var numGap = {};
for( var i = 0; i < groupInfo.length; ++i ) {
var gap = groupInfo[i][0];
var info = groupInfo[i][1];
var fields = info.split(' ');
var num = parseInt( fields[0].replace(/\D/g,'') );
var lastField = fields[fields.length-1];
if( lastField.slice(0, 1) == '(' && lastField.slice(-1) == ')')
lapsDown[num] = lastField.slice(1).slice(0, -1);
nums.push( num );
numGap[num] = gap;
sequence[num] = i+1;
}
var detailFields = infoFields.slice();
var curFields = {'Seq':true, 'Gap':true, 'Bib':true, 'LapsDown':true};
for( var i = 0; i < nums.length; ++i ) {
var num = nums[i];
var d = data[num];			
for( var f = 0; f < detailFields.length; ++f )
if( d[infoFields[f]] )
curFields[infoFields[f]] = true;
}
var hasFirstLastName = (curFields['FirstName'] && curFields['LastName']);
if( hasFirstLastName ) {
curFields['FirstName'] = false;
curFields['LastName'] = false;
curFields['Name'] = true;
}
detailFields.splice( 0, 0, 'Seq', 'Bib' );
var numericFields = {'Seq':true, 'Bib':true, 'LapsDown':true, 'Age':true};
for( var n in lapsDown ) {
var iInsert = 2;
for( var i = 0; i < detailFields.length; ++i ) {
if( detailFields[i] == 'Name' ) {
iInsert = i + 1;
break;
}
}
detailFields.splice( iInsert, 0, 'LapsDown' );
break;
}
var table = createChild( this.detailDiv, 'TABLE');
table.className = 'results';
var thead = createChild( table, 'THEAD' );
var tr = createChild( thead, 'TR' );
for( var f = 0; f < detailFields.length; ++f ) {
var field = detailFields[f];
if( curFields[field] ) {
createTextChild( td = createChild(tr, 'TH'), _(detailFields[f]) );
td.id = 'idNonNumeric';
}
}
var tbody = createChild( table, 'TBODY' );
for( var i = 0; i < nums.length; ++i ) {
var num = nums[i];
var d = data[num];			
function createTD( tr ) {
var td = createChild(tr, 'TD');
if( numsToWatch[num] )
td.className = 'highlight';
return td;
}
var tr = createChild(tbody, 'TR');
tr.onclick = function(n) { return function() {ToggleNumberHighlight(n);}; }(num);
for( var f = 0; f < detailFields.length; ++f ) {
var field = detailFields[f];
if( curFields[field] ) {
var v;
if( field == 'Seq' )
v = i+1;
else if( field == 'Bib' )
v = num;
else if( field == 'LapsDown' )
v = lapsDown[num] != undefined ? lapsDown[num] : '';
else if( field == 'Name' ) {
if( d['LastName'] && d['FirstName'] )
v = d['LastName'] + ',&nbsp;' + d['FirstName'];
else
v = d['LastName'] || d['FirstName'];
}
else
v = d[field];
td = createTD(tr);
td.innerHTML = v;
if( !numericFields[field] )
td.id = 'idNonNumeric'; 
}
}
}
createChild( this.detailDiv, 'hr' );
}
}
function pDistanceSquared(x, y, x1, y1, x2, y2) {
var A = x - x1, B = y - y1, C = x2 - x1, D = y2 - y1;
var dot = A * C + B * D;
var len_sq = C * C + D * D;
var param = -1;
if (len_sq != 0) 
param = dot / len_sq;
var xx, yy;
if (param < 0) {
xx = x1;
yy = y1;
}
else if (param > 1) {
xx = x2;
yy = y2;
}
else {
xx = x1 + param * C;
yy = y1 + param * D;
}
var dx = x - xx;
var dy = y - yy;
return dx * dx + dy * dy;
}
var dnfBackgroundColour = "#E0E0E0";
function LapChart( ) {
this.lineColours = [
"#3A3312",
"#9756EF",
"#00D222",
"#69D2FD",
"#F04403",
"#FE3D94",
"#0EAB6E",
"#301F5B",
"#CDA303",
"#2C6900",
"#45DD97",
"#E8B8A4",
"#D629BD",
"#0AA2A1",
"#C30043",
"#53131A",
"#784B07",
"#395B8F",
"#284299",
"#F4B478",
"#993AAE",
"#13A3E7",
"#340631",
"#F25DEE"
];
this.lapLineColour = '#B0B0B0';
this.positionBackgroundColour = '#B7B7B7';
this.positionHorizontalLineColor = '#B9B9B9';
this.topCornerBackgroundColour = '#8E8C8D';
this.legendBackgroundColour = '#C8C8C8';
this.lappedBackgroundColour = '#D8E6F4';
this.lapLabelBorderColour = '#707070';
this.primeColour = '#FFFFAA';
this.regularLineWidth = 3;
this.selectedLineWidth = 7;
this.rowHeight = 22;
this.canvas = null;
this.data = [];
this.lapsMax = 0;
this.numSelect = null;
this.moveTimer = null;
this.doMouseMove = function( evt ) {
var numSelectOld = this.numSelect;
this.numSelect = null;
var rect = this.canvas.getBoundingClientRect();
var x = evt.clientX - rect.left, y = evt.clientY - rect.top;
for( var c = 0; c < this.data.length; ++c ) {
if( !(this.data[c].yTop <= y && y < this.data[c].yTop + this.data[c].height) )
continue;
if( this.data[c].xRight <= x ) {
var i = parseInt(((y - this.data[c].yTop) / this.rowHeight) - 1);
if( 0 <= i && i < this.data[c].nums.length )
this.numSelect = this.data[c].nums[i];
break;
}
if( this.data[c].xLeft <= x ) {
var numPos = this.data[c].numPos;
var lapsData = this.data[c].lapsData;
var xLeft = this.data[c].xLeft, xRight = this.data[c].xRight, lapWidth = this.data[c].lapWidth;
var yTop = this.data[c].yTop;
var rowHeight = this.rowHeight;
var lap = parseInt((x - xLeft) / lapWidth);
function getX(lap) { return xLeft + lap * lapWidth; }
function getY(pos) { return yTop + rowHeight * (pos + 1); }
function getSegment( lapCur, j ) {
if( !lapsData[lapCur] || !lapsData[lapCur][j] )
return null;
var num = lapsData[lapCur][j].num;
var x1, y1;
if( lapCur == 0 ) {
x1 = getX(0);
y1 = getY(numPos[num][0]) + rowHeight/2;
}
else {
x1 = getX(lapCur-1) + lapWidth/2;
y1 = getY(numPos[num][lapCur-1]) + rowHeight/2;
}
var x2 = getX(lapCur) + lapWidth/2;
var y2 = getY(numPos[num][lapCur]) + rowHeight/2;
return {'x1':x1, 'y1':y1, 'x2':x2, 'y2':y2, 'num':num};
}
var dBest = Number.MAX_VALUE;
for( var j = 0; j < lapsData[lap].length; ++j ) {
for( var lapCur = lap; lapCur < lap + 2; ++lapCur ) {
var segment = getSegment( lapCur, j );
if( segment !== null ) {
var dCur = pDistanceSquared( x, y, segment.x1, segment.y1, segment.x2, segment.y2 );
if( dCur < dBest ) {
dBest = dCur;
this.numSelect = segment.num;
}
}
}
}
break;
}
}
if( numSelectOld != this.numSelect )
this.draw();
}
this.onMouseMove = function( evt ) {
if( this.moveTimer ) {
if( this.numSelect ) {
this.numSelect = null;
this.draw();
}
clearTimeout( this.moveTimer );
}
var that = this;
this.moveTimer = setTimeout( function() { that.doMouseMove(evt); that.moveTimer=null; }, 25 );
}
this.init = function( canvas ) {
this.canvas = canvas;
var that = this;
this.canvas.addEventListener( 'mousemove', function(evt) {that.onMouseMove(evt);} );
}
this.getData = function() {
this.data = [];
this.lapsMax = 0;
for( var c = 0; c < catDetails.length; ++c )
{
var catDetail = catDetails[c];
var catName = catDetail.name;
if( catName === 'All' )
continue;
if( categoryCur !== 'All' && categoryCur !== catName )
continue;
var lapsData = [];
var numIndex = {};
var nums = [];
for( var p = 0; p < catDetail.pos.length; ++p )
{
var num = catDetail.pos[p];
if( num in numIndex )
continue;
var d = data[num];
var raceTimes = d['raceTimes'].slice(0);	
if( raceTimes.length === 0 )
continue
numIndex[num] = nums.length;
nums.push( num )
if( catDetail.catType != 'Start Wave' && raceTimes.length > 0 ) {
for( var j = 1; j < raceTimes.length; ++j )
raceTimes[j] -= raceTimes[0];
raceTimes[0] = 0;
}
for( var j = 1; j < raceTimes.length; ++j ) {
if( raceIsRunning && raceTimes[j] > t )
break;
while( lapsData.length < j )
lapsData.push( [] );
lapsData[j-1].push( {'raceTime':raceTimes[j], 'num':num, 'lapsDown':0} );
}
this.lapsMax = Math.max( this.lapsMax, raceTimes.length-1 );
}
for( var lap = 0; lap < lapsData.length; ++lap )
lapsData[lap].sort( function(x, y) { return x.raceTime - y.raceTime; } );
for( var lap = 0; lap < lapsData.length-1; ++lap ) {
for( var j = lapsData[lap].length-1; j > 0; --j ) {
for( var lapNext = lap+1; lapNext < lapsData.length && lapsData[lap][j].raceTime > lapsData[lapNext][0].raceTime; ++lapNext )
--lapsData[lap][j].lapsDown;
if( lapsData[lap][j] === 0 )
break;
}
}
var numPos = {};
for( var lap = 0; lap < lapsData.length; ++lap ) {
for( var pos = 0; pos < lapsData[lap].length; ++pos ) {
var num = lapsData[lap][pos].num;
if( num in numPos )
numPos[num].push( pos );
else
numPos[num] = [pos];
}
}
if( lapsData.length > 1 && nums.length > 1 )
this.data.push( {'lapsData': lapsData, 'numPos': numPos, 'nums': nums, 'catName':catName} );
}
}
this.draw = function() {
if( !this.canvas )
return;
var that = this;
this.getData();
if( this.data.length == 0 || this.lapsMax <= 1 ) {
this.canvas.height = 0;
return;
}
var primeLaps = {};
if( primes && primes.length > 0 ) {
var lapsMax = 0;
for( var c = 0; c < this.data.length; ++c ) {
lapsMax = Math.max( lapsMax, this.data[c].lapsData.length );
}
for( var i = 0; i < primes.length; ++i )
primeLaps[lapsMax-primes[i].lapsToGo-1] = true;
}
var rowsTotal = 0;
for( var c = 0; c < this.data.length; ++c ) {
rowsTotal += this.data[c].nums.length + 1.5 + 2;
}
var rowHeight = this.rowHeight;
this.canvas.height = rowHeight * rowsTotal;
var width = this.canvas.width;
var dc = this.canvas.getContext('2d');
dc.setTransform( 1, 0, 0, 1, 0, 0 );
for( var c = 0; c < this.data.length; ++c ) {
var lapsData = this.data[c].lapsData;
var numPos = this.data[c].numPos;
var nums = this.data[c].nums;
var rowTextFraction = 0.7;
var fontHeight = rowHeight * rowTextFraction;
dc.font = fontHeight + 'px Arial';
dc.translate( 0, rowHeight / 2 );
var yTop = rowHeight / 2;
dc.fillStyle = '#000000';
dc.textBaseline = 'middle';
dc.textAlign = 'left';
dc.fillText( this.data[c].catName, 0, rowHeight / 2 );
dc.translate( 0, rowHeight );
yTop += rowHeight;
var height = rowHeight * (nums.length + 2);
this.data[c].yTop = (c == 0 ? yTop : this.data[c-1].yTop + this.data[c-1].height + yTop);
this.data[c].height = height;
function getName( num ) {
var d = data[num];
var name = '';
if( d.LastName && d.FirstName ) name = d.LastName + ', ' + d.FirstName;
else if( d.LastName ) name = d.LastName;
else if( d.FirstName ) name = d.FirstName;
return name;
}
var numWidth = 0;
var nameWidth = 0;
for( var j = 0; j < nums.length; ++j ) {
var num = nums[j];
numWidth = Math.max( dc.measureText(''+num).width, numWidth );
nameWidth = Math.max( dc.measureText(getName(num)).width, nameWidth );
}
var paddingWidth = dc.measureText('  ').width;
nameWidth += paddingWidth;
var posWidth = dc.measureText(''+(nums.length+1) ).width + paddingWidth;
var swatchColWidth = rowHeight;
var xLeft = posWidth;
var xRight = width - (swatchColWidth + numWidth + nameWidth + posWidth);
this.data[c].xLeft = xLeft;
this.data[c].xRight = xRight;
var lapsWidth = xRight - xLeft;
var lapWidth = lapsWidth / lapsData.length;
this.data[c].lapWidth = lapWidth;
dc.clearRect(0, 0, width, height);
if( nums.length === 0 )
return;
height = rowHeight * (nums.length + 1);
dc.lineCap = 'butt';
dc.lineJoin = 'round';
dc.setLineDash( [] );
function getY(row) { return rowHeight * (row+1); }
function getX(lap) { return xLeft + lapWidth * lap; }
var hasPrimes = false;
dc.lineWidth = 1;
dc.fillStyle = this.primeColour;
for( var lap = 0; lap < lapsData.length; ++lap ) {
if( lap in primeLaps ) {
dc.fillRect( getX(lap), getY(0), lapWidth, getY(nums.length) - getY(0) );
hasPrimes = true;
}
}
var hasLapped = false;
dc.fillStyle = this.lappedBackgroundColour;
for( var lap = 0; lap < lapsData.length; ++lap ) {
for( var row = 0; row < lapsData[lap].length; ++row ) {
if( lapsData[lap][row].lapsDown !== 0 ) {
hasLapped = true;
for( ; row < nums.length; ++row )
dc.fillRect( getX(lap), getY(row), lapWidth, rowHeight );
}
}
}
dc.fillStyle = this.legendBackgroundColour;
dc.fillRect( 0, 0, width, rowHeight );
dc.fillRect( 0, getY(nums.length), width, rowHeight );
dc.fillRect( 0, 0, xLeft, height );
dc.fillRect( width - posWidth, 0, xLeft, height );
dc.fillStyle = '#FFFFFF';
dc.textBaseline = 'middle';
dc.textAlign = 'center';
for( var j = 0; j < nums.length; ++j ) {
dc.fillText( ''+(j+1), posWidth/2, getY(j) + rowHeight/2 );
if( data[nums[j]].status == 'Finisher' )
dc.fillText( ''+(j+1), width - posWidth/2, getY(j) + rowHeight/2 );
}
dc.lineWidth = 1;
dc.strokeStyle = this.lapLineColour;
for( var lap = 0; lap <= lapsData.length; ++lap ) {
dc.beginPath();
dc.moveTo( getX(lap), 0 );
dc.lineTo( getX(lap), height );
dc.stroke();
}
dc.fillStyle = dnfBackgroundColour;
for( var j = 0; j < nums.length; ++j ) {
var d = data[nums[j]];
if( nums[j] == this.numSelect ) {
dc.save();
dc.fillStyle = '#FFFF66';
dc.fillRect( xRight, getY(j), width-xRight-posWidth, rowHeight );
dc.restore();
}
else if( d.status !== 'Finisher' )
dc.fillRect( xRight, getY(j), width-xRight-posWidth, rowHeight );
}
dc.fillStyle = '#000000';
dc.textAlign = 'right';
var xText = width - nameWidth - posWidth;
for( var j = 0; j < nums.length; ++j )
dc.fillText( nums[j], xText, getY(j) + rowHeight/2 );
dc.textAlign = 'left';
var xText =  width - nameWidth - posWidth + paddingWidth/2;
for( var j = 0; j < nums.length; ++j )
dc.fillText( getName(nums[j]), xText, getY(j) + rowHeight/2 );
function drawPath( j, colour ) {
var num = nums[j];
var path = numPos[num];
dc.strokeStyle = colour ? colour : that.lineColours[j % that.lineColours.length];
dc.setLineDash( [] );
dc.beginPath();
dc.moveTo( getX(0), getY(path[0])+rowHeight/2 );
dc.lineTo( getX(0) + lapWidth/2, getY(path[0])+rowHeight/2 );
var lap;
for( lap = 1; lap < path.length; ++lap )
dc.lineTo( getX(lap) + lapWidth/2, getY(path[lap])+rowHeight/2 );
var lap = path.length-1;
dc.stroke();
if( lap != lapsData.length-1 )
dc.setLineDash( [10, 5] );
dc.beginPath();
dc.moveTo( getX(lap) + lapWidth/2, getY(path[lap])+rowHeight/2 );
dc.quadraticCurveTo( getX(lap) + lapWidth/2, getY(j) + rowHeight/2, xRight+ + rowHeight/2, getY(j) + rowHeight/2 );
dc.stroke();
}
dc.lineWidth = this.regularLineWidth;
dc.lineCap = 'round';
var jSelect = null;
for( var j = nums.length - 1; j >= 0; --j ) {
if( nums[j] === this.numSelect )
jSelect = j;
drawPath( j );
}
if( jSelect !== null ) {
dc.lineWidth = this.selectedLineWidth + 4;
drawPath( jSelect, '#FFFF00' );
dc.lineWidth = this.selectedLineWidth;
drawPath( jSelect );
}
var swatchSize = rowHeight * rowTextFraction;
var swatchBorder = (rowHeight - swatchSize) / 2.0;
var swatchX = xRight + swatchBorder;
for( var j = 0; j < nums.length; ++j ) {
dc.fillStyle = this.lineColours[j % this.lineColours.length];
dc.fillRect( swatchX, getY(j) + swatchBorder, swatchSize, swatchSize );
}
var lapNumHeight = fontHeight;
dc.font = lapNumHeight*0.8 + 'px Arial';
dc.textAlign = 'center';
dc.textBaseline = 'bottom';
dc.lineWidth = 1;
dc.setLineDash( [] );
var xLast = width;
for( var lap = lapsData.length - 1; lap >= 0; --lap ) {
var sLap = ' ' + (lap+1) + ' ';
var tWidth = dc.measureText(sLap).width;
var xMiddle = getX(lap) + lapWidth/2;
if( xMiddle + tWidth / 2 > xLast )
continue;
var x = getX(lap) + lapWidth/2;
var y = getY(0) - lapNumHeight;
dc.beginPath()
dc.moveTo( x - tWidth/2, y );
dc.lineTo( x + tWidth/2, y );
dc.lineTo( x + tWidth/2, y + lapNumHeight );
dc.lineTo( x, y + lapNumHeight * 1.25 );
dc.lineTo( x - tWidth/2, y + lapNumHeight );
dc.closePath();
dc.fillStyle = '#FFFFFF';
dc.fill();
dc.strokeStyle = this.lapLabelBorderColour;
dc.stroke();
dc.fillStyle = '#000000';
dc.fillText( sLap, getX(lap) + lapWidth/2, getY(0) );
xLast = xMiddle - tWidth/2 - 2;
}
dc.font = fontHeight + 'px Arial';
dc.textAlign = 'left';
dc.textBaseline = 'middle';
var x = xRight;
if( hasLapped ) {
var s = _('Lapped') || 'Lapped';
x -= dc.measureText(s).width;
dc.fillStyle = '#000000';
dc.fillText( s, x, getY(nums.length) + rowHeight/2 );
x -= rowHeight * 1.2;
dc.fillStyle = this.lappedBackgroundColour;
dc.fillRect( x + swatchBorder, getY(nums.length) + swatchBorder, swatchSize, swatchSize );
x -= rowHeight;
}
if( hasPrimes ) {
var s = _('Prime') || 'Prime';
x -= dc.measureText(s).width;
dc.fillStyle = '#000000';
dc.fillText( s, x, getY(nums.length) + rowHeight/2 );
x -= rowHeight * 1.2;
dc.fillStyle = this.primeColour;
dc.fillRect( x + swatchBorder, getY(nums.length) + swatchBorder, swatchSize, swatchSize );
x -= rowHeight;
}
dc.translate( 0, height+rowHeight );
}
}
}
function SelectCategory( i )
{
categoryCur = categories[i];
var catButton = document.getElementById('idCat' + i);
if( catButton )
catButton.checked = true;
RefreshResultsTable();
if( animationObj != null )
animationObj.Refresh();
RefreshRaceChart();
SituationRefresh();
if( lapChartObj )
lapChartObj.draw();
}
function setCategory( catName )
{
var catNameDecode = decode_utf8( decodeURIComponent(catName) );
for( var i = 0; i < categories.length; ++i ) {
if( catName == categories[i] || catNameDecode == categories[i] ) {
SelectCategory( i );
return;
}
}
SelectCategory( 0 );
}
function StartAnimateRealtime()
{
_initAnimation();
speedup = 1.0;
tMax = 999999;
setTimeout( NextFrame, 1000.0/framesPerSecond );
}
function StopAnimate() {
t = tMax;
}
function SuspendAnimate() {
suspendAnimation = true;
}
function IsAnimating() {
return !suspendAnimation && t < tMax;
}
function SetTime( aT ) {
t = aT;
if( animationObj != null )
animationObj.Refresh();
}
function SetSpeed( i )
{
animationSeconds = 90;
var factor = 0.65;
for( ; i < 0; ++i )
animationSeconds /= factor;
for( ; i > 0; --i )
animationSeconds *= factor;
Animate( animationSeconds, tMax, t );
}
function SetNumsToWatch()
{
var numsToWatchText = document.getElementById('idNumsToWatch');
var numStr = numsToWatchText.value;
numStr = numStr.replace( / /g, ',' );
numStr = numStr.replace( /[^\d,]/g, '' );
numStr = numStr.replace( /,+/g, ',' );
numsToWatchText.value = numStr;
var nums = numStr.split(',');
numsToWatch = {};
for( var i = 0; i < nums.length; ++i )
{
var num = parseInt( nums[i], 10 );
if( !isNaN(num) )
numsToWatch[num] = num;
}
if( animationObj != null )
animationObj.Refresh();
RefreshResultsTable();
RefreshRaceChart();
SetSituationTime();
}
function ToggleNumberHighlight( num )
{
var numsToWatchText = document.getElementById('idNumsToWatch');
if( numsToWatch[num] == num )
{
var s = [];
for( var n in numsToWatch )
{
if( n != num )
s.push( n + '' );
}
numsToWatchText.value = s.join( ', ' );
}
else
numsToWatchText.value += (numsToWatchText.value ? ', ' : '') + num;
SetNumsToWatch();
}
function getStartTime()
{
if( !data )
return 0.001;
var t = 9999999;
for( var num in data )
{
if( categoryCur == 'All' || data[num]['raceCat'] == categoryCur )
if( data[num]['raceTimes'][0] < t )
{
t = data[num]['raceTimes'][0];
}
}
t += 0.001;
return t;
}
function Rewind()
{
if( raceIsRunning )
return;
t = getStartTime();
if( animationObj != null )
animationObj.Refresh();
document.getElementById('idPlayStop').innerHTML = _('Play');
Animate( animationSeconds, tMax, t );
suspendAnimation = true;
}
function PlayStop()
{
if( raceIsRunning )
return;
if( IsAnimating() )
{
SuspendAnimate();
document.getElementById('idPlayStop').innerHTML = _('Play');
}
else
{
Animate( animationSeconds, tMax, t );
document.getElementById('idPlayStop').innerHTML = _('Stop');
}
}
function rnd_normal()
{ return (Math.random()*2-1)+(Math.random()*2-1)+(Math.random()*2-1); }
function normal_variate( mean, stdev )
{ return rnd_normal()*stdev + mean; }
function rand_int( iMax )
{ if( iMax == null ) iMax = 100000000; return ~~(Math.random() * iMax); }
function rand_str()
{
var iMax = rand_int(7) + 1;
var s = '';
for( var i = 0; i < iMax; ++i )
s += rand_int( 10 );
return s
}
function GenerateRandomData()
{
var cats = ['Test Data Junior', 'Test Data Senior', 'Test Data Women'];
infoFields = ['LastName', 'FirstName', 'Name', 'Team', 'Category','License', ];
data = {};
for( var num = 100; num < 150; ++num )
{
var iCat = num % cats.length;
var cat = cats[iCat];
var mean = normal_variate(6.0,0.3);
var raceTimes = [60 * iCat];
for( var lap = 0; lap < 20; ++lap )
raceTimes.push( raceTimes.back() + normal_variate(mean, mean/20)*60.0 );
data[num] = { 'raceTimes': raceTimes, 'lastTime': raceTimes.back(), 'raceCat' : cat, 'status' : 'Finisher' };
data[num]['License']	= rand_str() + '';
data[num]['LastName']	= ["SAMPLE", "EXAMPLE", "DEMONSTRATION"][rand_int(3)];
data[num]['FirstName']	= ["John", "Peter", "Adam", "Kirk", "Vlad"][rand_int(5)];
data[num]['Team']		= ["Red", "Green", "Black"][rand_int(3)];
data[num]['flr'] = 1.0;
}
return data;
}
function getUrlParam( param, url )
{
param = param.replace(/([\[\](){}*?+^$.\\|])/g, "\\$1");
var regex = new RegExp("[?&]" + param + "=([^&#]*)");
url = url || decodeURIComponent(window.location.href);
var match = regex.exec(url);
return match ? match[1] : "";
}
function SetLapDataOption( opt )
{
lapDataOption = opt;
RefreshResultsTable();
}
function SetShowLaps()
{
var showLaps = document.getElementById('idShowLaps');
showLapsFrequency = parseInt( showLaps.options[showLaps.selectedIndex].value, 10 );
RefreshResultsTable();
}
function FormatDistance( distance, inUnit, showUnits )
{
if( (inUnit ? inUnit : 'km') != displayUnits )
distance *= (displayUnits == 'km' ? 1.609344 : 0.621371192237334);
var s = distance.toFixed(2);
if( showUnits )
s += ' ' + _(displayUnits);
return s;
}
function FormatSpeed( speed, inUnit, showUnits )
{
if( inUnit.substring(0,1) != displayUnits.substring(0,1) )
speed *= (displayUnits == 'km' ? 1.609344 : 0.621371192237334);
var s = speed.toFixed(2);
if( showUnits )
s += ' ' + (displayUnits == 'km' ? 'km/h' : 'mph');
return s;
}
function FormatDistanceGap( distance, inUnit )
{
if( inUnit != displayUnits )
distance *= (displayUnits == 'km' ? 1.609344 : 0.621371192237334);
var v = '';
if( displayUnits == 'km' )
{
if( Math.abs(distance) > 1.0 )
v = distance.toFixed(2) + ' km';
else
v = (distance*1000).toFixed(2) + ' m';
}
else
{
if( Math.abs(distance) > 0.25 )
v = distance.toFixed(2) + ' ' + _('miles');
else if( Math.abs(distance) > 0.1 )
v = (distance * 1760).toFixed(1) + ' yds';
else
{
if( Math.abs(distance * 5280) < 3 )
v = (distance * 5280 * 12).toFixed(0) + ' in';
else
v = (distance * 5280).toFixed(1) + ' ft';
}
}
return v;
}
function SetDisplayUnits()
{
var select = document.getElementById('idDisplayUnits');
displayUnits = select.options[select.selectedIndex].value;
RefreshResultsTable();
SetTotalElevationGain();
animationObj.widthLast = -1;
}
function LoopContinuously()
{
loopContinuously ^= true;
}
function AdjustSize( increase )
{
if( !canvas )
return;
if( increase )
{
if( canvas.width < 4096 )
{
canvas.width *= 1.2;
canvas.height *= 1.2;
}
}
else
{
if( canvas.width > 100 )
{
canvas.width /= 1.2;
canvas.height /= 1.2;
}
}
if( animationObj != null )
animationObj.Refresh();
}
function AdjustFont( increase )
{
if( !canvas || !animationObj )
return;
if( increase )
fontMult *= (fontMult < 3.0 ? 1.2 : 1.0);
else
fontMult /= (fontMult > 0.2 ? 1.2 : 1.0);
animationObj.Refresh();
}
function SetShowTrack()
{
var select = document.getElementById('idShowTrack');
var track = select.options[select.selectedIndex].value;
if( track == 'gpx' && gpsPoints )
{
animationObj = new GeoAnimation();
animationObj.geoTrack.setData( gpsPoints );
animationObj.altigraph.setData( gpsAltigraph );
}
else
animationObj = new TrackAnimation();
animationObj.Refresh();
}
function ToggleTimeDecimals()
{
var cb = document.getElementById('idShowTimeDecimals');
showTimeDecimals = cb.checked;
RefreshResultsTable();
}
var replaceHtmlEntites = (function() {
var translate_re = /&(nbsp|amp|quot|lt|gt);/g;
var translate = {
"nbsp": " ", 
"amp" : "and", 
"quot": "\"",
"lt"  : "<", 
"gt"  : ">"
};
return function( s ) {
return ( s.replace(translate_re, function(match, entity) { 
return translate[entity]; 
}) );
}
})();
function SetTotalElevationGain() {
//
//	if( gpsTotalElevationGain )
//	{
//		var units = (displayUnits == 'km' ? 'm' : ' ft');
//		var totalElevationGain = (displayUnits == 'km' ? 1.0 : 3.28084) * gpsTotalElevationGain;
//		document.getElementById('idTotalElevationGain').innerHTML = '<' + 'br/>' + totalElevationGain.toFixed(0) + units + ' Total Elevation Gain per Lap';
//	}
//	else
//		document.getElementById('idTotalElevationGain').innerHTML = '';
//
}
function setLanguage( langCode ) {
var langs = translations['languageCode'];
for( var i = 0; i < langs.length; ++i ) {
if( langs[i] == langCode ) {
langCur = i;
break;
}
}
if( langCur == null ) {
var browser_languages = navigator.languages ? navigator.languages : [(navigator.language || navigator.userLanguage || 'en')];
for( var b = 0; b < browser_languages.length && langCur == null; ++b ) {
var base_lang = browser_languages[b].split('-')[0];
for( var i = 0; i < langs.length; ++i ) {
if( base_lang == langs[i] ) {
langCur = i;
break;
}
}
}
}
if( langCur == null )
langCur = 0;
var textAttr = {
'#text':	'nodeValue',
'OPTION':	'text'
};
var elements = document.getElementsByTagName('*');
for( var i = 0; i < elements.length; ++i )
{
e = elements[i];
trTag = e.getAttribute('data-tr');
if( trTag )
{
var tAttr = textAttr[e.nodeName];
if( !tAttr )
tAttr = 'innerHTML';
//alert( 'e.nodeName=' + e.nodeName + ' trTag="' + trTag + '" _(trTag)="' + _(trTag) + '" tAttr=' + tAttr + ' e.id=' + e.id );
e[tAttr] = _(trTag);
}
}
RefreshResultsTable();
SetTotalElevationGain();
SituationRefresh();
}
function getLanguageCode() {
return translations['languageCode'][langCur];
}
function initLanguages() {
var languages = translations['language'];
var languageCodes = translations['languageCode'];
langCur = (langCur || 0);
var iLang = [langCur];
for( var i = 0; i < languages.length; ++i )
if( i != langCur )
iLang.push( i );
var languageHTML = '<div id="buttongroup">';
for( var j = 0; j < languages.length; ++j )
{
var i = iLang[j];
languageHTML +=
'<label class="green">' +
'<input ' +
'type="radio" ' +
'name="languageSelect" ' +
'id="idLanguage' + i + '" ' +
'onClick="setLanguage(\''+languageCodes[i]+'\');" ' +
(i == langCur ? 'checked="true"': '') +
'/>' +
'<span>' + languages[i] + '</span>' +
'</input>' +
'</label>';
}
languageHTML += '</div><hr/>';
document.getElementById('idLanguages').innerHTML = languageHTML;
}
function SetSituationZoom( rbutton ) {
situationObj.zoom = parseFloat(rbutton.value);
SituationRefresh();
}
var situationTimer = null;
function SetSituationTime( value ) {
if( situationObj == null )
return;
if( value == undefined )
value = 10000;
value = parseInt( value );
if( situationTimer != null ) {
clearTimeout( situationTimer );
situationTimer = null;
}
var tMax;
if( raceIsRunning ) {
var tServer = (new Date(timestamp[0])).getTime() / 1000.0;
var tBrowser = (new Date().getTime()) / 1000.0;
while( tBrowser - tServer < 0 )
tBrowser += 60*60;
tMax = timestamp[1] + (tBrowser - tServer);
}
else
tMax = GetRaceTMax();
var tRace = tMax * (value / 10000.0);
var gs = GetSituationGaps( tRace );
situationObj.SetData( gs.gaps, gs.tAfterLeader, gs.title, gs.tCur );
if( value == 10000 && raceIsRunning )
situationTimer = setTimeout( SetSituationTime, 1001 - (new Date()).getTime() % 1000 );
}
function SituationRefresh() {
var timeRange = document.getElementById('idTimeRange');
SetSituationTime( timeRange.value );
}
function SetArrivalMode() {
arrivalMode = document.getElementById('idArrivalMode').checked;
RefreshResultsTable();
}
function SetMapMode() {
mapMode = document.getElementById('idMapMode').checked;
document.getElementById('idResultsDiv').className = (mapMode ? 'hidden' : '');
}
function SelectCategoryNonAll() {
if( categories.length <= 1 || (categoryCur && categoryCur != 'All') )
return;
var i;
for( i = 0; i < categories.length; ++i ) {
if( categoryCur == categories[i] )
break;
}
for( ;; ) {
if( ++i >= categories.length )
i = 0;
if( categories[i] != 'All' )
break;
}
SelectCategory( i );
}
function GetNextValidCategory() {
if( categories.length <= 1 )
return null;
var i;
for( i = 0; i < categories.length; ++i ) {
if( categoryCur == categories[i] )
break;
}
for( ;; ) {
if( ++i >= categories.length )
i = 0;
if( categories[i] != 'All' )
break;
}
return i;
}
var cycleCount = 0;
var cycleTimer = null;
function SetNextCategory() {
var i = GetNextValidCategory();
if( i == null )
return;
SelectCategory( i );
if( ++cycleCount % 12 == 0 )	
doReload();
}
function SetShowCategorySummary() {
showCategorySummary = document.getElementById('idShowCategorySummary').checked;
RefreshResultsTable();
}
function SetCycleCategoriesMode() {
cycleCategoriesMode = document.getElementById('idCycleCategoriesMode').checked;
clearInterval( cycleTimer );
if( cycleCategoriesMode )
cycleTimer = setInterval( SetNextCategory, 1000*15 );
}
function OpenGetDirections()
{
var url = 'http://maps.google.com?daddr=' + courseCoordinates[1].toFixed(4) + ' ' + courseCoordinates[0].toFixed(4) + ' (' + raceName + ')';
window.open( url, null, null, true );
}
function createXMLHttpRequest() {
try { return new ActiveXObject("Msxml2.XMLHTTP"); } catch (e) {}
try { return new ActiveXObject("Microsoft.XMLHTTP"); } catch (e) {}
try { return new XMLHttpRequest(); } catch(e) {}
return null;
}
function TryAgain( error, responseText ) {
console.log( 'RefreshPayload: failure: "' + error + '".  Trying again in a few seconds...' );
if( responseText ) {
console.log( 'responseText:' );
console.log( responseText.slice(0, 256) + '...' );
}
else
console.log( 'No responseText.' );
setTimeout( RefreshPayload, Math.round(5000 + Math.random() * 3000) );
return true;
}
function eqTimestamp( ts1, ts2 ) {
return	( (ts1 && ts1.length > 0 ? ts1[0] : '') == (ts2 && ts2.length > 0 ? ts2[0] : '') ) &&
( (ts1 && ts1.length > 1 ? ts1[1] : -1) == (ts2 && ts2.length > 1 ? ts2[1] : -1) );
}
function RefreshPayload() {
var xhr = createXMLHttpRequest();
if( !xhr || window.location.href.substring(0,5) == 'file:')
return doReload(true);
var requestTimer = setTimeout( function() { xhr.abort(); }, 10*1000 );
xhr.onreadystatechange = function() {
if( xhr.readyState != 4 )
return;
clearTimeout( requestTimer )
if( xhr.status != 200 )
return TryAgain();
console.log( 'RefreshPayload: processing...' );
var startSearch = /\/\* !!! payload begin !!! \*\/[^{]+\{/g;
var result = startSearch.exec( xhr.responseText );
if( result == null ) return TryAgain( 'missing payload start', xhr.responseText );
var pStart = startSearch.lastIndex - 1;
var endSearch = /\}\s*;\s*\/\* !!! payload end !!! \*\//g;
var result = endSearch.exec( xhr.responseText );
if( result == null ) return TryAgain( 'missing payload end', xhr.responseText );
var pEnd = result.index + 1;
var payloadJSON = xhr.responseText.substring(pStart, pEnd)
var payload = null;
try {
payload = JSON.parse(payloadJSON);
}
catch( e ) {
console.log( 'RefreshPayload: parse payload error: ' + e.message );
payload = null;
}
payloadJSON = null;
if( payload ) {
reloadTriggered = false;
if( eqTimestamp(timestamp, payload.timestamp) ) {
console.log( 'RefreshPayload: success: no change.' );
return;
}
raceWasRunning = raceIsRunning;
for( v in payload ) window[v] = payload[v]; payload = null;
SetData( data, undefined );
SetRaceTime();
setLanguage( translations['languageCode'][langCur] );
setCategory( categoryCur );
RefreshResultsTable();
RefreshRaceChart();
SituationRefresh();
if( !raceIsRunning && raceWasRunning )
Animate( animationSeconds, undefined, getStartTime() );
console.log( 'RefreshPayload: success: new timestamp.' );
}
else
return TryAgain( 'payload extract fails', xhr.responseText );
}
xhr.open('GET', window.location.href);
xhr.send();
}
var finishUpdateTimer = null;
var queryPayloadTimer = null;
function QueryPayloadLoop() {
if( lastRaceTime == 0 ) {
console.log( 'QueryPayloadLoop:' );
RefreshPayload();
queryPayloadTimer = setTimeout( QueryPayload, (3 + Math.random()) * 60 * 1000 );
}
}
function SetRaceTime() {
var s = (organizer ? organizer : '');
if( finishUpdateTimer ) {
clearTimeout( finishUpdateTimer );
finishUpdateTimer = null;
}
if( queryPayloadTimer ) {
clearTimeout( queryPayloadTimer );
queryPayloadTimer = null;
}
if( timestamp )
{
var tServer = (new Date(timestamp[0]).getTime()) / 1000.0;
var tBrowser = (new Date().getTime()) / 1000.0;
while( tBrowser - tServer < 0 )
tBrowser += 60*60;
var tRace = timestamp[1] + (tBrowser - tServer);
if( tRace > 25*60*60 )
raceIsRunning = false;		
if( raceIsRunning )
{
t = tRace;
document.getElementById('idAnimateControls').className = 'hidden';
s += ' (race in progress, last updated ' + timestamp[0] + ')';
speedup = 1.0;
if( !isTimeTrial ) {
if( lastRaceTime > 0 )
finishUpdateTimer = setTimeout( function() {doReload(true); }, (Math.min(0, lastRaceTime - tRace) + 5*60) * 1000 );
else
queryPayloadTimer = setTimeout( QueryPayloadLoop, (3 + Math.random()) * 60 * 1000 );
}
}
else {
document.getElementById('idAnimateControls').className = '';
s += ' (' + '<span data-tr="created"></span> ' + timestamp[0] + ')';
}
}
document.getElementById('idOrganizer').innerHTML = s;
return s;
}
function displaySelect( select ) {
var k = (select.value.indexOf('kiosk') >= 0);
var a = (select.value.indexOf('arrival') >= 0);
var m = (select.value.indexOf('map') >= 0);
if( k || a || m ) {
var message;
if( k && a )
message = 'Switch to Kiosk Arrival Mode?';
else if( k && m )
message = 'Switch to Kiosk Map Mode?';
else
message = 'Switch to Kiosk Mode?';
if( !window.confirm(message) ) {
kioskMode = false;
arrivalMode = false;
mapMode = false;
select.selectedIndex = 0;
return;
}
}
kioskMode = k;
arrivalMode = a;
mapMode = m;
doReload( true );
}
function onLoad()
{
if( payload ) { for( v in payload ) window[v] = payload[v]; payload = null; }
resultsDiv = document.getElementById('idResultsDiv');
showLaps = document.getElementById('idShowLaps');
if( data == null )
{
GenerateRandomData();
if( !gpsPoints )
gpsPoints = gpsPointsTest;
}
else
gpsPointsTest = null;
if( showCourseAnimation ) {
if( gpsPoints )
{
animationObj = new GeoAnimation();
animationObj.geoTrack.setData( gpsPoints );
animationObj.altigraph.setData( gpsAltigraph );
}
else
{
animationObj = new TrackAnimation();
document.getElementById('idShowTrack').className = 'hidden';
}
}
else {
document.getElementById('idTrackDiv').className = 'hidden';
}
if( hideDetails )
document.getElementById('idShowDetailsOption').className = 'hidden';
if( !rfid )
document.getElementById('idRFID').className = 'hidden';
else
document.getElementById('idRFID').innerHTML = '<span data-tr="Chip Timing"></span>.';
if( !raceNotes )
document.getElementById('idRaceNotes').className = 'hidden';
else
document.getElementById('idRaceNotes').innerHTML = raceNotes.replace(/{-{/g, '<').replace(/}-}/g, '>');
if( !courseCoordinates ) {
document.getElementById('idCourseViewer').className = 'hidden';
document.getElementById('idGetDirections').className = 'hidden';
}
if( !travelMap )
document.getElementById('idTravelMap').className = 'hidden';
canvasSupported = isCanvasSupported();
if( canvasSupported && !winAndOut )
{
var raceChartCanvas = document.getElementById('idRaceChart');
raceChartCanvas.addEventListener('click', function(event) { RaceChartProcessClick(event); }, false);
raceChartCanvas.addEventListener('mousemove', function(event) { RaceChartProcessMouse(event); }, false);
raceChartCanvas.addEventListener('mouseout', function(event) {
if( hoverTimer != null )
clearTimeout( hoverTimer );
hoverTimer = null;
RefreshRaceChart();
},
false
);
if( !isTimeTrial ) {
var situationCanvas = document.getElementById('idSituation');
var timeRange = document.getElementById( 'idTimeRange' );
var situationDetail = document.getElementById( 'idSituationDetailDiv' );
situationObj = new Situation( situationCanvas, timeRange, situationDetail );
situationCanvas.addEventListener('click', function(event) { situationObj.processClick(event); }, false);
}
else
document.getElementById('idSituationDiv').className = 'hidden';
if( !showCourseAnimation || (isTimeTrial && raceIsRunning) )
document.getElementById('idTrackDiv').className = 'hidden';
else
canvas = document.getElementById('idTrack');
var lapChartCanvas = document.getElementById('idLapChart');
lapChartObj = new LapChart();
lapChartObj.init( lapChartCanvas );
}
else
{
document.getElementById('idTrackDiv').className = 'hidden';
document.getElementById('idRaceChartDiv').className = 'hidden';
document.getElementById('idSituationDiv').className = 'hidden';
document.getElementById('idLapChartDiv').className = 'hidden';
}
document.getElementById('idRaceName').innerHTML = document.getElementById('idTitle').innerHTML;
if( email ) {
document.getElementById('idEmail').href =
'mailto:' + email +
'?subject=' + replaceHtmlEntites(document.getElementById('idTitle').innerHTML);
}
SetRaceTime();
if( HasDisplayUnit(data) )
{
displayUnits = GetDistanceUnit( data );
document.getElementById('idDisplayUnits').selectedIndex = (displayUnits == 'km' ? 0 : 1);
}
else
document.getElementById('idShowUnits').style.display = 'none';
SetData( data, undefined );
showCategorySummary = (getUrlParam('showCategorySummary', undefined) == 't');
if( showCategorySummary )
document.getElementById('idShowCategorySummary').checked = true;
arrivalMode = (getUrlParam('arrivalMode', undefined) == 't');
if( arrivalMode )
document.getElementById('idArrivalMode').checked = true;
mapMode = (getUrlParam('mapMode', undefined) == 't');
if( mapMode )
document.getElementById('idMapMode').checked = true;
cycleCategoriesMode = (getUrlParam( 'cycleCategoriesMode', undefined ) == 't');
if( cycleCategoriesMode ) {
document.getElementById('idCycleCategoriesMode').checked = true;
SetCycleCategoriesMode();
}
kioskMode = (getUrlParam('kioskMode', undefined) == 't');
if( kioskMode ) {
document.getElementById('idRaceChartDiv').classList.add('hidden');
document.getElementById('idSituationDiv').classList.add('hidden');
document.getElementById('idLapChartDiv').classList.add('hidden');
document.getElementById('idPageHeader').classList.add('hidden');
document.getElementById('idResultOptions').classList.add('hidden');
if( mapMode ) {
document.getElementById('idResultsDiv').classList.add('hidden');
document.getElementById('idMapMode').checked = true;
}
else {
document.getElementById('idTrackDiv').classList.add('hidden');
}
document.getElementById('idCycleCategoriesMode').checked = cycleCategoriesMode = true;
document.getElementById('idShowCategorySummary').checked = showCategorySummary = true;
SetShowCategorySummary();
SetArrivalMode();
SetCycleCategoriesMode();		
}
var numbers = getUrlParam( 'highlight', undefined );
if( numbers != '' )
numsToWatchStr = numbers;
if( numsToWatchStr )
{
var numsToWatch = document.getElementById('idNumsToWatch');
numsToWatch.value = numbers;
SetNumsToWatch();
}
setCategory( getUrlParam('raceCat', undefined) );
setLanguage( getUrlParam('lang', undefined) );
initLanguages();
RefreshResultsTable();
RefreshRaceChart();
SetSituationTime();
Animate( animationSeconds, undefined, raceIsRunning ? t : getStartTime() );
document.getElementById('idPlayStop').innerHTML = _('Stop');
if( raceIsRunning )
setTimeout( RefreshPayload, 5*60*1000+10 );
document.getElementById('idDisplaySelect').selectedIndex = (kioskMode && arrivalMode ? 2 : kioskMode ? 1 : 0);
ResetWebSocket();
}
</script>
</head>
<body onload="onLoad()">
<div id="idPageHeader">
<p>
<table style="border-spacing: 8px;"><tr>
<td style="vertical-align: top;"><img alt="CrossMgr Logo" onclick="doReload();" style="cursor:pointer" id="idImgHeader" src="data:image/png;base64,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"/></td>
<td style="vertical-align: top;"><span id="idRaceName" onclick="doReload();" style="cursor:pointer">Cyclo-Cross Race Results</span><br/><span data-tr="by"></span> <span id="idOrganizer">CrossMgr</span>
&nbsp;&nbsp;&nbsp;&nbsp;
<span class="noprint">
<a id="idEmail" href="mailto:helpful.organizer@great_race_organization.com?subject=CrossMgr+Results+Output"><span data-tr="Email Comments/Suggestions"></span></a>.
<br/>
<span data-tr="Powered by"></span> <a href="http://www.sites.google.com/site/crossmgrsoftware">CrossMgr</a>.
<span id="idRFID"></span>&nbsp;&nbsp;&nbsp;
<br/>
<button id="idGetDirections" onclick="OpenGetDirections()" data-tr="Get Directions"></button>&nbsp;&nbsp;
<button id="idCourseViewer" onclick="OpenCourseViewerWindow()" data-tr="Course Map"></button>&nbsp;&nbsp;
<button id="idTravelMap" onclick="OpenTravelMapWindow()" data-tr="Participant Map"></button>&nbsp;&nbsp;
<button onclick="doReload()" data-tr="Refresh"></button>&nbsp;&nbsp;&nbsp;
<select id="idDisplaySelect" onchange="displaySelect(this);">
<option value="normal" data-tr="Results">Results</option>
<option value="kiosk" data-tr="Kiosk">Kiosk</option>
<option value="kiosk-arrival" data-tr="Kiosk A">Kiosk A</option>
<option value="kiosk-map" data-tr="Kiosk Map">Kiosk Map</option>
</select>
<br/>
<input id="idCycleCategoriesMode" type="checkbox" class="hidden" onclick="SetCycleCategoriesMode()">
<label for="idCycleCategoriesMode" data-tr="CycleCategories" class="hidden"></label>&nbsp;&nbsp;
<input id="idShowCategorySummary" type="checkbox" class="hidden" onclick="SetShowCategorySummary()">
<label for="idShowCategorySummary" data-tr="ShowCategorySummary" class="hidden"></label>&nbsp;&nbsp;
<input id="idArrivalMode" type="checkbox" class="hidden" onclick="SetArrivalMode()">
<label for="idArrivalMode" id="idArrivalModeLabel" data-tr="ByFinishers" class="hidden"></label>
<input id="idMapMode" type="checkbox" class="hidden" onclick="SetMapMode()">
<label for="idMapMode" id="idMapModeLabel" data-tr="Map Only" class="hidden"></label>
</span>
</tr></table><span id="idReloadStatus"></span><span id="idRaceNotes"></span>
<p></p>
<div class="noprint" id="idLanguages"></div>
<p></p>
<div class="noprint" id="idCategories"></div>
<p></p>
</div> <!-- idPageHeader -->
<div id="idTrackDiv">
<canvas id="idTrack" width="600" height="300" class="noprint">
<a href="http://www.sites.google.com/site/crossmgrsoftware">CrossMgr</a> Race Results requires support the HTML5 Canvas.<br/>
Please upgrade to a more recent browser version.<br/>
For Internet Explorer (IE), you need version 9.0 or higher.<br/><br/>
Current versions of Chrome, FireFox and Opera work fine.
</canvas>
<p class="noprint">
<span id="idAnimateControls">
<button id="idRewind" onClick="Rewind()"><span data-tr="Rewind"></span></button>
<button id="idPlayStop" onClick="PlayStop()"><span data-tr="Play"></span></button>
<input type="checkbox" id="idLoop" onClick="LoopContinuously()" checked>
<label for="idLoop" data-tr="Loop Continuously"></label>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<label for=playbackSpeed data-tr="Playback Speed">: </label>
<input type="range" id="playbackSpeed" min="-9" value="0" max="3" step="1" oninput="SetSpeed(this.value)" onchange="SetSpeed(this.value)">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<span data-tr="Size"></span>:
<button id="idIncreaseSize" onClick="AdjustSize(true)">+</button>
<button id="idDecreaseSize" onClick="AdjustSize(false)">-</button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span data-tr="Text"></span>:
<button id="idIncreaseFont" onClick="AdjustFont(true)">+</button>
<button id="idDecreaseFont" onClick="AdjustFont(false)">-</button>
</span>
</p>
<p class="noprint">
<span data-tr="Highlight Numbers"></span>:
<input type="text" id="idNumsToWatch" value="" onChange="SetNumsToWatch()">
<button><span data-tr="Apply"></span></button>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<select class="noprint" id="idShowTrack" onChange="SetShowTrack()">
<option value="gpx" selected="selected" data-tr="GPX">GPX</option>
<option value="oval" data-tr="Track">Track</option>
</select>
</p>
</div> <!-- idTrackDiv -->
<div id="idResultOptions">
<p>
<span class="noprint" id="idShowUnits">
<span data-tr="Units:"></span>
<select class="noprint" id="idDisplayUnits" onChange="SetDisplayUnits()">
<option value="km" selected="selected">km</option>
<option value="miles" data-tr="miles">miles</option>
</select>
&nbsp;&nbsp;&nbsp;
</span>
<input class="noprint" type="checkbox" id="idShowTimeDecimals" onClick="ToggleTimeDecimals()">
<label for="idShowTimeDecimals" class="noprint" data-tr="Show 100s of Seconds"></label>
&nbsp;&nbsp;&nbsp;
<select class="noprint" id="idShowLaps" onChange="SetShowLaps()">
<option value="0" data-tr="Hide Lap Info">0</option>
<option value="1" selected="selected" data-tr="Show Every Lap">1</option>
<option value="2" data-tr="Show Every 2 Laps">2</option>
<option value="3" data-tr="Show Every 3 Laps">3</option>
<option value="5" data-tr="Show Every 5 Laps">5</option>
<option value="10" data-tr="Show Every 10 Laps">10</option>
<option value="15" data-tr="Show Every 15 Laps">15</option>
<option value="20" data-tr="Show Every 20 Laps">20</option>
<option value="25" data-tr="Show Every 25 Laps">25</option>
<option value="50" data-tr="Show Every 50 Laps">50</option>
<option value="100" data-tr="Show Every 100 Laps">100</option>
</select>
<span id="idTotalElevationGain"> </span>
</p>
<span class="noprint" id="idShowOptions"></span><br/>
</div>
<div id="idResultsDiv"></div>
<div id="idLapChartDiv" class="noprint">
<strong><span id="idLapChartName" data-tr="Race Position"></span></strong><br/>
<canvas id="idLapChart" width="1000" height="800">
<a href="http://www.sites.google.com/site/crossmgrsoftware">CrossMgr</a> Requires support for the HTML5 Canvas.<br/>
Please upgrade to a more recent browser version.<br/>
For Internet Explorer (IE), you need version 9.0 or higher.<br/><br/>
Current versions of Chrome, FireFox and Opera work fine.
</canvas>
</div><!-- idLapChartDiv -->
<div id="idRaceChartDiv" class="noprint">
<p>
<strong><span id="idRaceChartName" data-tr="Race Chart"></span></strong>&nbsp;&nbsp;&nbsp;&nbsp;
<span id="idShowStartOffsetOption">
<input type="checkbox" id="idShowStartOffsets" checked onClick="RefreshRaceChart()">
<label for="idShowStartOffsets" data-tr="Show Start Offsets"></label>
</span>
<span id="idShowDetailsOption">
&nbsp;&nbsp;&nbsp;&nbsp;
<input type="checkbox" id="idShowDetails" onClick="RefreshRaceChart()">
<label for="idShowDetails" data-tr="Show Details"></label>
</span>
</p>
<canvas id="idRaceChart" width="1000" height="800">
<a href="http://www.sites.google.com/site/crossmgrsoftware">CrossMgr</a> Requires support for the HTML5 Canvas.<br/>
Please upgrade to a more recent browser version.<br/>
For Internet Explorer (IE), you need version 9.0 or higher.<br/><br/>
Current versions of Chrome, FireFox and Opera work fine.
</canvas>
</div> <!-- idRaceChartDiv -->
<div id="idSituationDiv" class="noprint">
<hr>
<p>
<strong><span id="idSituationName" data-tr="Situation"></span></strong>
</p>
<table><tr>
<td style="vertical-align:top; text-align:center;">
<br/><br/><br/><br/>
<span data-tr="Zoom"></span><br/>
+<br/>
<input type="radio" name="zoom" value="5.0" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="4.5" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="4.0" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="3.5" checked onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="3.0" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="2.5" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="2.0" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="1.5" onclick="SetSituationZoom(this)"><br/>
<input type="radio" name="zoom" value="1.0" checked onclick="SetSituationZoom(this)"><br/>
-<br/>
</td>
<td style="vertical-align: top;">
<span data-tr="TimeSlider"></span>&nbsp;&nbsp;&nbsp;<input id="idTimeRange" type="range" min="0" max="10000" value="10000" style="width:670px;" oninput="SetSituationTime(this.value)" onchange="SetSituationTime(this.value)"><br/>
<canvas id="idSituation" width="800" height="600">
<a href="http://www.sites.google.com/site/crossmgrsoftware">CrossMgr</a> Requires support for the HTML5 Canvas.<br/>
Please upgrade to a more recent browser version.<br/>
For Internet Explorer (IE), you need version 9.0 or higher.<br/><br/>
Current versions of Chrome, FireFox and Opera work fine.
</canvas>
</td>
<td style="vertical-align: top;">
<div id="idSituationDetailDiv"></div>
</td>
</tr></table>
</div> <!-- idSituationDiv -->
</body>
</html>
